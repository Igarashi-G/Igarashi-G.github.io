<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.21" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.82" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Kubernets - æœåŠ¡","image":[""],"datePublished":"2022-10-06T00:00:00.000Z","dateModified":"2023-01-09T06:55:55.000Z","author":[{"@type":"Person","name":"æ‚¦Â·å®å®","url":"https://github.com/Igarashi-G"}]}</script><meta property="og:url" content="https://igarashi-g.github.io/tool/Kubernetes/k8s%E6%9C%8D%E5%8A%A1.html"><meta property="og:site_name" content="æ‚¦ â–ª å®å®"><meta property="og:title" content="Kubernets - æœåŠ¡"><meta property="og:description" content="k8s æœåŠ¡ã€è´Ÿè½½å‡è¡¡ å’Œ è”ç½‘"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-01-09T06:55:55.000Z"><meta property="article:tag" content="k8s"><meta property="article:published_time" content="2022-10-06T00:00:00.000Z"><meta property="article:modified_time" content="2023-01-09T06:55:55.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3654399_e6xix4avjkd.css"><title>Kubernets - æœåŠ¡ | æ‚¦ â–ª å®å®</title><meta name="description" content="k8s æœåŠ¡ã€è´Ÿè½½å‡è¡¡ å’Œ è”ç½‘">
    <link rel="preload" href="/assets/style-DCFqVXmA.css" as="style"><link rel="stylesheet" href="/assets/style-DCFqVXmA.css">
    <link rel="modulepreload" href="/assets/app-BFWhIhUk.js"><link rel="modulepreload" href="/assets/k8sæœåŠ¡.html-DicYC5rH.js"><link rel="modulepreload" href="/assets/plugin-vueexport-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-BmwPtmf_.js" as="script"><link rel="prefetch" href="/assets/home.html-CiJS9Ms1.js" as="script"><link rel="prefetch" href="/assets/intro.html-DZNC6oWu.js" as="script"><link rel="prefetch" href="/assets/slides.html-Cx8h3sNo.js" as="script"><link rel="prefetch" href="/assets/index.html-e7tQ8syA.js" as="script"><link rel="prefetch" href="/assets/index.html-DMp4KjLL.js" as="script"><link rel="prefetch" href="/assets/disable.html-BiHo1_48.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-CTiwBRWO.js" as="script"><link rel="prefetch" href="/assets/markdown.html-DBnhVBwh.js" as="script"><link rel="prefetch" href="/assets/page.html-C4qvlA93.js" as="script"><link rel="prefetch" href="/assets/PSæ“ä½œåŸºç¡€.html-Hnnw9NFP.js" as="script"><link rel="prefetch" href="/assets/index.html-BFDyGk1C.js" as="script"><link rel="prefetch" href="/assets/SAIæ“ä½œåŸºç¡€.html-D0pHjdP2.js" as="script"><link rel="prefetch" href="/assets/index.html-DgDBN-zR.js" as="script"><link rel="prefetch" href="/assets/index.html-DPWvAyE1.js" as="script"><link rel="prefetch" href="/assets/asyncio_recipes.html-CA6RkQPD.js" as="script"><link rel="prefetch" href="/assets/devops_in_python.html-ToD9NUcl.js" as="script"><link rel="prefetch" href="/assets/fluent_python.html-Ck-ChS8V.js" as="script"><link rel="prefetch" href="/assets/index.html-BFfTEgjZ.js" as="script"><link rel="prefetch" href="/assets/python_cookbook.html-CM5OPl3D.js" as="script"><link rel="prefetch" href="/assets/pythonæºç å‰–æ.html-Db_WWukm.js" as="script"><link rel="prefetch" href="/assets/use_asyncio.html-DC4pUzaX.js" as="script"><link rel="prefetch" href="/assets/index.html-1JgW5Ciy.js" as="script"><link rel="prefetch" href="/assets/äºšåŠ¨æœºä¸äººæ ¼.html-Bwn90XkF.js" as="script"><link rel="prefetch" href="/assets/äººçš„æ½œèƒ½å’Œä»·å€¼.html-n4b9ggWb.js" as="script"><link rel="prefetch" href="/assets/å¥½äººæ˜¯å¦‚ä½•å˜æˆæ¶é­”çš„.html-BTzpQUzw.js" as="script"><link rel="prefetch" href="/assets/å½±å“åŠ›.html-v-3vJG83.js" as="script"><link rel="prefetch" href="/assets/æ€§å¿ƒç†å­¦.html-8NJldCzU.js" as="script"><link rel="prefetch" href="/assets/æ´—è„‘å¿ƒç†å­¦.html-BNyuCw56.js" as="script"><link rel="prefetch" href="/assets/è¿›åŒ–å¿ƒç†å­¦.html-D4dvmxcj.js" as="script"><link rel="prefetch" href="/assets/CODE.html-CNbRK7Kb.js" as="script"><link rel="prefetch" href="/assets/index.html-DnwOExSD.js" as="script"><link rel="prefetch" href="/assets/æˆä¸ºæŠ€æœ¯é¢†å¯¼è€….html-CzVOwa8J.js" as="script"><link rel="prefetch" href="/assets/é¸Ÿå“¥çš„Linuxç§æˆ¿èœ.html-DtecxLFr.js" as="script"><link rel="prefetch" href="/assets/é¸Ÿå“¥çš„Linuxç§æˆ¿èœæœåŠ¡å™¨æ¶è®¾ç¯‡.html-DNU3gZiD.js" as="script"><link rel="prefetch" href="/assets/é»‘å®¢ä¸ç”»å®¶.html-BeLNE_yS.js" as="script"><link rel="prefetch" href="/assets/index.html-DL8xRTcx.js" as="script"><link rel="prefetch" href="/assets/ä¸­å›½äººçš„æ€§æ ¼.html-C9CJwYIX.js" as="script"><link rel="prefetch" href="/assets/ä¹Œåˆä¹‹ä¼—.html-DbdQqPAI.js" as="script"><link rel="prefetch" href="/assets/å¨±ä¹è‡³æ­».html-CamUEFhg.js" as="script"><link rel="prefetch" href="/assets/index.html-BEGtP2A1.js" as="script"><link rel="prefetch" href="/assets/æ¸…é†’æ€è€ƒçš„è‰ºæœ¯.html-D76SmMd1.js" as="script"><link rel="prefetch" href="/assets/index.html-Bd2OeJ5E.js" as="script"><link rel="prefetch" href="/assets/åšå¼ˆè®ºä¸ç»æµè¡Œä¸º.html-D_e-oFvE.js" as="script"><link rel="prefetch" href="/assets/å°±ä¸š_åˆ©æ¯å’Œè´§å¸é€šè®º.html-B-dEdJ8z.js" as="script"><link rel="prefetch" href="/assets/èªæ˜çš„æŠ•èµ„è€….html-sbEBQ_Gj.js" as="script"><link rel="prefetch" href="/assets/è´§å¸é‡‘èå­¦.html-DVHEfn4D.js" as="script"><link rel="prefetch" href="/assets/éç†æ€§ç¹è£.html-BIO94_ED.js" as="script"><link rel="prefetch" href="/assets/MySQL.html-CScb30qg.js" as="script"><link rel="prefetch" href="/assets/Mysqlè°ƒä¼˜.html-KrxVCkqH.js" as="script"><link rel="prefetch" href="/assets/Mysqlè¿›é˜¶.html-D9PvkLgY.js" as="script"><link rel="prefetch" href="/assets/Mysqlé«˜é˜¶.html-CxjZiwmJ.js" as="script"><link rel="prefetch" href="/assets/Navicat.html-B0XgdLp_.js" as="script"><link rel="prefetch" href="/assets/SQLAlchemy.html-CLxwaVN8.js" as="script"><link rel="prefetch" href="/assets/PostgreSQL.html-D_K3yJMx.js" as="script"><link rel="prefetch" href="/assets/redis.html-CURqUjUe.js" as="script"><link rel="prefetch" href="/assets/æ€§èƒ½åˆ†æ.html-udahOd5S.js" as="script"><link rel="prefetch" href="/assets/aioetcd3.html-CF1oET4Y.js" as="script"><link rel="prefetch" href="/assets/etcd.html-HttfNcLG.js" as="script"><link rel="prefetch" href="/assets/è¿›é˜¶.html-D9N3nRKd.js" as="script"><link rel="prefetch" href="/assets/goå·¥å…·é€Ÿç”¨.html-DEE9_T0B.js" as="script"><link rel="prefetch" href="/assets/goè¯­è¨€é€Ÿè®°.html-Dbampsee.js" as="script"><link rel="prefetch" href="/assets/æ•°ç»„.html-Aey-6zE6.js" as="script"><link rel="prefetch" href="/assets/æ ˆä¸é˜Ÿåˆ—.html-YZNCDAoG.js" as="script"><link rel="prefetch" href="/assets/æ ‘.html-Ci77I6PW.js" as="script"><link rel="prefetch" href="/assets/æ¦‚è¿°.html-BFu6Pm9g.js" as="script"><link rel="prefetch" href="/assets/çº¿æ€§è¡¨.html-D2cawnCW.js" as="script"><link rel="prefetch" href="/assets/dockerå®¹å™¨.html-BrM2gWXu.js" as="script"><link rel="prefetch" href="/assets/ä½¿ç”¨åŸºç¡€.html-BbnpPuug.js" as="script"><link rel="prefetch" href="/assets/å‘½ä»¤.html-DmVS8kSE.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œ.html-B3pCSh7_.js" as="script"><link rel="prefetch" href="/assets/CICD.html-CSP6A7JI.js" as="script"><link rel="prefetch" href="/assets/GItæäº¤è§„åˆ™.html-BbkuFxfA.js" as="script"><link rel="prefetch" href="/assets/Git.html-CP6v5g8F.js" as="script"><link rel="prefetch" href="/assets/å®‰è£…GitLab.html-C6FyPn43.js" as="script"><link rel="prefetch" href="/assets/Helmå®‰è£…ä½¿ç”¨.html-DqpBmcwC.js" as="script"><link rel="prefetch" href="/assets/k8så­˜å‚¨.html-b0qLAHoR.js" as="script"><link rel="prefetch" href="/assets/k8så®‰è£….html-CVyeEsOS.js" as="script"><link rel="prefetch" href="/assets/k8så·¥ä½œè´Ÿè½½.html-CPXFQBIL.js" as="script"><link rel="prefetch" href="/assets/k8sèµ„æºPod.html-BVBtmDOF.js" as="script"><link rel="prefetch" href="/assets/k8sè¿›é˜¶.html-IB5mctFv.js" as="script"><link rel="prefetch" href="/assets/NginxåŸºç¡€.html-CnLyzRQN.js" as="script"><link rel="prefetch" href="/assets/åº”ç”¨éƒ¨ç½².html-s3orpM93.js" as="script"><link rel="prefetch" href="/assets/FiddleræŠ“åŒ…å·¥å…·.html-7d3I7Ah9.js" as="script"><link rel="prefetch" href="/assets/Postman.html-C_Q6oFel.js" as="script"><link rel="prefetch" href="/assets/Screen.html-4KKu8ZTl.js" as="script"><link rel="prefetch" href="/assets/rdesktop.html-Uzxi6CNT.js" as="script"><link rel="prefetch" href="/assets/tmux.html-Cqnb26u2.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œä»£ç†.html--UOrgrSA.js" as="script"><link rel="prefetch" href="/assets/åŸºæœ¬ä½¿ç”¨.html-DEnRRz2z.js" as="script"><link rel="prefetch" href="/assets/å®‰è£….html-J8yXBWul.js" as="script"><link rel="prefetch" href="/assets/APScheduler.html-B7jpX5Oh.js" as="script"><link rel="prefetch" href="/assets/Celery.html-RdSlIDYL.js" as="script"><link rel="prefetch" href="/assets/Celeryä½¿ç”¨åŸºç¡€.html-C8Y9vJrv.js" as="script"><link rel="prefetch" href="/assets/å¼‚æ­¥ä»»åŠ¡æ¦‚è¿°.html-D6CcNrWF.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ.html-BRfOh7jk.js" as="script"><link rel="prefetch" href="/assets/kafka.html-CPSh5CnL.js" as="script"><link rel="prefetch" href="/assets/kombu.html-B3YMAyJb.js" as="script"><link rel="prefetch" href="/assets/pika.html-C5NzGx_2.js" as="script"><link rel="prefetch" href="/assets/RPC.html-Q1CHswf3.js" as="script"><link rel="prefetch" href="/assets/gRPC.html-BOJW2fLJ.js" as="script"><link rel="prefetch" href="/assets/asyncio Recipes.html-C6hG0OkF.js" as="script"><link rel="prefetch" href="/assets/asyncioåŸºç¡€.html-CODnbQ5c.js" as="script"><link rel="prefetch" href="/assets/asyncioè¿›é˜¶.html-DCk6cw7U.js" as="script"><link rel="prefetch" href="/assets/äº‹ä»¶å¾ªç¯.html-CeESs0Nm.js" as="script"><link rel="prefetch" href="/assets/åº•å±‚å®ç°.html-D_F2sYtv.js" as="script"><link rel="prefetch" href="/assets/å¼‚æ­¥å›æº¯.html-CXLlnMlw.js" as="script"><link rel="prefetch" href="/assets/Pythoné¡¹ç›®æ‰“åŒ….html-BrTPPa3Z.js" as="script"><link rel="prefetch" href="/assets/pip.html-CbYUu7VG.js" as="script"><link rel="prefetch" href="/assets/å­—ç¬¦ç¼–ç .html-CwXZV3iV.js" as="script"><link rel="prefetch" href="/assets/æ•°æ®ç±»å‹.html-JeyjEUh4.js" as="script"><link rel="prefetch" href="/assets/æ–‡ä»¶åŸºç¡€.html-D5RkDgPf.js" as="script"><link rel="prefetch" href="/assets/æµç¨‹æ§åˆ¶.html-DxoMSW1b.js" as="script"><link rel="prefetch" href="/assets/ç¯å¢ƒå®‰è£….html-_8XXdYO7.js" as="script"><link rel="prefetch" href="/assets/Linuxæ–‡ä»¶é”.html-DTJVW4ke.js" as="script"><link rel="prefetch" href="/assets/åç¨‹.html-BlSuWy51.js" as="script"><link rel="prefetch" href="/assets/åŒæ­¥é˜Ÿåˆ—.html-BNN8w8Yv.js" as="script"><link rel="prefetch" href="/assets/å¤šçº¿ç¨‹ç¼–ç¨‹.html-BjMDahhF.js" as="script"><link rel="prefetch" href="/assets/å¤šè¿›ç¨‹ç¼–ç¨‹.html-CNxvZ0WA.js" as="script"><link rel="prefetch" href="/assets/çº¿ç¨‹.html-BSVCTTfu.js" as="script"><link rel="prefetch" href="/assets/çº¿ç¨‹è¿›ç¨‹è¾…åŠ©æœºåˆ¶.html-BIccM__q.js" as="script"><link rel="prefetch" href="/assets/è¿›ç¨‹.html-Dy3u-GFm.js" as="script"><link rel="prefetch" href="/assets/é«˜æ€§èƒ½ç¼–ç¨‹.html-B6Z7GaaM.js" as="script"><link rel="prefetch" href="/assets/æ ‡å‡†åº“é“¾æ¥.html-BuKv-v2N.js" as="script"><link rel="prefetch" href="/assets/Cpythonå¯¹è±¡.html-CxhTR5fq.js" as="script"><link rel="prefetch" href="/assets/åƒåœ¾å›æ”¶.html-BHp_1Tns.js" as="script"><link rel="prefetch" href="/assets/åºåˆ—è¿›é˜¶.html-N2JpeYHf.js" as="script"><link rel="prefetch" href="/assets/æ˜ å°„è¿›é˜¶.html-D8j7j3sM.js" as="script"><link rel="prefetch" href="/assets/è®¾è®¡æ¨¡å¼.html-CE0VV8CF.js" as="script"><link rel="prefetch" href="/assets/Socket.html-CVofpq0l.js" as="script"><link rel="prefetch" href="/assets/Websocket.html-z_OSsgBE.js" as="script"><link rel="prefetch" href="/assets/äº‹ä»¶æ¨¡å‹.html-daC0ro-b.js" as="script"><link rel="prefetch" href="/assets/å›è°ƒ.html-D7y4Y4xd.js" as="script"><link rel="prefetch" href="/assets/ä¿¡å·é‡.html-DaGLgwFk.js" as="script"><link rel="prefetch" href="/assets/å‡½æ•°.html-2vvXj3mi.js" as="script"><link rel="prefetch" href="/assets/å˜é‡æœºåˆ¶.html-kLj_uk_U.js" as="script"><link rel="prefetch" href="/assets/æ¨¡å—å’ŒåŒ….html-Db-L-1W7.js" as="script"><link rel="prefetch" href="/assets/ç”Ÿæˆå™¨.html-D-PZ7V4Z.js" as="script"><link rel="prefetch" href="/assets/è£…é¥°å™¨.html-Cld7uD8m.js" as="script"><link rel="prefetch" href="/assets/è¿­ä»£å™¨.html-DfL0Jiyu.js" as="script"><link rel="prefetch" href="/assets/é”™è¯¯å’Œå¼‚å¸¸.html-DAe21JhZ.js" as="script"><link rel="prefetch" href="/assets/é¢å‘å¯¹è±¡.html-D70ZysYj.js" as="script"><link rel="prefetch" href="/assets/DNSæœåŠ¡.html-DPOJNtzj.js" as="script"><link rel="prefetch" href="/assets/bind.html-CnPICcCI.js" as="script"><link rel="prefetch" href="/assets/è„šæœ¬è¯´æ˜.html-DMogZq37.js" as="script"><link rel="prefetch" href="/assets/ADåŸŸ.html-DXyXEEzI.js" as="script"><link rel="prefetch" href="/assets/LDAP.html-C9yNBmvh.js" as="script"><link rel="prefetch" href="/assets/Pythonå¯¹æ¥ADåŸŸ.html-DxDWjsDh.js" as="script"><link rel="prefetch" href="/assets/NFSæœåŠ¡.html-ib2o3Zqa.js" as="script"><link rel="prefetch" href="/assets/NTPæœåŠ¡.html-B-u1S177.js" as="script"><link rel="prefetch" href="/assets/SNMPæœåŠ¡.html-CEIFw1lA.js" as="script"><link rel="prefetch" href="/assets/SNMPè®¾è®¡æ–‡æ¡£.html-B9Oid_5W.js" as="script"><link rel="prefetch" href="/assets/SambaæœåŠ¡.html-B7_0aXze.js" as="script"><link rel="prefetch" href="/assets/rsync.html-BqtN4e-U.js" as="script"><link rel="prefetch" href="/assets/isoæ„å»ºä»¥åŠå‘å¸ƒ.html-BjfSK3XO.js" as="script"><link rel="prefetch" href="/assets/ufscliå·¥å…·.html-BAH9HGVG.js" as="script"><link rel="prefetch" href="/assets/ufsæ ¸å¿ƒç»„ä»¶.html-BUDObEq0.js" as="script"><link rel="prefetch" href="/assets/ufsç®¡ç†å¹³å°.html-WQQNj-S1.js" as="script"><link rel="prefetch" href="/assets/uusè™šæ‹Ÿæœºæ’é”™.html-B_7cTgxN.js" as="script"><link rel="prefetch" href="/assets/CentOSçš„å®‰è£….html-Dz9i05Iv.js" as="script"><link rel="prefetch" href="/assets/RPMåŒ…ç®¡ç†.html-DvI7yj-X.js" as="script"><link rel="prefetch" href="/assets/è´¦å·ç®¡ç†ä¸ACLæƒé™.html-D5kxDU3z.js" as="script"><link rel="prefetch" href="/assets/Linuxæ˜¯ä»€ä¹ˆä¸å¦‚ä½•å­¦ä¹ .html-iFZi3NRy.js" as="script"><link rel="prefetch" href="/assets/ä¸»æœºè§„åˆ’ä¸ç£ç›˜åˆ†åŒº.html-DMRk0-H_.js" as="script"><link rel="prefetch" href="/assets/è®¡ç®—æœºæ¦‚è®º.html-CBIlAJXu.js" as="script"><link rel="prefetch" href="/assets/Linuxç£ç›˜ä¸æ–‡ä»¶ç³»ç»Ÿç®¡ç†.html-CptnZlnq.js" as="script"><link rel="prefetch" href="/assets/æ–‡ä»¶ä¸æ–‡ä»¶ç³»ç»Ÿå‹ç¼©.html-Fi1xXw1j.js" as="script"><link rel="prefetch" href="/assets/æ–‡ä»¶æƒé™ä¸ç›®å½•é…ç½®.html-Dm6PesLz.js" as="script"><link rel="prefetch" href="/assets/è®¤è¯†ç³»ç»ŸæœåŠ¡.html-0z_WDRcW.js" as="script"><link rel="prefetch" href="/assets/shell.html-CkV7bVsQ.js" as="script"><link rel="prefetch" href="/assets/vim å¿«æ·é”®.html-sVMOsC5L.js" as="script"><link rel="prefetch" href="/assets/å¤‡å¿˜å‘½ä»¤.html-C_AqzxYE.js" as="script"><link rel="prefetch" href="/assets/æ•…éšœå¿«æŸ¥.html-B03aHWOa.js" as="script"><link rel="prefetch" href="/assets/æ“ä½œç³»ç»Ÿ.html-DMrKH2mh.js" as="script"><link rel="prefetch" href="/assets/CURL.html-Dw3VIy4m.js" as="script"><link rel="prefetch" href="/assets/P2P.html-Cp2hI8U3.js" as="script"><link rel="prefetch" href="/assets/å‘½ä»¤.html-DYXTMCMN.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œåŸºç¡€.html-D_gVbYVm.js" as="script"><link rel="prefetch" href="/assets/Ubuntuç³»ç»Ÿ.html-CvMYMhMv.js" as="script"><link rel="prefetch" href="/assets/CPU.html-CXiPnlxn.js" as="script"><link rel="prefetch" href="/assets/ä¸»æ¿.html-CWbYkSqY.js" as="script"><link rel="prefetch" href="/assets/å†…å­˜.html-CwRaPJG7.js" as="script"><link rel="prefetch" href="/assets/å­˜å‚¨.html-DNalI-l8.js" as="script"><link rel="prefetch" href="/assets/æ‰©å±•å¡ä¸æ¥å£.html-C6WhZTRe.js" as="script"><link rel="prefetch" href="/assets/æ˜¾å¡.html-D089B2cw.js" as="script"><link rel="prefetch" href="/assets/PVE.html-C-tV2l6M.js" as="script"><link rel="prefetch" href="/assets/æ·»åŠ ç£ç›˜.html-BeFtwKOP.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œé…ç½®.html-BP2jrbI8.js" as="script"><link rel="prefetch" href="/assets/DjangoåŸºç¡€.html-COzOLtgP.js" as="script"><link rel="prefetch" href="/assets/Djangoæ¦‚è¿°.html-eD2iGC2Y.js" as="script"><link rel="prefetch" href="/assets/FastAPIåŸºç¡€.html-Boz7KPgd.js" as="script"><link rel="prefetch" href="/assets/FastAPIåŸºç¡€äºŒ.html-Fnk3l4s2.js" as="script"><link rel="prefetch" href="/assets/tornado.html-D4fnqSij.js" as="script"><link rel="prefetch" href="/assets/WEBæ¡†æ¶æœ¬è´¨.html-D2r-nk2B.js" as="script"><link rel="prefetch" href="/assets/çŠ¶æ€ç®¡ç†.html-2FyuXvqs.js" as="script"><link rel="prefetch" href="/assets/404.html-C_GohGou.js" as="script"><link rel="prefetch" href="/assets/index.html-Bo_ouIf6.js" as="script"><link rel="prefetch" href="/assets/index.html-C6q0sBMJ.js" as="script"><link rel="prefetch" href="/assets/index.html-BVJnFIIS.js" as="script"><link rel="prefetch" href="/assets/index.html-BFEEWkTe.js" as="script"><link rel="prefetch" href="/assets/index.html--bCL2UXL.js" as="script"><link rel="prefetch" href="/assets/index.html-D9fbNOtQ.js" as="script"><link rel="prefetch" href="/assets/index.html-BIkI4N1X.js" as="script"><link rel="prefetch" href="/assets/index.html-8YhL-O-a.js" as="script"><link rel="prefetch" href="/assets/index.html-C0xYBPRs.js" as="script"><link rel="prefetch" href="/assets/index.html-Dpzcv9q1.js" as="script"><link rel="prefetch" href="/assets/index.html-WVmec6vN.js" as="script"><link rel="prefetch" href="/assets/index.html-B08edxYb.js" as="script"><link rel="prefetch" href="/assets/index.html-XfdZo5Hu.js" as="script"><link rel="prefetch" href="/assets/index.html-9Zy5boGH.js" as="script"><link rel="prefetch" href="/assets/index.html-DebnCup6.js" as="script"><link rel="prefetch" href="/assets/index.html-CXZjUyVW.js" as="script"><link rel="prefetch" href="/assets/index.html-BK5JcglY.js" as="script"><link rel="prefetch" href="/assets/index.html-DY9F1W4U.js" as="script"><link rel="prefetch" href="/assets/index.html-DBWL9-MG.js" as="script"><link rel="prefetch" href="/assets/index.html-B2k-JixG.js" as="script"><link rel="prefetch" href="/assets/index.html-mN2jtnsF.js" as="script"><link rel="prefetch" href="/assets/index.html-DOGyYZ89.js" as="script"><link rel="prefetch" href="/assets/index.html-C0uRlQN2.js" as="script"><link rel="prefetch" href="/assets/index.html-C27_P9I5.js" as="script"><link rel="prefetch" href="/assets/index.html-DMj3kThr.js" as="script"><link rel="prefetch" href="/assets/index.html-OwHV6npk.js" as="script"><link rel="prefetch" href="/assets/index.html-BYRAnqOE.js" as="script"><link rel="prefetch" href="/assets/index.html-DQ5hw4OS.js" as="script"><link rel="prefetch" href="/assets/index.html-zxdUSrlc.js" as="script"><link rel="prefetch" href="/assets/index.html-DfSJXsLe.js" as="script"><link rel="prefetch" href="/assets/index.html-CBPcW4_J.js" as="script"><link rel="prefetch" href="/assets/index.html-JXOQzNIi.js" as="script"><link rel="prefetch" href="/assets/index.html-4TA_k_vt.js" as="script"><link rel="prefetch" href="/assets/index.html-DhjJCozj.js" as="script"><link rel="prefetch" href="/assets/index.html-C9NT1Crj.js" as="script"><link rel="prefetch" href="/assets/index.html-DqX8SaH-.js" as="script"><link rel="prefetch" href="/assets/index.html-AtNafjyH.js" as="script"><link rel="prefetch" href="/assets/index.html-LKM-jLPb.js" as="script"><link rel="prefetch" href="/assets/index.html-Cwf1_US4.js" as="script"><link rel="prefetch" href="/assets/index.html-CkC3vtX-.js" as="script"><link rel="prefetch" href="/assets/index.html-CJ3a1U0s.js" as="script"><link rel="prefetch" href="/assets/index.html-Bw1iy84M.js" as="script"><link rel="prefetch" href="/assets/index.html-BAoz3UN5.js" as="script"><link rel="prefetch" href="/assets/index.html-QSX4D3eK.js" as="script"><link rel="prefetch" href="/assets/index.html-DrHdb_RC.js" as="script"><link rel="prefetch" href="/assets/index.html-dXZ6su36.js" as="script"><link rel="prefetch" href="/assets/index.html-jk4BYFAE.js" as="script"><link rel="prefetch" href="/assets/index.html-B2YkFjdn.js" as="script"><link rel="prefetch" href="/assets/index.html-Cwm1dXwc.js" as="script"><link rel="prefetch" href="/assets/index.html-CywvDvbK.js" as="script"><link rel="prefetch" href="/assets/index.html-50E0zLWZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BWuIGKSa.js" as="script"><link rel="prefetch" href="/assets/index.html-C6hRuQXf.js" as="script"><link rel="prefetch" href="/assets/index.html-Ct4vatx9.js" as="script"><link rel="prefetch" href="/assets/index.html-KugmZZ-4.js" as="script"><link rel="prefetch" href="/assets/index.html-BcFwFq_J.js" as="script"><link rel="prefetch" href="/assets/index.html-k4x7aSi2.js" as="script"><link rel="prefetch" href="/assets/index.html-DndFhckY.js" as="script"><link rel="prefetch" href="/assets/index.html-zGRxWl09.js" as="script"><link rel="prefetch" href="/assets/index.html-0OGCe7xF.js" as="script"><link rel="prefetch" href="/assets/index.html-msRoFKhL.js" as="script"><link rel="prefetch" href="/assets/index.html-DvYQuVJw.js" as="script"><link rel="prefetch" href="/assets/index.html-CbQrBlVk.js" as="script"><link rel="prefetch" href="/assets/index.html-1h0h7Foi.js" as="script"><link rel="prefetch" href="/assets/index.html-D4ASS3mJ.js" as="script"><link rel="prefetch" href="/assets/index.html-D4d9J2fk.js" as="script"><link rel="prefetch" href="/assets/index.html-CfLJRc-G.js" as="script"><link rel="prefetch" href="/assets/index.html-kB8nGwWY.js" as="script"><link rel="prefetch" href="/assets/index.html-CfLJRc-G.js" as="script"><link rel="prefetch" href="/assets/index.html-BJauSwbO.js" as="script"><link rel="prefetch" href="/assets/index.html-mC3u3DkZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BEJz4PvV.js" as="script"><link rel="prefetch" href="/assets/index.html-gINi0WmD.js" as="script"><link rel="prefetch" href="/assets/index.html-2QXRVASr.js" as="script"><link rel="prefetch" href="/assets/index.html-F0t8gThT.js" as="script"><link rel="prefetch" href="/assets/index.html-CH-9l0BY.js" as="script"><link rel="prefetch" href="/assets/index.html-DMulnjWz.js" as="script"><link rel="prefetch" href="/assets/index.html-BNfY3iEE.js" as="script"><link rel="prefetch" href="/assets/index.html-DaROIb6Z.js" as="script"><link rel="prefetch" href="/assets/index.html-DFCp9nGU.js" as="script"><link rel="prefetch" href="/assets/index.html-a8t652nk.js" as="script"><link rel="prefetch" href="/assets/index.html-BzkrU96k.js" as="script"><link rel="prefetch" href="/assets/index.html-CFzScHtr.js" as="script"><link rel="prefetch" href="/assets/index.html-BAc2-Uxx.js" as="script"><link rel="prefetch" href="/assets/index.html-C9Gj04Tn.js" as="script"><link rel="prefetch" href="/assets/index.html-DMnvr1Pe.js" as="script"><link rel="prefetch" href="/assets/index.html-BDLsHB-g.js" as="script"><link rel="prefetch" href="/assets/index.html-bR6Z_njI.js" as="script"><link rel="prefetch" href="/assets/index.html-DQ46NFGD.js" as="script"><link rel="prefetch" href="/assets/index.html-_jF8ilF1.js" as="script"><link rel="prefetch" href="/assets/index.html-BZQqjFNP.js" as="script"><link rel="prefetch" href="/assets/index.html-CnhOrdyO.js" as="script"><link rel="prefetch" href="/assets/index.html-Bpe-diDW.js" as="script"><link rel="prefetch" href="/assets/index.html-CcK7b76F.js" as="script"><link rel="prefetch" href="/assets/index.html-m7LRmz91.js" as="script"><link rel="prefetch" href="/assets/index.html-C_kIv0KU.js" as="script"><link rel="prefetch" href="/assets/index.html-Dvslf65e.js" as="script"><link rel="prefetch" href="/assets/index.html-DfBJgg3o.js" as="script"><link rel="prefetch" href="/assets/index.html-CnBKCWFL.js" as="script"><link rel="prefetch" href="/assets/index.html-D7NgI3Wc.js" as="script"><link rel="prefetch" href="/assets/index.html-B_uYRI3s.js" as="script"><link rel="prefetch" href="/assets/index.html-D8rWHeVo.js" as="script"><link rel="prefetch" href="/assets/index.html-B21PIvde.js" as="script"><link rel="prefetch" href="/assets/index.html-B0lWLG2A.js" as="script"><link rel="prefetch" href="/assets/index.html-D47TWyAF.js" as="script"><link rel="prefetch" href="/assets/index.html-DUceuGb3.js" as="script"><link rel="prefetch" href="/assets/index.html-2CIPXhyM.js" as="script"><link rel="prefetch" href="/assets/index.html-rs2uIvDF.js" as="script"><link rel="prefetch" href="/assets/index.html-BTxXqn2V.js" as="script"><link rel="prefetch" href="/assets/index.html-CBANSrqy.js" as="script"><link rel="prefetch" href="/assets/index.html-2CIPXhyM.js" as="script"><link rel="prefetch" href="/assets/index.html-f0i2UYj8.js" as="script"><link rel="prefetch" href="/assets/index.html-CVb4wQYc.js" as="script"><link rel="prefetch" href="/assets/index.html-f-awGB2v.js" as="script"><link rel="prefetch" href="/assets/index.html-BVImBltl.js" as="script"><link rel="prefetch" href="/assets/index.html-DPVDOwLC.js" as="script"><link rel="prefetch" href="/assets/index.html-IMO6BICp.js" as="script"><link rel="prefetch" href="/assets/index.html-BFp0gS_r.js" as="script"><link rel="prefetch" href="/assets/index.html-4IKPG-x-.js" as="script"><link rel="prefetch" href="/assets/index.html-D3CpRPL4.js" as="script"><link rel="prefetch" href="/assets/index.html-DC-BwgYA.js" as="script"><link rel="prefetch" href="/assets/index.html-BIIxRCa8.js" as="script"><link rel="prefetch" href="/assets/index.html-Et6TMLBz.js" as="script"><link rel="prefetch" href="/assets/index.html-BkFZvRKv.js" as="script"><link rel="prefetch" href="/assets/index.html-D7YoN4G4.js" as="script"><link rel="prefetch" href="/assets/index.html-CyRnilC1.js" as="script"><link rel="prefetch" href="/assets/index.html-a-nQock1.js" as="script"><link rel="prefetch" href="/assets/index.html-BkFZvRKv.js" as="script"><link rel="prefetch" href="/assets/index.html-C8nU2OyX.js" as="script"><link rel="prefetch" href="/assets/index.html-Di_sHZZ9.js" as="script"><link rel="prefetch" href="/assets/index.html-Cskh60as.js" as="script"><link rel="prefetch" href="/assets/index.html-DQBdilmy.js" as="script"><link rel="prefetch" href="/assets/index.html-NMivtXpY.js" as="script"><link rel="prefetch" href="/assets/index.html-CZ7F2OLU.js" as="script"><link rel="prefetch" href="/assets/index.html-B9F6A-Xx.js" as="script"><link rel="prefetch" href="/assets/index.html-wyRi4HHt.js" as="script"><link rel="prefetch" href="/assets/index.html-CPrLfczv.js" as="script"><link rel="prefetch" href="/assets/index.html-DCZJtnps.js" as="script"><link rel="prefetch" href="/assets/index.html-B1Okyl98.js" as="script"><link rel="prefetch" href="/assets/index.html-DeRMETns.js" as="script"><link rel="prefetch" href="/assets/index.html-Mj-q6TG-.js" as="script"><link rel="prefetch" href="/assets/index.html-fcG4Ozpd.js" as="script"><link rel="prefetch" href="/assets/index.html-B6p2guA-.js" as="script"><link rel="prefetch" href="/assets/index.html-BBvE_QB8.js" as="script"><link rel="prefetch" href="/assets/index.html-IF2L1ffG.js" as="script"><link rel="prefetch" href="/assets/index.html-CnxmpEgZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DiS-WcGY.js" as="script"><link rel="prefetch" href="/assets/index.html-B6ET51xg.js" as="script"><link rel="prefetch" href="/assets/index.html-XOcAWzmX.js" as="script"><link rel="prefetch" href="/assets/index.html-DvF9GNT4.js" as="script"><link rel="prefetch" href="/assets/index.html-DpM8JpZZ.js" as="script"><link rel="prefetch" href="/assets/index.html-xx_TigWr.js" as="script"><link rel="prefetch" href="/assets/index.html-C8BYmGBC.js" as="script"><link rel="prefetch" href="/assets/index.html-Cc69bV91.js" as="script"><link rel="prefetch" href="/assets/index.html-Di0cFJp4.js" as="script"><link rel="prefetch" href="/assets/index.html-DkKt9X7D.js" as="script"><link rel="prefetch" href="/assets/index.html-kwCDGehg.js" as="script"><link rel="prefetch" href="/assets/index.html-DBnyTRmE.js" as="script"><link rel="prefetch" href="/assets/index.html-CyLIG-wI.js" as="script"><link rel="prefetch" href="/assets/index.html-DkIb6yTT.js" as="script"><link rel="prefetch" href="/assets/index.html-CP7M_aGY.js" as="script"><link rel="prefetch" href="/assets/index.html-0MYZRljG.js" as="script"><link rel="prefetch" href="/assets/index.html-Duxx4BKi.js" as="script"><link rel="prefetch" href="/assets/index.html-CKClHdaK.js" as="script"><link rel="prefetch" href="/assets/index.html-N6BvhB2l.js" as="script"><link rel="prefetch" href="/assets/index.html-C8-IstAK.js" as="script"><link rel="prefetch" href="/assets/index.html-i9sd72dO.js" as="script"><link rel="prefetch" href="/assets/index.html-DzZwV6s1.js" as="script"><link rel="prefetch" href="/assets/index.html-C-lLZrh8.js" as="script"><link rel="prefetch" href="/assets/index.html-FloYdTiF.js" as="script"><link rel="prefetch" href="/assets/index.html-B51U3KzB.js" as="script"><link rel="prefetch" href="/assets/index.html-Bl90hhor.js" as="script"><link rel="prefetch" href="/assets/index.html-CC44uZFy.js" as="script"><link rel="prefetch" href="/assets/index.html-TrbQGD_7.js" as="script"><link rel="prefetch" href="/assets/index.html-C1JOr1yt.js" as="script"><link rel="prefetch" href="/assets/index.html-Cs3EJDCq.js" as="script"><link rel="prefetch" href="/assets/index.html-DLpfyrzv.js" as="script"><link rel="prefetch" href="/assets/index.html-DZ1bcEEh.js" as="script"><link rel="prefetch" href="/assets/index.html-BDg0m2OZ.js" as="script"><link rel="prefetch" href="/assets/index.html-Dij1d3tk.js" as="script"><link rel="prefetch" href="/assets/index.html-WpEXxee1.js" as="script"><link rel="prefetch" href="/assets/index.html-BsbEUffA.js" as="script"><link rel="prefetch" href="/assets/index.html-DQNsxjXu.js" as="script"><link rel="prefetch" href="/assets/index.html-DSMq4TBe.js" as="script"><link rel="prefetch" href="/assets/index.html-D9RJQRLh.js" as="script"><link rel="prefetch" href="/assets/index.html-StiFSEem.js" as="script"><link rel="prefetch" href="/assets/index.html-DeGNHpIz.js" as="script"><link rel="prefetch" href="/assets/index.html-XvY5wZC_.js" as="script"><link rel="prefetch" href="/assets/index.html-D70l3QSx.js" as="script"><link rel="prefetch" href="/assets/index.html-1hfpKXPh.js" as="script"><link rel="prefetch" href="/assets/index.html-CVuNFVlG.js" as="script"><link rel="prefetch" href="/assets/index.html-DswMnk_v.js" as="script"><link rel="prefetch" href="/assets/index.html-D9BC3i8p.js" as="script"><link rel="prefetch" href="/assets/index.html-_xPZRUXa.js" as="script"><link rel="prefetch" href="/assets/index.html-qcDFDyM3.js" as="script"><link rel="prefetch" href="/assets/index.html-DR_mqwQI.js" as="script"><link rel="prefetch" href="/assets/index.html-C9oha2iY.js" as="script"><link rel="prefetch" href="/assets/index.html-Cqc6S9cp.js" as="script"><link rel="prefetch" href="/assets/index.html-CbtZIoW5.js" as="script"><link rel="prefetch" href="/assets/index.html-Cl7tw7h0.js" as="script"><link rel="prefetch" href="/assets/index.html-C9oha2iY.js" as="script"><link rel="prefetch" href="/assets/index.html-BpfkmxGa.js" as="script"><link rel="prefetch" href="/assets/index.html-BFfa3tKT.js" as="script"><link rel="prefetch" href="/assets/index.html-CGbKTj3z.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/avatar.jpg" alt><!----><span class="vp-site-name hide-in-pad">æ‚¦ â–ª å®å®</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ" iconsizing="height"><!--[--><i class="vp-icon iconfont icon-home" sizing="height"></i><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Python"><!--[--><i class="vp-icon iconfont icon-python" sizing="height"></i>Python<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">è¯­è¨€</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80/%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85.html" aria-label="åŸºç¡€" iconsizing="both"><!---->åŸºç¡€<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E8%BF%9B%E9%98%B6/%E5%8F%98%E9%87%8F%E6%9C%BA%E5%88%B6.html" aria-label="è¿›é˜¶" iconsizing="both"><!---->è¿›é˜¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E6%B7%B1%E5%85%A5/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6.html" aria-label="æ·±å…¥" iconsizing="both"><!---->æ·±å…¥<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/Socket.html" aria-label="ç½‘ç»œç¼–ç¨‹" iconsizing="both"><!---->ç½‘ç»œç¼–ç¨‹<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%BC%96%E7%A8%8B/%E8%BF%9B%E7%A8%8B.html" aria-label="å¤šä»»åŠ¡ç¼–ç¨‹" iconsizing="both"><!---->å¤šä»»åŠ¡ç¼–ç¨‹<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/asyncio/asyncio%E5%9F%BA%E7%A1%80.html" aria-label="asyncio" iconsizing="both"><!---->asyncio<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E5%BA%93/%E6%A0%87%E5%87%86%E5%BA%93%E9%93%BE%E6%8E%A5.html" aria-label="åº“" iconsizing="both"><!---->åº“<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ç”Ÿæ€</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/Web%E6%A1%86%E6%9E%B6/%E7%BD%91%E7%BB%9C%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80/WEB%E6%A1%86%E6%9E%B6%E6%9C%AC%E8%B4%A8.html" aria-label="Webæ¡†æ¶" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-framework" sizing="both"></i><!--]-->Webæ¡†æ¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8/gRPC.html" aria-label="è¿œç¨‹è°ƒç”¨" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-rpc" sizing="both"></i><!--]-->è¿œç¨‹è°ƒç”¨<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/kafka.html" aria-label="æ¶ˆæ¯é˜Ÿåˆ—" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-kafka" sizing="both"></i><!--]-->æ¶ˆæ¯é˜Ÿåˆ—<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/Celery.html" aria-label="å¼‚æ­¥ä»»åŠ¡" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-tasks" sizing="both"></i><!--]-->å¼‚æ­¥ä»»åŠ¡<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Golang"><!--[--><i class="vp-icon iconfont icon-go" sizing="height"></i>Golang<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">åŸºç¡€</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E5%9F%BA%E7%A1%80/go%E8%AF%AD%E8%A8%80%E9%80%9F%E8%AE%B0.html" aria-label="goè¯­è¨€é€Ÿè®°" iconsizing="both"><!---->goè¯­è¨€é€Ÿè®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E5%9F%BA%E7%A1%80/go%E5%B7%A5%E5%85%B7%E9%80%9F%E7%94%A8.html" aria-label="goå·¥å…·é€Ÿç”¨" iconsizing="both"><!---->goå·¥å…·é€Ÿç”¨<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ç®—æ³•ä¸æ•°æ®ç»“æ„</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E7%BB%84.html" aria-label="æ•°ç»„" iconsizing="both"><!---->æ•°ç»„<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8.html" aria-label="çº¿æ€§è¡¨" iconsizing="both"><!---->çº¿æ€§è¡¨<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97.html" aria-label="æ ˆä¸é˜Ÿåˆ—" iconsizing="both"><!---->æ ˆä¸é˜Ÿåˆ—<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91.html" aria-label="æ ‘" iconsizing="both"><!---->æ ‘<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ•°æ®åº“"><!--[--><i class="vp-icon iconfont icon-database" sizing="height"></i>æ•°æ®åº“<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/etcd/etcd.html" aria-label="etcd" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-etcd" sizing="both"></i><!--]-->etcd<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/MySQL/MySQL.html" aria-label="MySQL" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-mysql" sizing="both"></i><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/Redis/redis.html" aria-label="Redis" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-redis" sizing="both"></i><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/PostgreSQL/PostgreSQL.html" aria-label="PostgreSQL" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-postgresql" sizing="both"></i><!--]-->PostgreSQL<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ“ä½œç³»ç»Ÿ"><!--[--><i class="vp-icon iconfont icon-os" sizing="height"></i>æ“ä½œç³»ç»Ÿ<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/Linux/Linux%E5%9F%BA%E7%A1%80%E6%8C%87%E5%BC%95/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%A6%82%E8%AE%BA.html" aria-label="Linux" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-linux" sizing="both"></i><!--]-->Linux<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/CentOS/%E5%AE%89%E8%A3%85/CentOS%E7%9A%84%E5%AE%89%E8%A3%85.html" aria-label="CentOS" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-centos" sizing="both"></i><!--]-->CentOS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/Ubuntu/%E4%B8%8B%E8%BD%BD/Ubuntu%E7%B3%BB%E7%BB%9F.html" aria-label="Ubuntu" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-ubuntu" sizing="both"></i><!--]-->Ubuntu<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/%E8%99%9A%E6%8B%9F%E6%9C%BA/PVE/PVE.html" aria-label="è™šæ‹Ÿæœº" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-pve" sizing="both"></i><!--]-->è™šæ‹Ÿæœº<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="è¿ç»´å·¥å…·"><!--[--><i class="vp-icon iconfont icon-devops" sizing="height"></i>è¿ç»´å·¥å…·<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Git/Git.html" aria-label="Git" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-git" sizing="both"></i><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Nginx/Nginx%E5%9F%BA%E7%A1%80.html" aria-label="Nginx" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-nginx" sizing="both"></i><!--]-->Nginx<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Docker/docker%E5%AE%B9%E5%99%A8.html" aria-label="Docker" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-docker" sizing="both"></i><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Kubernetes/k8s%E8%B5%84%E6%BA%90Pod.html" aria-label="Kubernetes" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-kubernetes" sizing="both"></i><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Prometheus/%E5%AE%89%E8%A3%85.html" aria-label="Prometheus" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-prometheus" sizing="both"></i><!--]-->Prometheus<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Other/%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86.html" aria-label="å·¥å…·" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-other" sizing="both"></i><!--]-->å·¥å…·<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ¼«æ¼«å…¨å¹²å·çš„è‹¦"><!--[--><!---->æ¼«æ¼«å…¨å¹²å·çš„è‹¦<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://draveness.me/golang/" aria-label="GOè¯­è¨€è®¾è®¡ä¸å®ç°" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-go" sizing="both"></i><!--]-->GOè¯­è¨€è®¾è®¡ä¸å®ç°<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://pegasuswang.github.io/LetsGo/basics/01_go_basic_types/basic_types/" aria-label="GOå¤‡å¿˜" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-go" sizing="both"></i><!--]-->GOå¤‡å¿˜<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://notes.fe-mm.com/interview/base/types.html" aria-label="å‰ç«¯å†…å·ä¸å½’è·¯" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-javascript" sizing="both"></i><!--]-->å‰ç«¯å†…å·ä¸å½’è·¯<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/Igarashi-G" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><i class="vp-icon iconfont icon-kubernetes" sizing="both"></i><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/tool/Kubernetes/" aria-label="Kubernetes" iconsizing="both"><!---->Kubernetes<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/tool/Kubernetes/k8s%E5%AE%89%E8%A3%85.html" aria-label="Kubernets å®‰è£…(å•Master)" iconsizing="both"><!---->Kubernets å®‰è£…(å•Master)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/tool/Kubernetes/k8s%E8%B5%84%E6%BA%90Pod.html" aria-label="Kubernets - Pod" iconsizing="both"><!---->Kubernets - Pod<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/tool/Kubernetes/k8s%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD.html" aria-label="Kubernets - å·¥ä½œè´Ÿè½½" iconsizing="both"><!---->Kubernets - å·¥ä½œè´Ÿè½½<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/tool/Kubernetes/k8s%E6%9C%8D%E5%8A%A1.html" aria-label="Kubernets - æœåŠ¡" iconsizing="both"><!---->Kubernets - æœåŠ¡<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/tool/Kubernetes/k8s%E5%AD%98%E5%82%A8.html" aria-label="Kubernets - å­˜å‚¨" iconsizing="both"><!---->Kubernets - å­˜å‚¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/tool/Kubernetes/k8s%E8%BF%9B%E9%98%B6.html" aria-label="Kubernetsè¿›é˜¶" iconsizing="both"><!---->Kubernetsè¿›é˜¶<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/tool/Kubernetes/Helm%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8.html" aria-label="Helm å®‰è£…ä½¿ç”¨" iconsizing="both"><!---->Helm å®‰è£…ä½¿ç”¨<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Kubernets - æœåŠ¡</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/Igarashi-G" target="_blank" rel="noopener noreferrer">æ‚¦Â·å®å®</a></span><span property="author" content="æ‚¦Â·å®å®"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2022/10/6</span><meta property="datePublished" content="2022-10-06T00:00:00.000Z"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color0 clickable" role="navigation">è¿ç»´</span><span class="page-category-item color5 clickable" role="navigation">k8s</span><!--]--><meta property="articleSection" content="è¿ç»´,k8s"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color5 clickable" role="navigation">k8s</span><!--]--><meta property="keywords" content="k8s"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 21 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT21M"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><p><strong>k8s</strong> æœåŠ¡ã€è´Ÿè½½å‡è¡¡ å’Œ è”ç½‘</p><h2 id="_1-service-æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_1-service-æœåŠ¡"><span>1. Service æœåŠ¡</span></a></h2><p>æ­¤æ—¶ï¼Œå·²èƒ½é€šè¿‡ <strong>Deployment</strong> åˆ›å»ºå¸¦å‰¯æœ¬çš„ <strong>Pod</strong> æä¾›é«˜å¯ç”¨æ€§çš„æœåŠ¡äº†ï¼Œä½†å³ä½¿æ¯ä¸ª <strong>Pod</strong> éƒ½ä¼šåˆ†é…å•ç‹¬ <strong>IP</strong>ï¼Œå´å­˜åœ¨å¦‚ä¸‹é—®é¢˜</p><ul><li><strong>Pod IP</strong> ä»…ä»…æ˜¯é›†ç¾¤å†…å¯è§çš„è™šæ‹Ÿ <strong>IP</strong>ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®</li><li><strong>Pod IP</strong> ä¼šéšç€ <strong>Pod</strong> é”€æ¯è€Œæ¶ˆå¤±ï¼Œå½“ <strong>ReplicaSet</strong> å¯¹ <strong>Pod</strong> è¿›è¡ŒåŠ¨æ€ä¼¸ç¼©æ—¶ï¼Œ<strong>Pod IP</strong> å¯èƒ½éšæ—¶éšåœ°éƒ½ä¼šå˜åŒ–ï¼Œå¯¹äºè®¿é—®æœåŠ¡å¸¦æ¥äº†éš¾åº¦</li></ul><h4 id="é‚£ä¹ˆä»€ä¹ˆæ˜¯-serveice" tabindex="-1"><a class="header-anchor" href="#é‚£ä¹ˆä»€ä¹ˆæ˜¯-serveice"><span>é‚£ä¹ˆä»€ä¹ˆæ˜¯ Serveice ï¼Ÿ</span></a></h4><p><strong>Service</strong> æ˜¯ä¸€ç»„ <strong>Pod</strong> çš„æœåŠ¡æŠ½è±¡ï¼ˆ<em>ä¸€ç§å¯ä»¥è®¿é—® <strong>Pod</strong> çš„ç­–ç•¥</em> ï¼‰ï¼Œä¹Ÿå¯ä»¥ç®€å•ç†è§£ä¸ºé€»è¾‘ä¸Šä¸€ç»„ <strong>Pod</strong> çš„ <strong>LBï¼ˆ<em>Load Balance</em>ï¼‰</strong>ï¼Œè´Ÿè´£å°†è¯·æ±‚åˆ†å‘ç»™å¯¹åº”çš„ <strong>Pod</strong> ï¼Œç”¨æ¥ç»™ <strong>Pod</strong> é€šä¿¡çš„</p><p><strong>svc</strong> ä¸€æ—¦åˆ›å»ºï¼Œå³ä½¿é‡å»ºï¼Œåç§°ä¹Ÿä¸ä¼šæ”¹å˜</p><h4 id="ç±»å‹å¦‚ä¸‹" tabindex="-1"><a class="header-anchor" href="#ç±»å‹å¦‚ä¸‹"><span>ç±»å‹å¦‚ä¸‹</span></a></h4><ul><li><strong>Cluster IPï¼š</strong> é›†ç¾¤å†…éƒ¨ä½¿ç”¨ï¼Œé»˜è®¤å€¼ï¼Œç”¨äºè´Ÿè½½</li><li><strong>ExternalNameï¼š</strong> è¿”å›å®šä¹‰çš„ <strong>CNAME</strong> åˆ«åï¼Œç”¨äºåä»£åŸŸå</li><li><strong>NodePortï¼š</strong> åœ¨æ‰€æœ‰å®‰è£…äº† <strong>kube-proxy</strong> çš„èŠ‚ç‚¹ä¸Šï¼Œæ‰“å¼€ä¸€ä¸ªå¯ä¾›å¤–éƒ¨è®¿é—® <strong>pod</strong> çš„ç«¯å£</li><li><strong>loadBalancerï¼š</strong> ä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨å…¬å¼€æœåŠ¡ <ul><li>å¦‚ï¼šé˜¿é‡Œã€è…¾è®¯äº‘æ”¯æŒè¯¥æ ¼å¼ï¼Œå‘è¯·æ±‚å¹¶ç”Ÿæˆ <strong>IP</strong> åœ°å€</li></ul></li></ul><h3 id="_1-1-cluster-ip-è´Ÿè½½å‡è¡¡" tabindex="-1"><a class="header-anchor" href="#_1-1-cluster-ip-è´Ÿè½½å‡è¡¡"><span>1.1 Cluster IPï¼ˆ<em>è´Ÿè½½å‡è¡¡</em> ï¼‰</span></a></h3><p><strong>Service</strong> ä¼šä¸ºè¿™ä¸ª <strong>LB</strong> æä¾›ä¸€ä¸ª <strong>Cluster IP</strong> ï¼Œä½¿ç”¨ <strong>Service</strong> å¯¹è±¡ï¼Œé€šè¿‡ <strong>selector è¿›è¡Œæ ‡ç­¾é€‰æ‹©</strong>ï¼Œå³å¯æ‰¾åˆ°å¯¹åº”çš„ <strong>Pod</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¯æ¬¡éƒ½è¾“å…¥ä¸€ä¸² kubectl xxxå¤ªç´¯ï¼Œå¯ä»¥èµ·åˆ«å</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kd=&#39;kubectl -n uit&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ­¤æ—¶æŸ¥çœ‹ pod æ ‡ç­¾ï¼Œåœ¨ deploy é…ç½®ä¸­æ›¾æŒ‡å®šäº† app=myblog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> po</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --show-labels</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     READY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   STATUS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    RESTARTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   AGE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     LABELS</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-6fbb5cc967-48dfd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          2d12h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   app=mysql,pod-template-hash=6fbb5cc967</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ublog-5ff678657f-7qx5z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          42m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     app=myblog,pod-template-hash=5ff678657f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ublog-5ff678657f-rk92z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          43m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     app=myblog,pod-template-hash=5ff678657f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ublog-5ff678657f-tzspj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          42m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     app=myblog,pod-template-hash=5ff678657f</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Service</strong> çš„ <strong>yaml</strong> æ–‡ä»¶å¦‚ä¸‹</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ublog-svc</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uit</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:					</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è‹¥å¦‚ Nginx æœ‰ 80ã€443 åˆ™å¯ä»¥æŒ‡å®šå¤šä¸ªç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# Service çš„ç«¯å£ </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">TCP</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			# åè®®: UDPã€TCPã€SCTP  default: TCP</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    targetPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8002</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# åç«¯åº”ç”¨çš„ç«¯å£ï¼ˆå®¹å™¨æœåŠ¡çš„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  selector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">myblog</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# é€šè¿‡æ ‡ç­¾è¿‡æ»¤å¹¶é€‰æ‹©åº”ç”¨</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ClusterIP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚ä¸Šé…ç½®ç«¯å£ï¼Œ<strong>ServiceA</strong> è®¿é—® <strong>ServiceB</strong> å¯åˆ©ç”¨ <code>servicea --&gt; serviceb http://serviceb</code>ï¼Œè‹¥ç«¯å£é <strong>80</strong> , å‡å¦‚æ˜¯ <strong>8080</strong> åˆ™é€šè¿‡ <code>http://serviceb:8080</code> å³å¯</p><p>åˆ›å»º <strong>Service</strong> å¹¶æŸ¥çœ‹</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ›å»º svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-ublog.yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">service/svc-ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> created</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ svcï¼Œæ­¤æ—¶å·²åˆ›å»ºäº† CLUSTER-IP 10.105.146.135 80 ç«¯å£çš„æœåŠ¡ï¼ˆå»ºè®®è‡ªåŠ¨ç”Ÿæˆ ClusterIP è€ŒéæŒ‡å®šï¼‰</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -nuit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CLUSTER-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       EXTERNAL-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)   </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">svc-ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.105.146.135</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">80/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    7m51s</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹è¯¦æƒ…ï¼Œæ­¤æ—¶å‘ç° endpoints å·²ç»ä»£ç†äº†å¯¹åº”çš„ app = myblog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -nuit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> describe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              svc-ublog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Namespace:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         uit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Labels:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Annotations:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Selector:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          app=myblog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              ClusterIP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">IP:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                10.105.146.135</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Port:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">              &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">80/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TargetPort:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        8002/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Endpoints:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         10.244.1.35:8002,10.244.2.32:8002,10.244.2.33:8002</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Session</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Affinity:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  None</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Events:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ­¤æ—¶è®¿é—® 80 ç«¯å£ï¼ŒæœåŠ¡æ­£å¸¸</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.105.146.135/blog/index/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç¼©å®¹ ublog æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scale</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> deploy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ublog</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --replicas=2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">deployment.apps/ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scaled</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹svcè¯¦æƒ…ï¼Œæ­¤æ—¶å‘ç° endpoints è‡ªåŠ¨å‡ä¸€</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> describe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              svc-ublog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Namespace:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         uit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Labels:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Annotations:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Selector:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          app=myblog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              ClusterIP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">IP:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                10.105.146.135</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Port:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">              &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">80/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TargetPort:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        8002/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Endpoints:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         10.244.1.35:8002,10.244.2.32:8002</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Session</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Affinity:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  None</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Events:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>åˆ›å»º <strong>Service</strong> æ—¶ï¼Œè‹¥é…ç½®æ ‡ç­¾é€‰æ‹© <strong>pod</strong> ï¼Œä¼šæ”¶é›†å…¶ <strong>IP</strong>ï¼Œè‡ªåŠ¨åˆ›å»ºåŒåçš„ <strong>endpoints</strong> å¯¹è±¡ï¼Œè‹¥ <strong>Pod</strong> ä¸Šé…ç½®äº† <strong>readinessProbe</strong>ï¼Œæ£€æµ‹å¤±è´¥æ—¶ï¼Œ<strong>endpoints</strong> åˆ—è¡¨ä¼šå‰”é™¤æ‰å¯¹åº”çš„ <strong>Pod IP</strong>ï¼Œè¿™æ ·æµé‡å°±ä¸ä¼šåˆ†å‘åˆ°å¥åº·æ£€æµ‹å¤±è´¥çš„ <strong>Pod</strong> ä¸Š</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> endpoints</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-ublog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        ENDPOINTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                           AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">svc-ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   10.244.1.35:8002,10.244.2.32:8002</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   21m</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>å†æ¬¡æ”¹é€  <strong>MySQL</strong>ï¼Œåˆ›å»º <strong>Service</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-mysql</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uit</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3306</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">TCP</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    targetPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3306</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  selector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ClusterIP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºå¹¶è®¿é—®</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-mysql.yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">service/mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> created</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-mysql</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CLUSTER-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EXTERNAL-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)    </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">svc-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.98.22.166</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">3306/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   21s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.98.22.166:3306</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">è‹¥ç”¨ hostNetwork éƒ¨ç½²ï¼Œé€šè¿‡å®¿ä¸»æœº ip:port å½¢å¼è®¿é—®ï¼Œä¼šæœ‰å¦‚ä¸‹å¼Šç«¯</p><ul><li>æœåŠ¡ä½¿ç”¨ <strong>hostNetwork</strong>ï¼Œä½¿å¾—å®¿ä¸»æœºçš„ç«¯å£å¤§é‡æš´æ¼ï¼Œ<strong>å­˜åœ¨å®‰å…¨éšæ‚£</strong></li><li>å®¹æ˜“å¼•å‘ç«¯å£å†²çª</li></ul><p>å› æ­¤ï¼Œåº”è¯¥ä¸º <strong>MySQL</strong> åˆ›å»º <strong>Service</strong>ï¼Œå¹¶é…åˆ° <strong>ublog</strong> çš„ç¯å¢ƒå˜é‡ä¸­ï¼Œåˆ©ç”¨é›†ç¾¤æœåŠ¡å‘ç°çš„èƒ½åŠ›ï¼Œç»„ä»¶é—´é€šè¿‡ <strong>Service Name</strong> è®¿é—®</p></div><h3 id="_1-2-æœåŠ¡å‘ç°-ç¯å¢ƒå˜é‡å»-ip-åŒ–" tabindex="-1"><a class="header-anchor" href="#_1-2-æœåŠ¡å‘ç°-ç¯å¢ƒå˜é‡å»-ip-åŒ–"><span>1.2 æœåŠ¡å‘ç°ï¼ˆ<em>ç¯å¢ƒå˜é‡å» IP åŒ–</em> ï¼‰</span></a></h3><p><strong>k8s</strong> é›†ç¾¤ä¸­ï¼Œç»„ä»¶é—´å¯ä»¥é€šè¿‡ <strong>Service Name</strong> å®ç°é€šä¿¡ï¼Œ<strong>Pods</strong> é—´ï¼Œæ— éœ€é€šè¿‡ <strong>å›ºå®šç¯å¢ƒå˜é‡ IP</strong> çš„å½¢å¼</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ä¸Šæ–‡åˆ›å»ºçš„ svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-mysql</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CLUSTER-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EXTERNAL-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)    </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">svc-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.98.22.166</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">3306/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   151m</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¿é—®ä»»æ„ä¸€ä¸ªä¸šåŠ¡ pod ublog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ti</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ublog-5ff678657f-rk92z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># curl cluster ipï¼Œå¯æ­£å¸¸è¿é€š MySQL</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.98.22.166:3306</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># curl svc-mysqlï¼Œå‘ç°ä¾ç„¶å¯æ­£å¸¸è¿é€š MySQLï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-mysql:3306</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°½ç®¡ <strong>Pod IP</strong> å’Œ <strong>Cluster IP</strong> éƒ½ä¸å›ºå®šï¼ˆ<em><strong>é‡å¯ä¼šå˜æ›´</strong></em> ï¼‰ï¼Œä½† <strong>Service Name</strong> æ˜¯å›ºå®šçš„ï¼Œä¸”å®Œå…¨å…·æœ‰è·¨é›†ç¾¤çš„å¯ç§»æ¤æ€§ï¼Œå®ç°åŸç†å¦‚ä¸‹</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹å½“å‰çš„ DNS é…ç½®ï¼Œå‘ç°æœ‰ä¸ª 10.96.0.10 çš„ IP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/resolv.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nameserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10.96.0.10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit.svc.cluster.local</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc.cluster.local</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cluster.local</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">options</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ndots:5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é€€å‡ºå®¹å™¨ï¼Œå¹¶æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´ï¼Œå‘ç° kube-system ä¸‹æœ‰ä¸ª kube-dnsï¼Œå®ƒçš„ IP åˆšå¥½åŒä¸Š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --all-namespaces</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAMESPACE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CLUSTER-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       EXTERNAL-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)                  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                kubernetes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.96.0.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">443/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  23d</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kube-system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            kube-dns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.96.0.10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">53/UDP,53/TCP,9153/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   23d</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kubernetes-dashboard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   dashboard-metrics-scraper</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.96.54.184</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">8000/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 22d</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kubernetes-dashboard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   kubernetes-dashboard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        NodePort</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    10.97.63.15</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">443:30100/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            22d</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    svc-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.98.22.166</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">3306/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 157m</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    svc-ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.105.146.135</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">80/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   3h5m</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ kube-dns è¿™ä¸ª Service è¯¦æƒ…ï¼Œå‘ç°é€‰æ‹©å™¨ Selector é€‰äº† k8s-app=kube-dns è¿™ä¸ªæ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> describe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-dns</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              kube-dns</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Namespace:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         kube-system</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Labels:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            k8s-app=kube-dns</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">                   kubernetes.io/cluster-service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">                   kubernetes.io/name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=KubeDNS</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Annotations:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       prometheus.io/port:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 9153</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">                   prometheus.io/scrape:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Selector:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          k8s-app=kube-dns</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              ClusterIP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">IP:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                10.96.0.10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Port:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              dns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  53/UDP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TargetPort:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        53/UDP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Endpoints:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         10.244.0.5:53,10.244.0.6:53</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Port:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              dns-tcp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  53/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TargetPort:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        53/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Endpoints:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         10.244.0.5:53,10.244.0.6:53</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Port:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              metrics</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  9153/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TargetPort:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        9153/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Endpoints:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         10.244.0.5:9153,10.244.0.6:9153</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Session</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Affinity:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  None</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Events:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ ¹æ® é€‰æ‹©å™¨çš„æ ‡ç­¾è¿‡æ»¤ æ‰¾Podï¼Œå‘ç°æ˜¯åˆå§‹åŒ–æ—¶çš„ coredns </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> po</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k8s-app=kube-dns</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -owide</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       READY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   STATUS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    RESTARTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   AGE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           NODE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             NOMINATED</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NODE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   READINESS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GATES</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">coredns-58cc8c89f4-hzprn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          23d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.244.0.5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   k8s-master-171</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;           &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">coredns-58cc8c89f4-vvj77</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          23d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.244.0.6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   k8s-master-171</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;           &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">åˆå§‹åŒ–æ—¶åˆ›å»ºäº†</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> coredns ç„¶åå»ºç«‹ kube-dns è¿™ä¸ªserviceï¼ˆå›ºå®šIPï¼‰ï¼Œåç»­æ–°å»º Pod ä¾¿å¯æ³¨å…¥åˆ° DNS é…ç½®ä¸­ï¼Œæœ€ç»ˆè§£æçš„å°±æ˜¯ coredns çš„ IP, coredns è§ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2.4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ•…å®¹å™¨å†…éƒ¨ç»„ä»¶é—´è°ƒç”¨ï¼Œå®Œå…¨å¯ä»¥é€šè¿‡ <strong>Service Name</strong>ï¼ˆç±»ä¼¼åŸŸåï¼‰æ¥è§£æ <strong>IP</strong> é€šä¿¡ï¼Œé¿å…äº†å¤§é‡ <strong>IP</strong> ç»´æŠ¤çš„æˆæœ¬ï¼Œå› æ­¤å†æ¬¡å¯¹éƒ¨ç½²è¿›è¡Œä¼˜åŒ–æ”¹é€ </p><ol><li><p><strong>MySQL</strong> å»æ‰ <strong>hostNetwork</strong> éƒ¨ç½²ï¼Œä½¿å¾—æœåŠ¡åªæš´éœ²åœ¨ <strong>k8s</strong> é›†ç¾¤å†…éƒ¨ç½‘ç»œç¯å¢ƒä¸­</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">hostNetwork</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			# å»æ‰æ­¤è¡Œ æˆ– æ”¹ä¸ºfalse</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>configMap</strong> ä¸­çš„æ•°æ®åº“ <strong>HOST</strong> å›ºå®šçš„ <strong>IP</strong> åœ°å€æ¢æˆ <strong>Service Name</strong>ï¼Œè¿™æ ·è·¨ç¯å¢ƒæ—¶ï¼Œé…ç½®å†…å®¹å¯ä¿æŒä¸å˜</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ConfigMap</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ublog</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uit</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  MYSQL_HOST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;svc-mysql&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # æ­¤å¤„æ›¿æ¢ä¸ºä¸Šæ–‡ç»™ MySQL åˆ›å»ºçš„ Service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  MYSQL_PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;3306&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‡æ–°æ‰§è¡Œ</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apply</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> configmap.yaml</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apply</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> deploy-mysql.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¹Ÿå¯ä»¥åˆ é™¤ configmap å†é€šè¿‡ .txt é‡å»º</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ublog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> configmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ublog</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --from-env-file=configmap.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>åŒä¸€ä¸ª <strong>NameSpace</strong> ä¸‹ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ <strong>ServiceName</strong> æ¥è¿›è¡Œè®¿é—®ï¼Œè€Œè·¨ <strong>NameSpace</strong> è®¿é—®ï¼Œéœ€è¦ <strong>ServiceName + åç¼€ .namespace</strong> çš„æ–¹å¼è®¿é—®</p></div><h3 id="_1-3-nodeport-å¤–éƒ¨è®¿é—®" tabindex="-1"><a class="header-anchor" href="#_1-3-nodeport-å¤–éƒ¨è®¿é—®"><span>1.3 NodePortï¼ˆ<em>å¤–éƒ¨è®¿é—®</em> ï¼‰</span></a></h3><p><strong>Cluster IP</strong> ä¸ºè™šæ‹Ÿåœ°å€ï¼Œåªèƒ½åœ¨ <strong>k8s</strong> é›†ç¾¤å†…éƒ¨è¿›è¡Œè®¿é—®ï¼Œé›†ç¾¤å¤–éƒ¨å¦‚æœè®¿é—®å†…éƒ¨æœåŠ¡ï¼Œå¯ä»¥é…ç½® <strong>NodePort</strong></p><p>è‹¥ä¸æŒ‡å®š <strong>NodePort</strong> ç«¯å£ï¼Œåˆ™ä¼šé»˜è®¤åœ¨ <strong>30000-32767ï¼ˆ<em>ç«¯å£å·</em> ï¼‰</strong> ä¸­éšæœºä½¿ç”¨å…¶ä¸­ä¸€ä¸ª</p><h4 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯</span></a></h4><p>é€šå¸¸ç”¨äº <strong>ä¸´æ—¶</strong> éœ€è¦è®¿é—® <strong>MySQL</strong> ä¹‹ç±»çš„ä¸­é—´ä»¶æ‰ä½¿ç”¨ï¼Œæ€§èƒ½å·®ï¼Œ<strong>ä¸æ¨èä½¿ç”¨</strong></p><ul><li><strong>Service</strong> ä¸€æ—¦å˜å¤šï¼Œå…¶æ€§èƒ½ä¹Ÿéšä¹‹å¤§å¹…ä¸‹é™</li><li>ç»´æŠ¤å„ç§ç«¯å£çš„æˆæœ¬è¿‡é«˜ã€å¤ªå¤æ‚ï¼Œæ¨èä½¿ç”¨ <strong>ingress</strong></li></ul><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-np-ublog</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uit</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">TCP</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    targetPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8002</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    nodePort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32333</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# è¿™é‡Œè¿˜æ˜¯æ‰‹åŠ¨æŒ‡å®šäº†ç«¯å£ 32333 çœ‹æ•ˆæœ</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  selector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">myblog</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">NodePort</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# åªéœ€å°†ä¹‹å‰çš„ Cluster IP æ”¹ä¸º NodePort å³å¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºå¹¶æŸ¥çœ‹æœåŠ¡</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ›å»º svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-np-ublog.yaml</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">service/svc-np-ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> created</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹å½“å‰æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CLUSTER-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       EXTERNAL-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">svc-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.98.22.166</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">3306/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       2d11h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">svc-np-ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   NodePort</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    10.107.82.31</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">80:32543/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   4m57s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">svc-ublog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.105.146.135</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">80/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         2d11h</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹è¯¦æƒ…</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> describe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-np-ublog</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     svc-np-ublog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Namespace:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                uit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Labels:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Annotations:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">              &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Selector:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 app=myblog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     NodePort</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">IP:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                       10.107.82.31</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Port:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                     &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">80/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TargetPort:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8002/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NodePort:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                 &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">unse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">32543/TCP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Endpoints:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                10.244.1.35:8002,10.244.2.32:8002</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Session</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Affinity:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         None</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">External</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Traffic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Policy:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Cluster</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Events:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶å‘ç°ç±»å‹å˜ä¸º <code>Type: NodePort</code> ï¼Œä¸”å¤šäº†éšæœºçš„ç«¯å£ <code>NodePort: &lt;unset&gt; 32543/TCP</code>ï¼Œä½† <strong>CLUSTER-IP</strong> å’Œ <strong>Endpoints</strong> ä¾ç„¶æ²¡å˜</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ•…å¯åˆ é™¤ä¹‹å‰çš„ svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-ublog.yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;svc-ublog&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> deleted</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åŒæ—¶å‘ç°ï¼Œé›†ç¾¤å†…æ¯ä¸ªèŠ‚ç‚¹çš„ NodePort ç«¯å£éƒ½ä¼šè¿›è¡Œç›‘å¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.3.171:32333/blog/index/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.3.172:32333/blog/index/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.3.173:32333/blog/index/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>k8s</strong> é›†ç¾¤çš„ <strong>ä¸šåŠ¡ Pod</strong> å˜ä¸ºç±»ä¼¼ <strong>é«˜å¯ç”¨</strong> ä¸€æ ·ï¼Œéƒ½èƒ½åœ¨æµè§ˆå™¨ä¸Šï¼Œé€šè¿‡æ¯ä¸ªèŠ‚ç‚¹çš„ <strong>IP</strong>ï¼Œå¯¹æœåŠ¡è¿›è¡Œå¤–éƒ¨è®¿é—®ï¼ˆ<em>å³ä½¿è¯¥èŠ‚ç‚¹æœªè·‘å¯¹åº”çš„ä¸šåŠ¡ Pod</em> ï¼‰</p><ul><li><a href="http://192.168.3.171:32333/blog/index/" target="_blank" rel="noopener noreferrer">http://192.168.3.171:32333/blog/index/</a></li><li><a href="http://192.168.3.172:32333/blog/index/" target="_blank" rel="noopener noreferrer">http://192.168.3.172:32333/blog/index/</a></li><li><a href="http://192.168.3.173:32333/blog/index/" target="_blank" rel="noopener noreferrer">http://192.168.3.173:32333/blog/index/</a></li></ul><div class="hint-container note"><p class="hint-container-title">æ­¤æ—¶ä¼šæœ‰å¦‚ä¸‹ç–‘æƒ‘ï¼Ÿ</p><ol><li><strong>NodePort</strong> çš„ç«¯å£ç›‘å¬ï¼Œæ˜¯å¦‚ä½•è½¬å‘åˆ°å¯¹åº”çš„ <strong>Pod</strong> æœåŠ¡çš„ï¼Ÿ</li><li><strong>CLUSTER-IP</strong> æ˜¯ <strong>è™šæ‹Ÿ IP</strong>ï¼Œé›†ç¾¤å†…æ˜¯å¦‚ä½•é€šè¿‡è¿™ä¸ª <strong>è™šæ‹Ÿ IP</strong> è®¿é—®åˆ°å…·ä½“çš„ <strong>Pod</strong> æœåŠ¡çš„ï¼Ÿ</li></ol></div><h3 id="_1-4-service-å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#_1-4-service-å®ç°åŸç†"><span>1.4 Service å®ç°åŸç†</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ 32333 ç«¯å£çš„ç›‘å¬ï¼Œçœ‹åˆ°å¦‚ä¸‹ kube-proxy åœ¨ç›‘å¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ntpl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32333</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :::32333</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      28426/kube-proxy</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="coredns" tabindex="-1"><a class="header-anchor" href="#coredns"><span>CoreDNS</span></a></h4><p>ç”¨äº <strong>k8s</strong> é›†ç¾¤å†…éƒ¨ <strong>Service</strong> çš„è§£æï¼Œå¯ä»¥è®© <strong>Pod</strong> æŠŠ <strong>Service</strong> åç§°è§£æä¸º <strong>IP</strong> åœ°å€ï¼Œç„¶åé€šè¿‡ <strong>IP</strong> è¿æ¥åˆ°å¯¹åº”çš„åº”ç”¨ä¸Š</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><ul><li><p><strong>Go</strong> è¯­è¨€å®ç°çš„é“¾å¼æ’ä»¶ï¼Œ<strong>CNCF</strong> æˆå‘˜ï¼Œæ˜¯ä¸ªé«˜æ€§èƒ½ã€æ˜“æ‰©å±•çš„ <strong>DNS</strong> æœåŠ¡ç«¯</p></li><li><p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸€å®šè¦å¯ç”¨å¤šä¸ªï¼Œåº”å¯¹é›†ç¾¤è§„æ¨¡</p></li></ul></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ coredns</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> po</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wide</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dns</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">coredns-58cc8c89f4-hzprn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          28d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.244.0.5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      k8s-master-171</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;           &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">coredns-58cc8c89f4-vvj77</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          28d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.244.0.6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      k8s-master-171</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;           &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿›å…¥ myblog çš„ pod ï¼ŒæŸ¥çœ‹ DNSè§£æ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ti</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ublog-5ff678657f-7qx5z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/resolv.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nameserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10.96.0.10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit.svc.cluster.local</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc.cluster.local</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cluster.local</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">options</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ndots:5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 10.96.0.10 æ€ä¹ˆæ¥çš„ï¼Œ æŸ¥çœ‹svc å‘ç°æœ‰ kube-dns æœåŠ¡ </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .10æ˜¯é»˜è®¤ç»™ dnsç”¨çš„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CLUSTER-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   EXTERNAL-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)                  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kube-dns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.96.0.10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">53/UDP,53/TCP,9153/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   28d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .1 ç½‘æ®µæ˜¯é»˜è®¤ç»™ Kubernetes ç”¨çš„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CLUSTER-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   EXTERNAL-IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   PORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)   </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kubernetes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ClusterIP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.96.0.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;        </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">443/TCP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   28d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¯åŠ¨ <strong>Pod</strong> çš„æ—¶ï¼Œä¼šæŠŠ <strong>kube-dns</strong> æœåŠ¡çš„ <strong>Cluster IP</strong> åœ°å€æ³¨å…¥åˆ° <strong>Pod</strong> çš„ <strong>resolve</strong> è§£æé…ç½®ä¸­</li><li>åŒæ—¶æ·»åŠ å¯¹åº” <strong>namespace</strong> çš„ <strong>search</strong> åŸŸï¼ˆ<em>åé¢çš„ä¸€è¿ä¸²åŸŸå</em> ï¼‰</li><li>å› æ­¤é€šè¿‡ <strong>service name è·¨å‘½åç©ºé—´è®¿é—®</strong> çš„è¯ï¼Œéœ€è¦æ·»åŠ å¯¹åº”çš„ <strong>namespace</strong> åç§° <ul><li>å¦‚ï¼š <code>service_name.namespace_name</code></li></ul></li></ul><h4 id="kube-proxy" tabindex="-1"><a class="header-anchor" href="#kube-proxy"><span>kube-proxy</span></a></h4><p><a href="https://kubernetes.io/docs/concepts/services-networking/service/#virtual-ips-and-service-proxies" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a> æœªæ¥ä¹Ÿè®¸ä¼šè¢« <strong>Cilium</strong> ã€ <strong>eBPFï¼ˆ<em>æœºåˆ¶</em> ï¼‰</strong> åŸç”Ÿæ›¿ä»£</p><p><strong>è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Š</strong>ï¼Œ è´Ÿè´£ <strong>Pod</strong> é—´çš„ <strong>é€šä¿¡</strong> å’Œ <strong>è´Ÿè½½å‡è¡¡</strong>ï¼Œç›‘å¬ <strong>API Server</strong> ä¸­æœåŠ¡å¯¹è±¡çš„å˜åŒ–ï¼Œå†é€šè¿‡åˆ›å»ºæµé‡è·¯ç”±è§„åˆ™æ¥å®ç°ç½‘ç»œçš„è½¬å‘ï¼Œæœ‰å¦‚ä¸‹æ¨¡å¼</p><ul><li><p><s><strong>User space</strong>, è®© Kube-Proxy åœ¨ç”¨æˆ·ç©ºé—´ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€æœ‰çš„ Service éƒ½è½¬å‘åˆ°è¿™ä¸ªç«¯å£ï¼Œç„¶å Kube-Proxy åœ¨å†…éƒ¨åº”ç”¨å±‚å¯¹å…¶è¿›è¡Œè½¬å‘ ï¼Œ æ‰€æœ‰æŠ¥æ–‡éƒ½èµ°ä¸€éç”¨æˆ·æ€ï¼Œæ€§èƒ½ä¸é«˜ï¼Œk8s v1.2ç‰ˆæœ¬ååºŸå¼ƒ</s>ã€‚</p></li><li><p><strong>Iptablesï¼š</strong> å½“å‰é»˜è®¤æ¨¡å¼ï¼Œ<strong>å®Œå…¨ç”± IPtables æ¥å®ç°</strong>ï¼Œ é€šè¿‡å„ä¸ªèŠ‚ç‚¹ä¸Šçš„ <strong>iptables</strong> è§„åˆ™æ¥å®ç° <strong>service</strong> çš„è´Ÿè½½å‡è¡¡ï¼Œä½†æ˜¯éšç€ <strong>service</strong> æ•°é‡çš„å¢å¤§ï¼Œ<strong>iptables</strong> æ¨¡å¼ç”±äºçº¿æ€§æŸ¥æ‰¾åŒ¹é…ã€å…¨é‡æ›´æ–°ç­‰ç‰¹ç‚¹ï¼Œå…¶æ€§èƒ½ä¼šæ˜¾è‘—ä¸‹é™</p></li><li><p><strong>IPVSï¼š</strong> ç›‘å¬ <strong>Master</strong> èŠ‚ç‚¹ å¢åŠ å’Œåˆ é™¤ <strong>service</strong> ä»¥åŠ <strong>endpoint</strong> çš„æ¶ˆæ¯ï¼Œè°ƒç”¨ <strong>Netlink</strong> åˆ›å»ºå¯¹åº” <strong>IPVS</strong> è§„åˆ™ï¼Œå°†æµé‡è½¬å‘åˆ°å¯¹åº”çš„ <strong>Pod</strong> ä¸Š</p><ul><li>ä¸ <strong>iptables</strong> åŒæ ·åŸºäº <strong>Netfilterï¼ˆ<em>iptableå†…æ ¸æ€çš„ä¸€ç§å®ç°</em>ï¼‰</strong>ï¼Œé‡‡ç”¨ <strong>hash</strong> è¡¨ï¼Œå› æ­¤å½“ <strong>service</strong> æ•°é‡è¾¾åˆ°ä¸€å®šè§„æ¨¡æ—¶ï¼Œ<strong>hash</strong> æŸ¥è¡¨é€Ÿåº¦å¿«ï¼Œä»è€Œæé«˜ <strong>service</strong> çš„æœåŠ¡æ€§èƒ½</li><li><strong>k8s 1.8</strong> ç‰ˆæœ¬å¼€å§‹å¼•å…¥ï¼Œ<strong>1.11</strong> ç‰ˆæœ¬å¼€å§‹ç¨³å®šï¼Œéœ€è¦å¼€å¯å®¿ä¸»æœºçš„ <strong>ipvs</strong> æ¨¡å—</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®¢æˆ·ç«¯å·¥å…· æŸ¥çœ‹ é…ç½®è§„åˆ™</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ipvsadm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ln</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h5 id="iptables-æŠ“åŒ…æµç¨‹" tabindex="-1"><a class="header-anchor" href="#iptables-æŠ“åŒ…æµç¨‹"><span><strong>Iptables æŠ“åŒ…æµç¨‹</strong></span></a></h5><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ svc-np-ublog çš„ iptables</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iptables-save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-np-ublog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-NODEPORTS</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> comment</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --comment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;uit/svc-np-ublog:&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32333</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-MARK-MASQ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-NODEPORTS</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> comment</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --comment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;uit/svc-np-ublog:&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32333</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SVC-FQQJWIJEBH5A6SF6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SERVICES</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.244.0.0/16</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.107.82.31/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> comment</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --comment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;uit/svc-np-ublog: cluster IP&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-MARK-MASQ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SERVICES</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.107.82.31/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> comment</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --comment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;uit/svc-np-ublog: cluster IP&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SVC-FQQJWIJEBH5A6SF6</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">å°†IP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10.107.82.31</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> è½¬å‘åˆ° 80ç«¯å£ï¼Œè½¬å‘ KUBE-SVC-FQQJWIJEBH5A6SF6 è¿™ä¸ªé“¾`</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç»§ç»­æŠ“é“¾</span></span>
<span class="line highlighted"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iptables-save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SVC-FQQJWIJEBH5A6SF6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">:KUBE-SVC-FQQJWIJEBH5A6SF6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SVC-FQQJWIJEBH5A6SF6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> statistic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> random</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --probability</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.50000000000</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-U4JA5WF5RRIRERN5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SVC-FQQJWIJEBH5A6SF6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-ME7MACTOWWVFKRBM</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">é™æ€</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> æ¨¡å¼ éšæœº 50%çš„å¯èƒ½æ€§ æ‰“åˆ° KUBE-SEP-U4JA5WF5RRIRERN5 é“¾ä¸Š`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿›ä¸€æ­¥æŠ“å– KUBE-SEP-U4JA5WF5RRIRERN5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iptables-save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-U4JA5WF5RRIRERN5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">:KUBE-SEP-U4JA5WF5RRIRERN5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-U4JA5WF5RRIRERN5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.244.1.35/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-MARK-MASQ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-U4JA5WF5RRIRERN5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DNAT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --to-destination</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.244.1.35:8002</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SVC-FQQJWIJEBH5A6SF6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> statistic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> random</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --probability</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.50000000000</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-U4JA5WF5RRIRERN5</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">æ­¤æ—¶</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DNAT åˆ°äº†å…·ä½“çš„ Pod IP 10.244.1.35:8002 ä¸Š`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># KUBE-SEP-ME7MACTOWWVFKRBM ä¹Ÿæ˜¯å¦‚æ­¤</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">iptables-save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-ME7MACTOWWVFKRBM</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">:KUBE-SEP-ME7MACTOWWVFKRBM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-ME7MACTOWWVFKRBM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.244.2.32/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-MARK-MASQ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-ME7MACTOWWVFKRBM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DNAT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --to-destination</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.244.2.32:8002</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SVC-FQQJWIJEBH5A6SF6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KUBE-SEP-ME7MACTOWWVFKRBM</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶å‘ç°æ˜¯æŒ‰ç…§ <strong>Pod</strong> è¿›è¡Œæµé‡åˆ†é…çš„ï¼Œè‹¥è¦ <strong>ç°åº¦å‘å¸ƒ</strong>ï¼Œåš <strong>æµé‡åˆ†é… / æ²»ç†</strong> ä»æ— æ³•å®ç°ï¼Œéœ€è¦ <strong>istio</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é‡å»º pod</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> demo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> po</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql-7f747644b8-6npzn</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å»æ‰ taint</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> taint</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k8s-slave1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> smoke-</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> taint</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k8s-slave2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drunk-</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># myblogä¸ç”¨åŠ¨ï¼Œä¼šè‡ªåŠ¨å› å¥åº·æ£€æµ‹ä¸è¿‡è€Œé‡å¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-5-endpoints-ä»£ç†å¤–éƒ¨åº”ç”¨-ä»£ç†" tabindex="-1"><a class="header-anchor" href="#_1-5-endpoints-ä»£ç†å¤–éƒ¨åº”ç”¨-ä»£ç†"><span>1.5 Endpoints ä»£ç†å¤–éƒ¨åº”ç”¨ï¼ˆ<em>ä»£ç†</em> ï¼‰</span></a></h3><p>ç»å¸¸æœ‰éœ€è¦ä»£ç† <strong>k8s</strong> å¤–éƒ¨åº”ç”¨çš„éœ€æ±‚ï¼Œ<strong>åº”ç”¨åœºæ™¯å¦‚ä¸‹</strong></p><ul><li>å¸Œæœ›åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šä½¿ç”¨å›ºå®šåç§°ï¼ˆ<em>å¦‚ï¼šæœåŠ¡å</em> ï¼‰ï¼Œè€Œéé€šè¿‡ <strong>IP</strong> åœ°å€å»è®¿é—®å¤–éƒ¨çš„ä¸­é—´ä»¶æœåŠ¡ <ul><li>å¦‚: ä¸å¸Œæœ›å„å›¢é˜Ÿç»´æŠ¤ä¸åŒ <strong>k8s</strong> é›†ç¾¤æ—¶ï¼Œè¿˜ç»´æŠ¤å„ç§ä¸­é—´ä»¶çš„é…ç½®æ–‡ä»¶ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥é€šè¿‡ <strong>svc</strong> åä»£æ¥ç»Ÿä¸€é…ç½®æ–‡ä»¶</li></ul></li><li>å¸Œæœ› <strong>Service</strong> æŒ‡å‘å¦ä¸€ä¸ª<strong>NameSpace</strong> ä¸­æˆ– <strong>å…¶ä»–é›†ç¾¤</strong> ä¸­çš„æœåŠ¡ <ul><li>æ¯”å¦‚: <strong>ä¸€äº›å¤–éƒ¨çš„å­˜å‚¨é›†ç¾¤çš„ç®¡ç†å¹³å°</strong> ä¸å»éƒ¨ç½²äº <strong>k8s</strong> ä¸­ï¼Œæ­¤æ—¶ä¹Ÿå¯é€šè¿‡ <strong>k8s</strong> çš„æœåŠ¡è¿›è¡Œä»£ç†</li><li>è·¨å‘½åç©ºé—´æ—¶ä¸æƒ³ä½¿ç”¨ <strong>.namespace</strong> åç¼€å½¢å¼è®¿é—®ï¼ˆ<em>ä¸æ¨è</em> ï¼‰</li></ul></li><li>æŸä¸ªé¡¹ç›®æ­£åœ¨è¿ç§»è‡³ <strong>k8s</strong> é›†ç¾¤ï¼Œä½†ä¸€éƒ¨åˆ†æœåŠ¡ä¾ç„¶åœ¨é›†ç¾¤å¤–ï¼Œæ­¤æ—¶å¯ä½¿ç”¨ <strong>Service</strong> ä»£ç†è‡³ <strong>k8s</strong> é›†ç¾¤å¤–éƒ¨çš„æœåŠ¡ï¼ˆ<em>é¿å…è¿ç§»é‡å¯</em> ï¼‰ <ul><li>æ¯”å¦‚ï¼šä¹‹å‰ <strong>Web</strong> é€šè¿‡ <strong>172.16.120.111</strong> å½¢å¼è®¿é—®æ•°æ®åº“ï¼Œ<strong>Web</strong> è¿è¿‡æ¥æ”¹ä¸ºé€šè¿‡ <strong>Service ä»£ç†å½¢å¼</strong> è®¿é—®ï¼Œå†å°†æ•°æ®åº“è¿ç§»è¿‡æ¥æ—¶æ— éœ€é‡å¯ <strong>Web</strong> æœåŠ¡</li></ul></li></ul><h4 id="åä»£-ip" tabindex="-1"><a class="header-anchor" href="#åä»£-ip"><span>åä»£ IP</span></a></h4><p>ä»¥ä»£ç†ç™¾åº¦ä¸ºä¾‹ï¼Œå…ˆç¼–å†™ <strong>svc</strong> æ–‡ä»¶</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ kubectl -n dev get svc -o yaml &gt; svc-proxy.yaml</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ vim svc-proxy.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-------------------------</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Services</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  label</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-poroxy</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-proxy</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">dev</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spce</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">http</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">TCP</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    targetPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  sessionAffinity</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">None</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ClusterIP</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ kubectl create -f svc-proxy.yaml</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ kubectl -n dev get svc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">NAME        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-nignx   ClusterIP   None             &lt;none&gt;        80/TCP    29d</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-proxy   ClusterIP   10.100.128.239   &lt;none&gt;        80/TCP    11h</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶æŸ¥çœ‹ <strong>svc</strong> å¯è·å–è‡ªåŠ¨åˆ†é…çš„ <strong>IP</strong>ï¼Œæ¥ä¸‹æ¥ç¼–å†™ <strong>endpoints</strong> æ¥å…³è”ä»£ç†</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å…ˆè·å–ç™¾åº¦ç›®å‰çš„IP</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ ping www.baidu.com</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">64 bytes from 14.215.177.38 (14.215.177.38)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">icmp_seq=1 ttl=56 time=6.87 ms</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç¼–å†™ endpoints</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ vim ep-proxy.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-------------------------</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Endpoints</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  label</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-poroxy</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# éœ€å’Œ svc çš„ä¸€è‡´æ¥è¿›è¡Œå…³è”</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-proxy</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">dev</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">subsets</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:				</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">- </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">addresses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">14.215.177.38</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# å¡«å†™ä»£ç†çš„IPåœ°å€</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">http</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">TCP</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# åè®®éœ€å’Œ svc çš„ä¸€è‡´</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ kubectl apply -f ep-proxy.yaml</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ­¤æ—¶ svc å…³è”çš„ ep å·²ç”Ÿæˆï¼Œä¸”ä¼šéšç€ svc çš„æ¶ˆå¤±è€Œæ¶ˆå¤±</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ kubectl -n dev get ep</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># curl svc çš„ IP æ­¤æ—¶å‘ç°æœ‰ç›¸åº”</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ curl 10.100.128.239 -I</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‹¥æ›´æ¢äº† <strong>IP</strong> æ— éœ€é‡å¯åº”ç”¨ç¨‹åºï¼Œåªéœ€è¦æ”¹åŠ¨ <strong>endpoints</strong> æ–‡ä»¶çš„ <code>ip</code> ï¼Œç„¶å <code>kubectl replace -f</code> å³å¯</p><h4 id="externalname-åä»£åŸŸå" tabindex="-1"><a class="header-anchor" href="#externalname-åä»£åŸŸå"><span>ExternalNameï¼ˆ<em>åä»£åŸŸå</em> ï¼‰</span></a></h4><p>è‹¥éœ€åä»£åŸŸåï¼Œåˆ™éœ€è¦æ›´æ”¹ <strong>svc</strong> çš„ç±»å‹ä¸º <strong>ExternalName</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">vim svc-proxyName.yaml</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-------------------------</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  labels</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-proxy-name</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-proxy-name</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">dev</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ExternalName</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  externalName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">www.baidu.com</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-------------------------</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ kubectl apply -f svc-proxyName.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶è¿›å…¥ <strong>busybox</strong> ä¸­å°è¯•é€šè¿‡ä»£ç†çš„æœåŠ¡åè®¿é—®</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ndev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ti</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> busybox</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é€šè¿‡ä»£ç†çš„åŸŸåè¯·æ±‚èµ„æºï¼Œè®¿é—®ä¸é€šæ˜¯ç”±äºè·¨åŸŸé€ æˆçš„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-proxy-name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Connecting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-proxy-name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (14.215.177.38:80)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> returned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> error:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HTTP/1.1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 403</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Forbidden</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åŸŸåè§£æ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nslookup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> svc-proxy-name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Server:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    10.96.0.10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10.96.0.10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-dns.kube-system.svc.cluster.local</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      svc-proxy-name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 14.215.177.38</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 14.215.177.39</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç›´æ¥è¯·æ±‚ï¼Œåˆ™å¯é€šè¿‡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wget</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 14.215.177.38</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Connecting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 14.215.177.38</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (14.215.177.38:80)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index.html</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           100%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |*****************************]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºè·¨åŸŸé—®é¢˜ï¼Œè¯¥åœºæ™¯ä½¿ç”¨è¾ƒå°‘</p><h2 id="_2-ingress-æµé‡è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_2-ingress-æµé‡è·¯ç”±"><span>2. Ingressï¼ˆ<em>æµé‡è·¯ç”±</em> ï¼‰</span></a></h2><p><a href="https://kubernetes.io/zh-cn/docs/concepts/services-networking/ingress/" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p><p>åŒ <strong>k8s</strong> çš„èµ„æºç±»å‹ï¼Œå¯¹äº <strong>k8s</strong> çš„ <strong>Service</strong>ï¼Œæ— è®ºæ˜¯ <strong>Cluster IP</strong> è¿˜æ˜¯ <strong>NodePort</strong>ï¼Œéƒ½æ˜¯ <strong>å››å±‚è´Ÿè½½</strong>ï¼Œè¦è®©é›†ç¾¤å†…çš„æœåŠ¡å®ç° <strong>ä¸ƒå±‚è´Ÿè½½å‡è¡¡</strong>ï¼Œè¦å€ŸåŠ©äº <strong>Ingress</strong></p><ul><li><strong>Ingress æ§åˆ¶å™¨ï¼š</strong> å…¶å®ç°æ–¹å¼å¾ˆå¤šï¼Œæ¯”å¦‚ <strong>Nginx</strong>, <strong>Contour</strong>, <strong>Haproxy</strong>, <strong>trafik</strong>, <strong>Istio</strong>ï¼Œåç»­ <strong>Nginx</strong> å®ç°ä¸ºä¾‹</li><li><strong>å‘å¸ƒæ–¹å¼ï¼š</strong><ul><li>å®ƒæ—¢å¯ä»¥å®ç° <strong>ç«¯å£</strong> çš„æ–¹å¼ï¼ŒåŒæ—¶å¯ä»¥å®ç° <strong>åŸŸå</strong> çš„æ–¹å¼è®¿é—® <strong>k8s</strong> å†…éƒ¨åº”ç”¨</li><li>é€šå¸¸å†…éƒ¨é€šè¿‡åŸŸåï¼Œåä»£åˆ°ä¸šåŠ¡èŠ‚ç‚¹ï¼Œ<strong>ingress</strong> ä¸Šå±‚å¯èƒ½è¿˜æœ‰ <strong>F5</strong>ï¼Œ<strong>LVS</strong>ï¼Œ<strong>SLB</strong>ï¼Œ<strong>ELB</strong> ç­‰ä½œä¸ºå…¥å£å†åä»£åˆ°<strong>ingress</strong> ä¸Šï¼Œç„¶å <strong>å°†è´­ä¹°çš„ åŸŸå è§£æåˆ° F5ã€é˜¿é‡Œäº‘ç­‰LBä¸Š</strong></li><li>ç”±äºæ˜¯ <strong>k8s</strong> ä¸­é€šè¿‡ <strong>IPVS</strong> å®ç°çš„ä¸€ç§ <strong>å†…æ ¸çº§</strong> çš„è½¬å‘ï¼Œå› æ­¤è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œä»Šåå¯èƒ½è¿˜ä½¿ç”¨ <strong>EBPF</strong> ç­‰ä¸œè¥¿ï¼Œé€Ÿåº¦æ›´å¿«</li></ul></li></ul><h3 id="_2-1-ingress-nginx-å®‰è£…" tabindex="-1"><a class="header-anchor" href="#_2-1-ingress-nginx-å®‰è£…"><span>2.1 Ingress-nginx å®‰è£…</span></a></h3><p>æ˜¯ <strong>k8s</strong> å®˜æ–¹ç»´æŠ¤çš„æ§åˆ¶å™¨ï¼ˆ<em>åŒæ­¥æ›´æ–°</em> ï¼‰<a href="https://kubernetes.github.io/ingress-nginx/" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a></p><p><strong>Ingress-nginx</strong> æ˜¯ <strong>7 å±‚çš„è´Ÿè½½å‡è¡¡å™¨</strong> ï¼Œè´Ÿè´£ç»Ÿä¸€ç®¡ç†å¤–éƒ¨å¯¹ <strong>k8s cluster</strong> ä¸­ <strong>Service</strong> çš„è¯·æ±‚ï¼ŒåŒ…å«å¦‚ä¸‹</p><ul><li><strong>ingress-nginx-controllerï¼š</strong> æ ¹æ®ç”¨æˆ·ç¼–å†™çš„ <strong>ingress</strong> è§„åˆ™ï¼ˆ<em>åˆ›å»ºçš„ ingress çš„ yaml æ–‡ä»¶</em> ï¼‰ï¼ŒåŠ¨æ€çš„å»æ›´æ”¹<strong>nginx</strong> æœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸” <strong>reload</strong> é‡è½½ä½¿å…¶ç”Ÿæ•ˆï¼ˆ<em>æ˜¯è‡ªåŠ¨åŒ–çš„ï¼Œé€šè¿‡ lua è„šæœ¬æ¥å®ç°</em> ï¼‰</li><li><strong>ingressèµ„æºå¯¹è±¡ï¼š</strong> å°† <strong>Nginx</strong> çš„é…ç½®æŠ½è±¡æˆä¸€ä¸ª <strong>Ingress</strong> å¯¹è±¡ï¼Œæ¯æ·»åŠ ä¸€ä¸ªæ–°çš„ <strong>Service</strong> èµ„æºå¯¹è±¡åªéœ€å†™ä¸€ä¸ªæ–°çš„ <strong>Ingress</strong> è§„åˆ™çš„ <strong>yaml</strong> æ–‡ä»¶å³å¯ï¼ˆ<em>æˆ–ä¿®æ”¹å·²å­˜åœ¨çš„ ingress è§„åˆ™çš„ yaml æ–‡ä»¶</em> ï¼‰</li></ul><p><a href="https://kubernetes.github.io/ingress-nginx/deploy/" target="_blank" rel="noopener noreferrer">Ingress-nginx å®˜æ–¹æ–‡æ¡£</a> ï¼Œæ¨èä½¿ç”¨ <strong><a class="route-link" href="/tool/Kubernetes/Helm%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8.html">Helm</a></strong> å®‰è£…</p><p><a href="https://artifacthub.io/packages/helm/ingress-nginx/ingress-nginx" target="_blank" rel="noopener noreferrer">Artifact Hubä¸­æŸ¥æ‰¾</a> è¿™æ˜¯æ¥æºäº <strong>Kubernetes</strong> ç»´æŠ¤çš„å®˜æ–¹ <strong>Helm</strong> ä»“åº“</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é€šè¿‡ helm æ·»åŠ  ingress-nginx ä»“åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://kubernetes.github.io/ingress-nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹æ·»åŠ çš„ä»“åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> list</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         	URL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                                          </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	https://kubernetes.github.io/ingress-nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ä»“åº“ä¸­ ingress-nginx çš„ç‰ˆæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       	CHART</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> VERSION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	APP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> VERSION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	DESCRIPTION</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx/ingress-nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	4.4.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        	1.5.1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      	Ingress</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> controller</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Kubernetes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NGINX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è™½ç„¶éœ€è¦ APP VERSION &gt;= 0.40.2 (bugå°‘)ï¼Œä½†æ˜¯  CHART VERSION 4.4.0 å¤ªé«˜äº†ï¼Œå®‰è£…ä¼šæŠ¥é”™ï¼Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶è¦ä¸‹ <strong>é™çº§</strong> çš„åŒ…ï¼Œè¿™é‡Œæ˜¯ <strong>CHART VERSION == 3.18.0</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é€šè¿‡å‘½ä»¤ search æ‰€æœ‰ç‰ˆæœ¬çš„åŒ…</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx/ingress-nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	3.18.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        	0.42.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     	An</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Ingress</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> controller</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> that</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uses</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ConfigMap...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># pull åŒ…æŒ‡å®šç‰ˆæœ¬å·</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx/ingress-nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3.18.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç½‘ç»œå¤±è´¥ï¼Œå¤šè¯•å‡ æ¬¡ï¼Œä¸‹è½½åä¼šå¤šå‡ºä¸ª 3.18.0 çš„ tar åŒ…</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">anaconda-ks.cfg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  `</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-3.18.0.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  k8s_install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  kube-prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  prom</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è§£å‹ï¼Œè¿›å…¥ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -xf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx-3.18.0.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¦‚ä¸‹æ˜¯é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">CHANGELOG.md</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Chart.yaml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ci</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  OWNERS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  README.md</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  README.md.gotmpl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  templates</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  values.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹ <strong>ingress</strong> é…ç½®æ–‡ä»¶</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ‰“å¼€ values.yaml ä¿®æ”¹é•œåƒåœ°å€ç­‰é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">$ vim values.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">------------------------------</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¿®æ”¹é•œåƒæºåœ°å€ï¼Œå¹¶å»æ‰å“ˆå¸Œå€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">+ repository: docker.io/willdockerhub/ingress-nginx-controller</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">- digest </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¨èä½¿ç”¨ hostNetwork éƒ¨ç½²ï¼Œèµ°å®¿ä¸»æœºç«¯å£ï¼Œæ€§èƒ½å¥½ä¸€äº›, ä¸”æ¨èä½¿ç”¨ DaemonSetéƒ¨ç½²</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">+ dnsPolicy: ClusterFirstWithHostNet</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">+ hostNetwork: true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">+ kind: DaemonSet</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¿…é¡»ä¿®æ”¹ dns ç­–ç•¥ å¦åˆ™ ingress pod æ˜¯è§£æä¸äº† k8s å†…éƒ¨çš„ Service</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¾ç½®æœ‰ ingress ä¸º true æ ‡ç­¾çš„èŠ‚ç‚¹æ‰éƒ¨ç½²</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">kubernetes.io/os: linux</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">+ ingress: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;true&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®ä¿®æ”¹ resources éœ€è¦ç»™å¤§ç‚¹ï¼Œæ¯•ç«Ÿæ˜¯ k8s çš„å…¥å£</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éäº‘ç¯å¢ƒï¼Œtype æ˜¯ä¸éœ€è¦ä½¿ç”¨ LoadBalancer çš„ï¼ŒIDC æœºæˆ¿ç›´æ¥ä½¿ç”¨ ClusterIP å³å¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">+ type: ClusterIP</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># äº‘çš„è¯ï¼Œä¼šå‘äº‘å‘ä¸ªè¯·æ±‚ï¼Œç„¶åå¾—åˆ°å…¬æœ‰äº‘åˆ†é…çš„ IP åœ°å€ï¼Œä¹‹åå°†è´­ä¹°çš„åŸŸåè§£æåˆ°å…¬æœ‰äº‘çš„ IP å³å¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹è½¬è½´æ§åˆ¶ æ˜¯å¦è¯ä¹¦ä¼šæŠ¥é”™ 0.42 å‰ä¼šï¼Œå°† enabled ä¿®æ”¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">admissionWebhooks:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">  enabled: ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kube-webhook-certgen çš„é•œåƒåœ°å€åŒæ ·ä¿®æ”¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">+ repository: egistry.aliyuncs.com/google_containers/kube-webhook-certgen</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¦‚ä¸Šé•œåƒåœ°å€éƒ½æ˜¯ç½‘ä¸ŠæŠ„çš„ï¼Œè‹¥ pull å¤±è´¥ï¼Œç™¾åº¦ä¸‹è½½ç¦»çº¿</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">docker pull quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.xx.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">docker pull èƒ½ç”¨çš„å›½å†…åœ°å€/k8s/defaultbackend-amd64:x.xx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">æ³¨æ„</p><p>è‹¥ä½¿ç”¨ <strong>Deployment</strong> æ–¹å¼éƒ¨ç½²ï¼Œåˆ™ä¸ä½¿ç”¨ <strong>hostNetwork</strong>ï¼Œå› ä¸ºæ˜¯éšæœºéƒ¨ç½²çš„ï¼Œå¯èƒ½éƒ¨ç½²åœ¨åŒä¸€ä¸ªå®¿ä¸»æœºå¯¼è‡´ç«¯å£å†²çª</p><p><strong>DaemonSet</strong> æ›´å®¹æ˜“æ§åˆ¶ä¸æŸä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥åœ¨å®¿ä¸»æœºä¸Šæš´éœ²ç«¯å£å·ï¼Œ<strong>k8s</strong> å¤–éƒ¨çš„è´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥ç›´æ¥ä»£ç†åˆ° <strong>ingress</strong> æ‰€åœ¨èŠ‚ç‚¹çš„ <strong>IP</strong> å’Œç«¯å£å·ä¸Šï¼Œè€Œä½¿ç”¨ <strong>Deployment + NodePort</strong> æ–¹å¼æ€§èƒ½å·®éš¾ç»´æŠ¤</p></div><p>ä½¿ç”¨ <strong>Helm</strong> å®‰è£…</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ›å»ºå‘½åç©ºé—´å¹¶å®‰è£…</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -n æŒ‡å®š namespace</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å‡ºç°å¦‚ä¸‹ï¼Œè²Œä¼¼å¯†ç  base64 è½¬ç å•¥çš„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">If</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enabled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Ingress,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Secret</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> containing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> certificate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> must</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> also</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> provided:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  apiVersion:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  kind:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Secret</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  metadata:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> example-tls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    namespace:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> foo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  data:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    tls.crt:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">base64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> encoded</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    tls.key:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">base64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> encoded</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubernetes.io/tls</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ pod ç­‰å¾…ä¸‹è½½é•œåƒ, Running åˆ™æˆåŠŸ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> po</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -w</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                             READY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   STATUS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              RESTARTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-controller-22lhv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   0/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     ContainerCreating</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          23s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-controller-22lhv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   0/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          46s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-controller-22lhv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          63s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹‹å <strong>DaemonSet</strong> ä¼šåœ¨æŒ‡å®šçš„èŠ‚ç‚¹ä¸Šèµ· <strong>ingress pod</strong> å¹¶æš´éœ² <strong>80</strong> å’Œ <strong>443</strong> ç«¯å£</p><h4 id="ingress-æ‰©å®¹ç¼©å®¹" tabindex="-1"><a class="header-anchor" href="#ingress-æ‰©å®¹ç¼©å®¹"><span>ingress æ‰©å®¹ç¼©å®¹</span></a></h4><p>è‹¥éœ€æ‰©å…… <strong>ingress pod</strong>ï¼Œå¯ç›´æ¥å…¶ä»–èŠ‚ç‚¹æ‰“æ ‡ç­¾ï¼Œ<strong>DaemonSet</strong> ä¼šæŒç»­ç›‘å¬å¹¶éƒ¨ç½²</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k8s-slave-173</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ­¤æ—¶æŸ¥çœ‹å·²æ‰©å®¹ï¼Œæ­£åœ¨éƒ¨ç½²</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> po</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                             READY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   STATUS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              RESTARTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-controller-22lhv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          7m49s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-controller-2gvv6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   0/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     ContainerCreating</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          16s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤–éƒ¨çš„ <strong>WebLB</strong> å†å°†æ‰©å®¹çš„èŠ‚ç‚¹åœ°å€å†™å…¥å³å¯ï¼Œç¼©å®¹ç›´æ¥åˆ æ ‡ç­¾å³å¯</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k8s-slave-173</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ­¤æ—¶æŸ¥çœ‹å·²ç¼©å®¹ï¼Œæ­£åœ¨é”€æ¯</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress-nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> po</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                             READY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   STATUS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        RESTARTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-controller-22lhv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          12m</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress-nginx-controller-2gvv6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1/1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Terminating</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          4m58s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éœ€è¦å…ˆå°†å¤–éƒ¨çš„ <strong>WebLB</strong> é…ç½®çš„åœ°å€åˆ é™¤ï¼Œå†æ‰§è¡Œå¦‚ä¸Šç¼©å®¹æ“ä½œï¼Œä¿è¯è¯·æ±‚æ­£å¸¸</p><h3 id="_2-2-ingress-ä½¿ç”¨-å‘å¸ƒæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-2-ingress-ä½¿ç”¨-å‘å¸ƒæµç¨‹"><span>2.2 ingress ä½¿ç”¨ï¼ˆå‘å¸ƒæµç¨‹ï¼‰</span></a></h3><p>å¦‚ä¸Šå·²ç»å®‰è£…å®Œ <strong>ingress-nginx</strong> çš„ æ§åˆ¶å™¨äº†ï¼Œä¹‹åå¯ä»¥ç¼–å†™ <strong>yaml</strong> æ¥åˆ›å»º <strong>Ingress</strong> ç¤ºä¾‹</p><p>é…ç½®åŸŸåé€šå¸¸ç”¨ <a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/" target="_blank" rel="noopener noreferrer">Annotations</a></p><p>åªéœ€åˆ›å»ºä¸€æ¬¡ <strong>Ingress</strong> å®ä¾‹ï¼Œå³å¯è‡ªåŠ¨ç”Ÿæˆ <strong>nginx</strong> é…ç½®ï¼Œ</p><p>è‹¥ç°åº¦å‘å¸ƒã€è·¨åŸŸã€é™é€Ÿç­‰é…ç½®ï¼Œå…¶é…ç½®æ–‡ä»¶å†™äº <strong>Annotations</strong> é‡Œé¢ï¼Œ<strong>ingress controller</strong> ä¼šåˆ†æ <strong>ingress</strong> å®ä¾‹ï¼Œä» <strong>Annotations</strong> é‡Œé¢è¯»å–é…ç½®ï¼ˆ<em>å…·æœ‰æ ¡éªŒåŠŸèƒ½</em> ï¼‰ï¼Œç”Ÿæˆ <strong>nginx</strong> é…ç½®æ–‡ä»¶</p><p>ç¤ºä¾‹ï¼š é€šè¿‡é…ç½® <strong>ingress</strong> åŸŸååä»£åˆ° <strong>nginx</strong> æœåŠ¡ä¸Šï¼Œå¦‚ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º <strong>example</strong> çš„ <strong>ingress</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ vim ingress.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ingress éœ€è¦å’ŒæœåŠ¡åœ¨åŒä¸€ä¸ª namespace ä¸‹, </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">networking.k8s.io/v1beta1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Ingress</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  annotations</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    kubernetes.io/ingress.class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;nginx&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">example</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">dev</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  rules</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx.bar.com</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      paths</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">backend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          serviceName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">svc-nignx</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          servicePort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">backend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          serviceName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">http-svc-abc</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          servicePort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/abc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>apiVersionï¼š</strong></p><ul><li><code>networking.k8s.io/v1beta1</code> ä¼šåœ¨ <strong>1.22</strong> ååºŸå¼ƒ</li><li><code>networking.k8s.io/v1:</code> <strong>1.22</strong> ä¹‹åçš„</li><li><code>extensinos/v1beta1:</code> æœ€å¼€å§‹çš„ç‰ˆæœ¬ï¼Œå·²åºŸå¼ƒ</li></ul><p>**annotationsï¼š**å‘Šè¯‰æ¥å£ï¼Œå£°æ˜ä½¿ç”¨çš„ <strong>é…ç½®å®ä¾‹</strong> æ˜¯ä»€ä¹ˆï¼Œè¿™æ˜¯ç”±äºé›†ç¾¤ä¸­å¯èƒ½ä¸æ­¢ä¸€ä¸ª <strong>ingress</strong> æ§åˆ¶å™¨</p><ul><li><code>kubernetes.io/ingress.classï¼š</code> å¦‚ä¸Šå®ä¾‹æ˜¯ <strong>ingress-nginx</strong> ï¼ˆ<em>åœ¨ä¸Šæ–‡ <strong>value.yaml</strong> ä¸­æŒ‡å®š</em> ï¼‰</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> values.yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingressClass</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  ingressClass: nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>rulesï¼š</strong> å›ºå®šå†™æ³•ï¼Œä¸€ä¸ª <strong>ingress</strong> å¯ä»¥é…ç½®å¤šä¸ª <strong>rules</strong> ï¼ˆ<em>ä¸€ä¸ªæ–‡ä»¶ä¸­å¯ä»¥æŒ‡å®šå¤šä¸ªåŸŸå</em>ï¼‰</p><ul><li><code>hostï¼š</code> é…ç½®åŸŸåï¼Œè‹¥ä¸å†™åˆ™æ˜¯ <strong>*</strong> æ­¤æ—¶è¾“å…¥ä»»ä½•åŸŸåéƒ½ä¼šè¢«è§£æï¼Œä¸æ¨è</li><li><code>pathï¼š</code> ç›¸å½“äº <strong>nginx</strong> çš„ <strong>location</strong> é…ç½®ï¼ŒåŒä¸€ä¸ª <strong>hosts</strong> å¯ä»¥é…ç½®å¤šä¸ªè·¯å¾„</li><li><code>backend:</code> å¤šä¸ªè·¯å¾„å¯ä»¥ä¸ä¸åŒçš„ <strong>Service</strong> å…³è”ï¼Œä¸Šæ–‡è¡¨ç¤ºä¸€ä¸ªåŸŸåä¸‹çš„ä¸¤ä¸ªè·¯å¾„ï¼Œå¯é€šè¿‡ <strong>svc</strong> è®¿é—®</li></ul><p>åˆ›å»º <strong>ingress</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ingress.yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ingress.networking.k8s.io/rewrite</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> created</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ ingress</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ing</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      HOSTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           ADDRESS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          PORTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">example</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   nginx.bar.com</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10.107.244.209</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   80</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      55s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½® <strong>hosts</strong> è§£æ</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>192.168.3.172 nginx.bar.com</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è‹¥è´­ä¹°çš„åŸŸåï¼Œåˆ™è§£æåˆ°å…¬å¸çš„ <strong>LB</strong> ä¸Šï¼ˆ<em><strong>LB</strong>æ˜¯æœ‰åœ°å€çš„</em> ï¼‰ç„¶å <strong>LB</strong> å†åä»£åˆ° <strong>k8s</strong> çš„ <strong>ingress</strong> ä¸Šï¼Œç„¶å <strong>ingress</strong> å†æŒ‰ç€ä¸Šé¢é…ç½®æŒ¨ä¸ªæ¥</p></div><h4 id="åŠ¨æ€æ›´æ–°å®ç°é€»è¾‘" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€æ›´æ–°å®ç°é€»è¾‘"><span>åŠ¨æ€æ›´æ–°å®ç°é€»è¾‘</span></a></h4><ol><li><strong>ingress controller</strong> é€šè¿‡å’Œ <strong>k8s</strong> çš„ <strong>api</strong> äº¤äº’ï¼ŒåŠ¨æ€æ„ŸçŸ¥é›†ç¾¤ä¸­ <strong>ingress</strong> è§„åˆ™å˜åŒ–</li><li>è¯»å– <strong>ingress</strong> è§„åˆ™ï¼ˆ<em>å“ªä¸ªåŸŸåå¯¹åº”å“ªä¸ª <strong>service</strong></em> ï¼‰ï¼ŒæŒ‰è‡ªå®šä¹‰çš„è§„åˆ™ï¼Œç”Ÿæˆ <strong>nginx</strong> é…ç½®</li><li>å†å†™åˆ° <strong>nginx-ingress-controller</strong> çš„ <strong>pod</strong> é‡Œï¼Œå…¶ <strong>pod</strong> é‡Œè¿è¡Œç€ä¸€ä¸ª <strong>Nginx</strong> æœåŠ¡ï¼Œæ§åˆ¶å™¨æŠŠç”Ÿæˆçš„ <strong>nginx</strong> é…ç½®å†™å…¥ <code>/etc/nginx.conf</code> æ–‡ä»¶ä¸­ï¼Œç„¶å <strong>reload</strong> ä¸€ä¸‹ä½¿é…ç½®ç”Ÿæ•ˆ</li></ol><p>å¦‚ä¸‹ <strong>yaml</strong> æ–‡ä»¶</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">extensions/v1beta1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Ingress</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">myblog</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uit</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  rules</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">myblog.devops.cn</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    paths</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      backend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      serviceName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">myblog</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      servicePort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ingress-nginx</strong> ä¼šåŠ¨æ€ç”Ÿæˆ <strong>upstream</strong> é…ç½®</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">server_name myblog.devops.cn </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">listen 80 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">listen [::]:80 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">listen 443 ssl http2 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">listen [::]:443 ssl http2 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">set $proxy_upstream_name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;-&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">ssl_certificate_by_lua_block {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">certificate.call()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">location / {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">set $namespace </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;demo&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">set $ingress_name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;myblog&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‹¥éœ€è¦ <strong>HTTPS</strong> è®¿é—®ï¼Œéœ€è¦ç”Ÿæˆè¯ä¹¦</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è‡ªç­¾åè¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> req</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -x509</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -nodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -days</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2920</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -newkey</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rsa:2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -keyout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tls.key</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tls.crt</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -subj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/CN=*.devops.cn/O=ingress-nginx&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¯ä¹¦ä¿¡æ¯ä¿å­˜åˆ° secretå¯¹è±¡ä¸­ï¼Œingress-nginx ä¼šè¯»å– secret å¯¹è±¡è§£æå‡ºè¯ä¹¦åŠ è½½åˆ° nginx é…ç½®ä¸­</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> secret</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https-secret</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tls.key</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --cert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tls.crt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">secret/https-secret</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> created</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚ä¸Šé…ç½®åé¢æ–°å¢ <strong>tls</strong> å³å¯</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">tls</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">- </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">hosts</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">- </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">myblog.devops.cn</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">secretName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">https-secret</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°ï¼š</span><time class="vp-meta-info" datetime="2023-01-09T06:55:55.000Z" data-allow-mismatch>2023/1/9 06:55</time></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/tool/Kubernetes/k8s%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD.html" aria-label="Kubernets - å·¥ä½œè´Ÿè½½" iconsizing="both"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Kubernets - å·¥ä½œè´Ÿè½½</div></a><a class="route-link auto-link next" href="/tool/Kubernetes/k8s%E5%AD%98%E5%82%A8.html" aria-label="Kubernets - å­˜å‚¨" iconsizing="both"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Kubernets - å­˜å‚¨<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">é»˜è®¤é¡µè„š</div><div class="vp-copyright">Copyright Â© 2025 æ‚¦Â·å®å® </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BFWhIhUk.js" defer></script>
  </body>
</html>
