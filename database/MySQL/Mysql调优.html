<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.21" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.82" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Mysqlè°ƒä¼˜","image":[""],"dateModified":"2025-06-13T06:08:46.000Z","author":[{"@type":"Person","name":"æ‚¦Â·å®å®","url":"https://github.com/Igarashi-G"}]}</script><meta property="og:url" content="https://igarashi-g.github.io/database/MySQL/Mysql%E8%B0%83%E4%BC%98.html"><meta property="og:site_name" content="æ‚¦ â–ª å®å®"><meta property="og:title" content="Mysqlè°ƒä¼˜"><meta property="og:description" content="MYSQL æœºåˆ¶è¯¦è§£ MySQL æ‰§è¡ŒæŸ¥è¯¢çš„è¿‡ç¨‹ å®¢æˆ·ç«¯é€šè¿‡ TCP è¿æ¥å‘é€è¿æ¥è¯·æ±‚åˆ° MySQL è¿æ¥å™¨ï¼Œè¿æ¥å™¨ä¼šå¯¹è¯¥è¯·æ±‚è¿›è¡Œæƒé™éªŒè¯åŠè¿æ¥èµ„æºåˆ†é… æŸ¥ç¼“å­˜ã€‚ï¼ˆå½“åˆ¤æ–­ç¼“å­˜æ˜¯å¦å‘½ä¸­æ—¶ï¼ŒMySQL ä¸ä¼šè¿›è¡Œè§£ææŸ¥è¯¢è¯­å¥ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ SQL è¯­å¥å’Œå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„å…¶ä»–åŸå§‹ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œä»»ä½•å­—ç¬¦ä¸Šçš„ä¸åŒï¼Œä¾‹å¦‚ç©ºæ ¼ã€æ³¨è§£ç­‰éƒ½ä¼šå¯¼è‡´ç¼“å­˜çš„ä¸å‘½ä¸­ã€‚ï¼‰ è¯­æ³•åˆ†æï¼ˆ..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-06-13T06:08:46.000Z"><meta property="article:modified_time" content="2025-06-13T06:08:46.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3654399_e6xix4avjkd.css"><title>Mysqlè°ƒä¼˜ | æ‚¦ â–ª å®å®</title><meta name="description" content="MYSQL æœºåˆ¶è¯¦è§£ MySQL æ‰§è¡ŒæŸ¥è¯¢çš„è¿‡ç¨‹ å®¢æˆ·ç«¯é€šè¿‡ TCP è¿æ¥å‘é€è¿æ¥è¯·æ±‚åˆ° MySQL è¿æ¥å™¨ï¼Œè¿æ¥å™¨ä¼šå¯¹è¯¥è¯·æ±‚è¿›è¡Œæƒé™éªŒè¯åŠè¿æ¥èµ„æºåˆ†é… æŸ¥ç¼“å­˜ã€‚ï¼ˆå½“åˆ¤æ–­ç¼“å­˜æ˜¯å¦å‘½ä¸­æ—¶ï¼ŒMySQL ä¸ä¼šè¿›è¡Œè§£ææŸ¥è¯¢è¯­å¥ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ SQL è¯­å¥å’Œå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„å…¶ä»–åŸå§‹ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œä»»ä½•å­—ç¬¦ä¸Šçš„ä¸åŒï¼Œä¾‹å¦‚ç©ºæ ¼ã€æ³¨è§£ç­‰éƒ½ä¼šå¯¼è‡´ç¼“å­˜çš„ä¸å‘½ä¸­ã€‚ï¼‰ è¯­æ³•åˆ†æï¼ˆ...">
    <link rel="preload" href="/assets/style-DCFqVXmA.css" as="style"><link rel="stylesheet" href="/assets/style-DCFqVXmA.css">
    <link rel="modulepreload" href="/assets/app-DM342j-t.js"><link rel="modulepreload" href="/assets/Mysqlè°ƒä¼˜.html-BBZvIoQW.js"><link rel="modulepreload" href="/assets/plugin-vueexport-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-CF3PDC1q.js" as="script"><link rel="prefetch" href="/assets/home.html-DCNIZrBC.js" as="script"><link rel="prefetch" href="/assets/intro.html-CVJdxjm-.js" as="script"><link rel="prefetch" href="/assets/slides.html-B9SH2bMr.js" as="script"><link rel="prefetch" href="/assets/index.html-DXsTnbw9.js" as="script"><link rel="prefetch" href="/assets/index.html-SC0L_j47.js" as="script"><link rel="prefetch" href="/assets/disable.html-NRH-Ni9m.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-DdeUERih.js" as="script"><link rel="prefetch" href="/assets/markdown.html-C2gY4pYY.js" as="script"><link rel="prefetch" href="/assets/page.html-DT4tgucG.js" as="script"><link rel="prefetch" href="/assets/PSæ“ä½œåŸºç¡€.html-dR-Kc8NS.js" as="script"><link rel="prefetch" href="/assets/index.html-DTCmyk2P.js" as="script"><link rel="prefetch" href="/assets/SAIæ“ä½œåŸºç¡€.html-C6bw4APT.js" as="script"><link rel="prefetch" href="/assets/index.html-Bog-xqtH.js" as="script"><link rel="prefetch" href="/assets/index.html-a8LnAMo4.js" as="script"><link rel="prefetch" href="/assets/asyncio_recipes.html-CTVjNFme.js" as="script"><link rel="prefetch" href="/assets/devops_in_python.html-C2sEXTyx.js" as="script"><link rel="prefetch" href="/assets/fluent_python.html-DgHUw-dh.js" as="script"><link rel="prefetch" href="/assets/index.html-C44S82JD.js" as="script"><link rel="prefetch" href="/assets/python_cookbook.html-CiTB651B.js" as="script"><link rel="prefetch" href="/assets/pythonæºç å‰–æ.html-DYO_zDUU.js" as="script"><link rel="prefetch" href="/assets/use_asyncio.html-z0j3rnmM.js" as="script"><link rel="prefetch" href="/assets/index.html-jT34N00B.js" as="script"><link rel="prefetch" href="/assets/äºšåŠ¨æœºä¸äººæ ¼.html-Bg76eOn2.js" as="script"><link rel="prefetch" href="/assets/äººçš„æ½œèƒ½å’Œä»·å€¼.html-BPBSeITc.js" as="script"><link rel="prefetch" href="/assets/å¥½äººæ˜¯å¦‚ä½•å˜æˆæ¶é­”çš„.html-DiaC2D37.js" as="script"><link rel="prefetch" href="/assets/å½±å“åŠ›.html-DRGqgC-p.js" as="script"><link rel="prefetch" href="/assets/æ€§å¿ƒç†å­¦.html-BS-hLPHK.js" as="script"><link rel="prefetch" href="/assets/æ´—è„‘å¿ƒç†å­¦.html-BB1w9yaR.js" as="script"><link rel="prefetch" href="/assets/è¿›åŒ–å¿ƒç†å­¦.html-CwChRmmE.js" as="script"><link rel="prefetch" href="/assets/CODE.html-DXqgyO7g.js" as="script"><link rel="prefetch" href="/assets/index.html-pbBczuxW.js" as="script"><link rel="prefetch" href="/assets/æˆä¸ºæŠ€æœ¯é¢†å¯¼è€….html-CQjijA4N.js" as="script"><link rel="prefetch" href="/assets/é¸Ÿå“¥çš„Linuxç§æˆ¿èœ.html-CF-t0TFV.js" as="script"><link rel="prefetch" href="/assets/é¸Ÿå“¥çš„Linuxç§æˆ¿èœæœåŠ¡å™¨æ¶è®¾ç¯‡.html-DSMqE3ta.js" as="script"><link rel="prefetch" href="/assets/é»‘å®¢ä¸ç”»å®¶.html-Bnb58qIg.js" as="script"><link rel="prefetch" href="/assets/index.html-DNx8JOhE.js" as="script"><link rel="prefetch" href="/assets/ä¸­å›½äººçš„æ€§æ ¼.html-DxSuo1tn.js" as="script"><link rel="prefetch" href="/assets/ä¹Œåˆä¹‹ä¼—.html-CtVUyQ3e.js" as="script"><link rel="prefetch" href="/assets/å¨±ä¹è‡³æ­».html-km7uSk4q.js" as="script"><link rel="prefetch" href="/assets/index.html-K4K24oI3.js" as="script"><link rel="prefetch" href="/assets/æ¸…é†’æ€è€ƒçš„è‰ºæœ¯.html-BQ3xG1ZL.js" as="script"><link rel="prefetch" href="/assets/index.html-_w4QbJHO.js" as="script"><link rel="prefetch" href="/assets/åšå¼ˆè®ºä¸ç»æµè¡Œä¸º.html-G6lAWLAf.js" as="script"><link rel="prefetch" href="/assets/å°±ä¸š_åˆ©æ¯å’Œè´§å¸é€šè®º.html-DkCwrrQ9.js" as="script"><link rel="prefetch" href="/assets/èªæ˜çš„æŠ•èµ„è€….html-30tDLZPc.js" as="script"><link rel="prefetch" href="/assets/è´§å¸é‡‘èå­¦.html-BgAkLmNf.js" as="script"><link rel="prefetch" href="/assets/éç†æ€§ç¹è£.html-CVfVenAA.js" as="script"><link rel="prefetch" href="/assets/MySQL.html-BA63Et6r.js" as="script"><link rel="prefetch" href="/assets/Mysqlè¿›é˜¶.html-D99_ylT5.js" as="script"><link rel="prefetch" href="/assets/Mysqlé«˜é˜¶.html-BoYqi56T.js" as="script"><link rel="prefetch" href="/assets/Navicat.html-n1qsIwJE.js" as="script"><link rel="prefetch" href="/assets/SQLAlchemy.html-C0EOqRuP.js" as="script"><link rel="prefetch" href="/assets/PostgreSQL.html-DODzxEu0.js" as="script"><link rel="prefetch" href="/assets/redis.html-D1VULQq4.js" as="script"><link rel="prefetch" href="/assets/æ€§èƒ½åˆ†æ.html-CbvqtWpy.js" as="script"><link rel="prefetch" href="/assets/aioetcd3.html-Dqxzuw4S.js" as="script"><link rel="prefetch" href="/assets/etcd.html-DQ89wVRF.js" as="script"><link rel="prefetch" href="/assets/è¿›é˜¶.html-CgeWG2yq.js" as="script"><link rel="prefetch" href="/assets/H2Oå¼•å‘çš„ä¼˜åŒ–.html-dFA9n4dc.js" as="script"><link rel="prefetch" href="/assets/å…³äºMapReduce.html-D7HU98qh.js" as="script"><link rel="prefetch" href="/assets/Mutex.html-Blq4f2HS.js" as="script"><link rel="prefetch" href="/assets/goå·¥å…·é€Ÿç”¨.html-DTOjX6gY.js" as="script"><link rel="prefetch" href="/assets/goè¯­è¨€é€Ÿè®°.html-C-JjWCUT.js" as="script"><link rel="prefetch" href="/assets/å†…å­˜ç®¡ç†ä¸GC.html-BkiqELP0.js" as="script"><link rel="prefetch" href="/assets/é—­åŒ….html-Bd4UdvTs.js" as="script"><link rel="prefetch" href="/assets/æ•°ç»„.html-C4A9eujQ.js" as="script"><link rel="prefetch" href="/assets/æ ˆä¸é˜Ÿåˆ—.html-DvVLVc4y.js" as="script"><link rel="prefetch" href="/assets/æ ‘.html-CsejTDfl.js" as="script"><link rel="prefetch" href="/assets/æ¦‚è¿°.html-fQ_J5e_-.js" as="script"><link rel="prefetch" href="/assets/çº¿æ€§è¡¨.html-CoEodgJr.js" as="script"><link rel="prefetch" href="/assets/dockerå®¹å™¨.html-BcANMs70.js" as="script"><link rel="prefetch" href="/assets/ä½¿ç”¨åŸºç¡€.html-D1eXZg0M.js" as="script"><link rel="prefetch" href="/assets/å‘½ä»¤.html-34VUHn2y.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œ.html-DHFxI_li.js" as="script"><link rel="prefetch" href="/assets/CICD.html-DZ9m_p0d.js" as="script"><link rel="prefetch" href="/assets/GItæäº¤è§„åˆ™.html-BTkUJND-.js" as="script"><link rel="prefetch" href="/assets/Git.html-CGbTf0fO.js" as="script"><link rel="prefetch" href="/assets/å®‰è£…GitLab.html-DTiiJxN7.js" as="script"><link rel="prefetch" href="/assets/Helmå®‰è£…ä½¿ç”¨.html-D1xYkKuW.js" as="script"><link rel="prefetch" href="/assets/k8så­˜å‚¨.html-B-Jx4wuE.js" as="script"><link rel="prefetch" href="/assets/k8så®‰è£….html-CJ_c70u2.js" as="script"><link rel="prefetch" href="/assets/k8så·¥ä½œè´Ÿè½½.html-ByN_P3n2.js" as="script"><link rel="prefetch" href="/assets/k8sæœåŠ¡.html-BKbCbasO.js" as="script"><link rel="prefetch" href="/assets/k8sèµ„æºPod.html-2XCCCh04.js" as="script"><link rel="prefetch" href="/assets/k8sè¿›é˜¶.html-Dbq_2-tR.js" as="script"><link rel="prefetch" href="/assets/NginxåŸºç¡€.html-CWNppzXG.js" as="script"><link rel="prefetch" href="/assets/åº”ç”¨éƒ¨ç½².html-BW6Nd-Tf.js" as="script"><link rel="prefetch" href="/assets/FiddleræŠ“åŒ…å·¥å…·.html-ysEo7F7h.js" as="script"><link rel="prefetch" href="/assets/Postman.html-BnjEh3B2.js" as="script"><link rel="prefetch" href="/assets/Screen.html-BkHW8m5c.js" as="script"><link rel="prefetch" href="/assets/rdesktop.html-CbuCoNwJ.js" as="script"><link rel="prefetch" href="/assets/tmux.html-CzMS64B0.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œä»£ç†.html-okA7ZN6F.js" as="script"><link rel="prefetch" href="/assets/åŸºæœ¬ä½¿ç”¨.html-Dmc2_7hs.js" as="script"><link rel="prefetch" href="/assets/å®‰è£….html-B521FTp0.js" as="script"><link rel="prefetch" href="/assets/APScheduler.html-BJiY1j_S.js" as="script"><link rel="prefetch" href="/assets/Celery.html-BkOH4FCr.js" as="script"><link rel="prefetch" href="/assets/Celeryä½¿ç”¨åŸºç¡€.html-CIqrpBUP.js" as="script"><link rel="prefetch" href="/assets/å¼‚æ­¥ä»»åŠ¡æ¦‚è¿°.html-vW_xBvi8.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ.html-C553tHOp.js" as="script"><link rel="prefetch" href="/assets/kafka.html-DWgEOZiA.js" as="script"><link rel="prefetch" href="/assets/kombu.html-CzBC7krq.js" as="script"><link rel="prefetch" href="/assets/pika.html-CCRFh6Jd.js" as="script"><link rel="prefetch" href="/assets/RPC.html-HMEHXRyG.js" as="script"><link rel="prefetch" href="/assets/gRPC.html-BBLKkr5S.js" as="script"><link rel="prefetch" href="/assets/asyncio Recipes.html-CwoYX4a0.js" as="script"><link rel="prefetch" href="/assets/asyncioåŸºç¡€.html-I9s4o8LE.js" as="script"><link rel="prefetch" href="/assets/asyncioè¿›é˜¶.html-vpbvYntf.js" as="script"><link rel="prefetch" href="/assets/äº‹ä»¶å¾ªç¯.html-BHX7AxwI.js" as="script"><link rel="prefetch" href="/assets/åº•å±‚å®ç°.html-BDwsXjlc.js" as="script"><link rel="prefetch" href="/assets/å¼‚æ­¥å›æº¯.html-DhCmVShz.js" as="script"><link rel="prefetch" href="/assets/Pythoné¡¹ç›®æ‰“åŒ….html-DvIVlroc.js" as="script"><link rel="prefetch" href="/assets/pip.html-DUXAgWxG.js" as="script"><link rel="prefetch" href="/assets/å­—ç¬¦ç¼–ç .html-BxQEEjYq.js" as="script"><link rel="prefetch" href="/assets/æ•°æ®ç±»å‹.html-CsUGkmsg.js" as="script"><link rel="prefetch" href="/assets/æ–‡ä»¶åŸºç¡€.html-C9zsEHDr.js" as="script"><link rel="prefetch" href="/assets/æµç¨‹æ§åˆ¶.html-Bn-ArJUo.js" as="script"><link rel="prefetch" href="/assets/ç¯å¢ƒå®‰è£….html-D-ef5HJy.js" as="script"><link rel="prefetch" href="/assets/Linuxæ–‡ä»¶é”.html-DeXIsTVR.js" as="script"><link rel="prefetch" href="/assets/åç¨‹.html-OVzTdvcg.js" as="script"><link rel="prefetch" href="/assets/åŒæ­¥é˜Ÿåˆ—.html-CHoov2b7.js" as="script"><link rel="prefetch" href="/assets/å¤šçº¿ç¨‹ç¼–ç¨‹.html-BGuZVnD3.js" as="script"><link rel="prefetch" href="/assets/å¤šè¿›ç¨‹ç¼–ç¨‹.html-CytSHKE9.js" as="script"><link rel="prefetch" href="/assets/çº¿ç¨‹.html-BYFPsUZr.js" as="script"><link rel="prefetch" href="/assets/çº¿ç¨‹è¿›ç¨‹è¾…åŠ©æœºåˆ¶.html-42ZaLHVE.js" as="script"><link rel="prefetch" href="/assets/è¿›ç¨‹.html-DmP9ozQS.js" as="script"><link rel="prefetch" href="/assets/é«˜æ€§èƒ½ç¼–ç¨‹.html-CLt98BVe.js" as="script"><link rel="prefetch" href="/assets/æ ‡å‡†åº“é“¾æ¥.html-Bb3y5CrB.js" as="script"><link rel="prefetch" href="/assets/Cpythonå¯¹è±¡.html-vzy7MVEy.js" as="script"><link rel="prefetch" href="/assets/åƒåœ¾å›æ”¶.html-DP09txBz.js" as="script"><link rel="prefetch" href="/assets/åºåˆ—è¿›é˜¶.html-CCnQVmRe.js" as="script"><link rel="prefetch" href="/assets/æ˜ å°„è¿›é˜¶.html-CnsK0jO-.js" as="script"><link rel="prefetch" href="/assets/è®¾è®¡æ¨¡å¼.html-BIh5Hxoo.js" as="script"><link rel="prefetch" href="/assets/Socket.html-DdmzFYqx.js" as="script"><link rel="prefetch" href="/assets/Websocket.html-CcFKIIle.js" as="script"><link rel="prefetch" href="/assets/äº‹ä»¶æ¨¡å‹.html-DZ7zahZ0.js" as="script"><link rel="prefetch" href="/assets/å›è°ƒ.html-CyGpl_ms.js" as="script"><link rel="prefetch" href="/assets/ä¿¡å·é‡.html-BFgx6pFv.js" as="script"><link rel="prefetch" href="/assets/å‡½æ•°.html-Sb8vgfUK.js" as="script"><link rel="prefetch" href="/assets/å˜é‡æœºåˆ¶.html-Blo4X5fe.js" as="script"><link rel="prefetch" href="/assets/æ¨¡å—å’ŒåŒ….html-BfD-OUGi.js" as="script"><link rel="prefetch" href="/assets/ç”Ÿæˆå™¨.html-B_48Dq95.js" as="script"><link rel="prefetch" href="/assets/è£…é¥°å™¨.html-30YiCiC2.js" as="script"><link rel="prefetch" href="/assets/è¿­ä»£å™¨.html-CRbo9qIe.js" as="script"><link rel="prefetch" href="/assets/é”™è¯¯å’Œå¼‚å¸¸.html-D_tMOZLf.js" as="script"><link rel="prefetch" href="/assets/é¢å‘å¯¹è±¡.html-DNZ1Jsfd.js" as="script"><link rel="prefetch" href="/assets/DNSæœåŠ¡.html-BDpQlc4Y.js" as="script"><link rel="prefetch" href="/assets/bind.html-CHMcBBAt.js" as="script"><link rel="prefetch" href="/assets/è„šæœ¬è¯´æ˜.html-CpMS5yct.js" as="script"><link rel="prefetch" href="/assets/ADåŸŸ.html-CudaAg4d.js" as="script"><link rel="prefetch" href="/assets/LDAP.html-DiVLgQIj.js" as="script"><link rel="prefetch" href="/assets/Pythonå¯¹æ¥ADåŸŸ.html-C_MaWrS-.js" as="script"><link rel="prefetch" href="/assets/NFSæœåŠ¡.html-CumLKyOg.js" as="script"><link rel="prefetch" href="/assets/NTPæœåŠ¡.html-aSsfX5hD.js" as="script"><link rel="prefetch" href="/assets/SNMPæœåŠ¡.html-BYSzJEfd.js" as="script"><link rel="prefetch" href="/assets/SNMPè®¾è®¡æ–‡æ¡£.html-BBIzDPS4.js" as="script"><link rel="prefetch" href="/assets/SambaæœåŠ¡.html-CGUPLzbY.js" as="script"><link rel="prefetch" href="/assets/rsync.html-Bz0ELeGL.js" as="script"><link rel="prefetch" href="/assets/isoæ„å»ºä»¥åŠå‘å¸ƒ.html-BLEoQyUR.js" as="script"><link rel="prefetch" href="/assets/ufscliå·¥å…·.html-Mo9-ILR0.js" as="script"><link rel="prefetch" href="/assets/ufsæ ¸å¿ƒç»„ä»¶.html-2S87hnKr.js" as="script"><link rel="prefetch" href="/assets/ufsç®¡ç†å¹³å°.html-B7dghzPs.js" as="script"><link rel="prefetch" href="/assets/uusè™šæ‹Ÿæœºæ’é”™.html-gkfaQA8D.js" as="script"><link rel="prefetch" href="/assets/CentOSçš„å®‰è£….html-l8mk14Fd.js" as="script"><link rel="prefetch" href="/assets/RPMåŒ…ç®¡ç†.html-c4hZokWS.js" as="script"><link rel="prefetch" href="/assets/è´¦å·ç®¡ç†ä¸ACLæƒé™.html-CyVKtia0.js" as="script"><link rel="prefetch" href="/assets/Linuxæ˜¯ä»€ä¹ˆä¸å¦‚ä½•å­¦ä¹ .html-CT8bFFmp.js" as="script"><link rel="prefetch" href="/assets/ä¸»æœºè§„åˆ’ä¸ç£ç›˜åˆ†åŒº.html-D1EMwUp5.js" as="script"><link rel="prefetch" href="/assets/è®¡ç®—æœºæ¦‚è®º.html-BRyjdByz.js" as="script"><link rel="prefetch" href="/assets/Linuxç£ç›˜ä¸æ–‡ä»¶ç³»ç»Ÿç®¡ç†.html-CF6MiJq4.js" as="script"><link rel="prefetch" href="/assets/æ–‡ä»¶ä¸æ–‡ä»¶ç³»ç»Ÿå‹ç¼©.html-NCCFcqz4.js" as="script"><link rel="prefetch" href="/assets/æ–‡ä»¶æƒé™ä¸ç›®å½•é…ç½®.html-vmrBKr7O.js" as="script"><link rel="prefetch" href="/assets/è®¤è¯†ç³»ç»ŸæœåŠ¡.html-S73Y_fzW.js" as="script"><link rel="prefetch" href="/assets/shell.html-CMeSbF0D.js" as="script"><link rel="prefetch" href="/assets/vim å¿«æ·é”®.html-DKCvF4uB.js" as="script"><link rel="prefetch" href="/assets/å¤‡å¿˜å‘½ä»¤.html-Bk3PvFpV.js" as="script"><link rel="prefetch" href="/assets/æ•…éšœå¿«æŸ¥.html-BycAdGLZ.js" as="script"><link rel="prefetch" href="/assets/æ“ä½œç³»ç»Ÿ.html-B8mUnp6y.js" as="script"><link rel="prefetch" href="/assets/CURL.html-JRhuXX6R.js" as="script"><link rel="prefetch" href="/assets/P2P.html-Bkua5iZr.js" as="script"><link rel="prefetch" href="/assets/å‘½ä»¤.html-DorzGu9j.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œåŸºç¡€.html-DB3Ebd-B.js" as="script"><link rel="prefetch" href="/assets/Ubuntuç³»ç»Ÿ.html-2lgjYc_l.js" as="script"><link rel="prefetch" href="/assets/CPU.html-DrMjT6mU.js" as="script"><link rel="prefetch" href="/assets/ä¸»æ¿.html-DWojTaLv.js" as="script"><link rel="prefetch" href="/assets/å†…å­˜.html-CMhJTOyN.js" as="script"><link rel="prefetch" href="/assets/å­˜å‚¨.html-CxukITrI.js" as="script"><link rel="prefetch" href="/assets/æ‰©å±•å¡ä¸æ¥å£.html-BzhrWaJy.js" as="script"><link rel="prefetch" href="/assets/æ˜¾å¡.html-IEgopMwA.js" as="script"><link rel="prefetch" href="/assets/PVE.html-CPxBZxzq.js" as="script"><link rel="prefetch" href="/assets/æ·»åŠ ç£ç›˜.html-BV67LvTX.js" as="script"><link rel="prefetch" href="/assets/ç½‘ç»œé…ç½®.html-B1FzEmOy.js" as="script"><link rel="prefetch" href="/assets/DjangoåŸºç¡€.html-Cg-Sk6TA.js" as="script"><link rel="prefetch" href="/assets/Djangoæ¦‚è¿°.html-BOUPTdRX.js" as="script"><link rel="prefetch" href="/assets/FastAPIåŸºç¡€.html-CbcC5-SA.js" as="script"><link rel="prefetch" href="/assets/FastAPIåŸºç¡€äºŒ.html-Y016ajKY.js" as="script"><link rel="prefetch" href="/assets/tornado.html-BXNIFF5a.js" as="script"><link rel="prefetch" href="/assets/WEBæ¡†æ¶æœ¬è´¨.html-C7GhMH6I.js" as="script"><link rel="prefetch" href="/assets/çŠ¶æ€ç®¡ç†.html-BEo4Yfcw.js" as="script"><link rel="prefetch" href="/assets/404.html-0D8DztTL.js" as="script"><link rel="prefetch" href="/assets/index.html-BfygTWeT.js" as="script"><link rel="prefetch" href="/assets/index.html-BfvGyfCK.js" as="script"><link rel="prefetch" href="/assets/index.html-CF7-7Nyk.js" as="script"><link rel="prefetch" href="/assets/index.html-DD7euG9h.js" as="script"><link rel="prefetch" href="/assets/index.html-DqyDqjT9.js" as="script"><link rel="prefetch" href="/assets/index.html-AGc3biqW.js" as="script"><link rel="prefetch" href="/assets/index.html-DXOXEOXB.js" as="script"><link rel="prefetch" href="/assets/index.html-B1O-esdR.js" as="script"><link rel="prefetch" href="/assets/index.html-BTmBwWqs.js" as="script"><link rel="prefetch" href="/assets/index.html-B8vkUs69.js" as="script"><link rel="prefetch" href="/assets/index.html-Bmr4IrtH.js" as="script"><link rel="prefetch" href="/assets/index.html-C3cXiaM7.js" as="script"><link rel="prefetch" href="/assets/index.html-5Uci1d5i.js" as="script"><link rel="prefetch" href="/assets/index.html-DFJhtNRj.js" as="script"><link rel="prefetch" href="/assets/index.html-DrgzzLSW.js" as="script"><link rel="prefetch" href="/assets/index.html-bAvEMMEp.js" as="script"><link rel="prefetch" href="/assets/index.html-5qwb9cod.js" as="script"><link rel="prefetch" href="/assets/index.html-h6M42Kcz.js" as="script"><link rel="prefetch" href="/assets/index.html-zjZm8E3x.js" as="script"><link rel="prefetch" href="/assets/index.html-BXjIkzW5.js" as="script"><link rel="prefetch" href="/assets/index.html-CsOqoQcN.js" as="script"><link rel="prefetch" href="/assets/index.html-DRbTHHxx.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy3C-UIx.js" as="script"><link rel="prefetch" href="/assets/index.html-yS4Hr7mI.js" as="script"><link rel="prefetch" href="/assets/index.html-4uend6WO.js" as="script"><link rel="prefetch" href="/assets/index.html-CaL4yRoh.js" as="script"><link rel="prefetch" href="/assets/index.html-DdmUOOLv.js" as="script"><link rel="prefetch" href="/assets/index.html-D9yMKiZw.js" as="script"><link rel="prefetch" href="/assets/index.html-L3qLR8O3.js" as="script"><link rel="prefetch" href="/assets/index.html-D9jJLA-O.js" as="script"><link rel="prefetch" href="/assets/index.html-CAFcD5YG.js" as="script"><link rel="prefetch" href="/assets/index.html-ByP8gwdi.js" as="script"><link rel="prefetch" href="/assets/index.html-WWAfW289.js" as="script"><link rel="prefetch" href="/assets/index.html-CM8vCGWB.js" as="script"><link rel="prefetch" href="/assets/index.html-WraVmSjK.js" as="script"><link rel="prefetch" href="/assets/index.html-D4ECVas2.js" as="script"><link rel="prefetch" href="/assets/index.html-2eBV6uJ8.js" as="script"><link rel="prefetch" href="/assets/index.html-DBUnXiNf.js" as="script"><link rel="prefetch" href="/assets/index.html-DfLDOdNj.js" as="script"><link rel="prefetch" href="/assets/index.html-BqpAG6wx.js" as="script"><link rel="prefetch" href="/assets/index.html-CNLaLmyf.js" as="script"><link rel="prefetch" href="/assets/index.html-CTZIXK0u.js" as="script"><link rel="prefetch" href="/assets/index.html-DtV0i8k9.js" as="script"><link rel="prefetch" href="/assets/index.html-CS_ySdKn.js" as="script"><link rel="prefetch" href="/assets/index.html-BXf2n_p9.js" as="script"><link rel="prefetch" href="/assets/index.html-KyhY6iXx.js" as="script"><link rel="prefetch" href="/assets/index.html-CRPlwKyB.js" as="script"><link rel="prefetch" href="/assets/index.html-J4Xn5tFe.js" as="script"><link rel="prefetch" href="/assets/index.html-BGKW0zcS.js" as="script"><link rel="prefetch" href="/assets/index.html-BcfmYXld.js" as="script"><link rel="prefetch" href="/assets/index.html-Di2imR_I.js" as="script"><link rel="prefetch" href="/assets/index.html-Ch-d6kWf.js" as="script"><link rel="prefetch" href="/assets/index.html-DyzoGeeM.js" as="script"><link rel="prefetch" href="/assets/index.html-DIMql7LC.js" as="script"><link rel="prefetch" href="/assets/index.html-ByrDWiPK.js" as="script"><link rel="prefetch" href="/assets/index.html-DBnMa1Zx.js" as="script"><link rel="prefetch" href="/assets/index.html-Djea8vAB.js" as="script"><link rel="prefetch" href="/assets/index.html-Bqa9kkoQ.js" as="script"><link rel="prefetch" href="/assets/index.html-YvesyJf1.js" as="script"><link rel="prefetch" href="/assets/index.html-CnV95OGM.js" as="script"><link rel="prefetch" href="/assets/index.html-Bz1zbqjF.js" as="script"><link rel="prefetch" href="/assets/index.html-A64iF6ll.js" as="script"><link rel="prefetch" href="/assets/index.html-BJg8PM9M.js" as="script"><link rel="prefetch" href="/assets/index.html-BtTVReiw.js" as="script"><link rel="prefetch" href="/assets/index.html-b8N0sGPG.js" as="script"><link rel="prefetch" href="/assets/index.html-CPqh4yJs.js" as="script"><link rel="prefetch" href="/assets/index.html-DH1b4KC4.js" as="script"><link rel="prefetch" href="/assets/index.html-DgcW3Zey.js" as="script"><link rel="prefetch" href="/assets/index.html-D0MltVCt.js" as="script"><link rel="prefetch" href="/assets/index.html-HMZEwmFk.js" as="script"><link rel="prefetch" href="/assets/index.html-DgcW3Zey.js" as="script"><link rel="prefetch" href="/assets/index.html-B7qK4XCc.js" as="script"><link rel="prefetch" href="/assets/index.html-DSkp17qA.js" as="script"><link rel="prefetch" href="/assets/index.html-CpJsU27B.js" as="script"><link rel="prefetch" href="/assets/index.html-D5qD6rt9.js" as="script"><link rel="prefetch" href="/assets/index.html-DeP-7TXK.js" as="script"><link rel="prefetch" href="/assets/index.html-D80tT89Y.js" as="script"><link rel="prefetch" href="/assets/index.html-BvFT4g03.js" as="script"><link rel="prefetch" href="/assets/index.html-CWT8r1E9.js" as="script"><link rel="prefetch" href="/assets/index.html-XKBp6QUx.js" as="script"><link rel="prefetch" href="/assets/index.html-BYwLhSf8.js" as="script"><link rel="prefetch" href="/assets/index.html-BpRVTimc.js" as="script"><link rel="prefetch" href="/assets/index.html-PGJLS35w.js" as="script"><link rel="prefetch" href="/assets/index.html-B-FJenbF.js" as="script"><link rel="prefetch" href="/assets/index.html-etHrj-yX.js" as="script"><link rel="prefetch" href="/assets/index.html-BPyVBR4H.js" as="script"><link rel="prefetch" href="/assets/index.html-BNc0P6UE.js" as="script"><link rel="prefetch" href="/assets/index.html-BuudXBLI.js" as="script"><link rel="prefetch" href="/assets/index.html-CZmijGgi.js" as="script"><link rel="prefetch" href="/assets/index.html-De6Amt66.js" as="script"><link rel="prefetch" href="/assets/index.html-DT7No_Ga.js" as="script"><link rel="prefetch" href="/assets/index.html-DAGnIBIX.js" as="script"><link rel="prefetch" href="/assets/index.html-BoHg2zSM.js" as="script"><link rel="prefetch" href="/assets/index.html-BGsRRe7c.js" as="script"><link rel="prefetch" href="/assets/index.html-Bkyq_IEP.js" as="script"><link rel="prefetch" href="/assets/index.html-DWKq30hu.js" as="script"><link rel="prefetch" href="/assets/index.html-D0MA08lU.js" as="script"><link rel="prefetch" href="/assets/index.html-x6CMkh-X.js" as="script"><link rel="prefetch" href="/assets/index.html-B24eGqxt.js" as="script"><link rel="prefetch" href="/assets/index.html-DjT5iVYb.js" as="script"><link rel="prefetch" href="/assets/index.html-z5SaML5h.js" as="script"><link rel="prefetch" href="/assets/index.html-BXO_zEMa.js" as="script"><link rel="prefetch" href="/assets/index.html-CPxJOlXP.js" as="script"><link rel="prefetch" href="/assets/index.html-CT762d_i.js" as="script"><link rel="prefetch" href="/assets/index.html-wJ0Tl8t_.js" as="script"><link rel="prefetch" href="/assets/index.html-B0p-hjCM.js" as="script"><link rel="prefetch" href="/assets/index.html-D1n8WrFi.js" as="script"><link rel="prefetch" href="/assets/index.html-D8DLNAYY.js" as="script"><link rel="prefetch" href="/assets/index.html-D1mgaHB0.js" as="script"><link rel="prefetch" href="/assets/index.html-BpEwpgiZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BIkue0kJ.js" as="script"><link rel="prefetch" href="/assets/index.html-AFRezUU8.js" as="script"><link rel="prefetch" href="/assets/index.html-D1mgaHB0.js" as="script"><link rel="prefetch" href="/assets/index.html-DHVU6esI.js" as="script"><link rel="prefetch" href="/assets/index.html-CwBFcWPr.js" as="script"><link rel="prefetch" href="/assets/index.html-BSQ9LZ0s.js" as="script"><link rel="prefetch" href="/assets/index.html-BBgVguj4.js" as="script"><link rel="prefetch" href="/assets/index.html-BdyrMDxP.js" as="script"><link rel="prefetch" href="/assets/index.html-H6pwhAwZ.js" as="script"><link rel="prefetch" href="/assets/index.html-51KwG8gE.js" as="script"><link rel="prefetch" href="/assets/index.html-Bts3z2ed.js" as="script"><link rel="prefetch" href="/assets/index.html-BSFP6roT.js" as="script"><link rel="prefetch" href="/assets/index.html-DtAkur9x.js" as="script"><link rel="prefetch" href="/assets/index.html-DpQMVxwH.js" as="script"><link rel="prefetch" href="/assets/index.html-CEoPsMff.js" as="script"><link rel="prefetch" href="/assets/index.html-DYu0zvhP.js" as="script"><link rel="prefetch" href="/assets/index.html-D6R3e0ym.js" as="script"><link rel="prefetch" href="/assets/index.html-Bem-2rVO.js" as="script"><link rel="prefetch" href="/assets/index.html-CEpo8xTp.js" as="script"><link rel="prefetch" href="/assets/index.html-C_Bz7Ihz.js" as="script"><link rel="prefetch" href="/assets/index.html-DYu0zvhP.js" as="script"><link rel="prefetch" href="/assets/index.html-DWSFbFXg.js" as="script"><link rel="prefetch" href="/assets/index.html-B_MphnyQ.js" as="script"><link rel="prefetch" href="/assets/index.html-E3fqZ76Y.js" as="script"><link rel="prefetch" href="/assets/index.html-DdjoVlqn.js" as="script"><link rel="prefetch" href="/assets/index.html-uHwtYFju.js" as="script"><link rel="prefetch" href="/assets/index.html-DBgQvscC.js" as="script"><link rel="prefetch" href="/assets/index.html-DLjfe3CW.js" as="script"><link rel="prefetch" href="/assets/index.html-BEZv66Uj.js" as="script"><link rel="prefetch" href="/assets/index.html-DxOdAkz4.js" as="script"><link rel="prefetch" href="/assets/index.html-C90tSyDB.js" as="script"><link rel="prefetch" href="/assets/index.html-BJ_SWveZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DcPveDHB.js" as="script"><link rel="prefetch" href="/assets/index.html-De1tYqk0.js" as="script"><link rel="prefetch" href="/assets/index.html-kpJeT6DF.js" as="script"><link rel="prefetch" href="/assets/index.html-CT3WMpfe.js" as="script"><link rel="prefetch" href="/assets/index.html-CW7d9U6K.js" as="script"><link rel="prefetch" href="/assets/index.html-CpFUyfnH.js" as="script"><link rel="prefetch" href="/assets/index.html-B8YnU5le.js" as="script"><link rel="prefetch" href="/assets/index.html-CEtD_nCR.js" as="script"><link rel="prefetch" href="/assets/index.html-BdfeYdRp.js" as="script"><link rel="prefetch" href="/assets/index.html-hUrpxIrs.js" as="script"><link rel="prefetch" href="/assets/index.html-TTFmEntA.js" as="script"><link rel="prefetch" href="/assets/index.html-DGiJffoE.js" as="script"><link rel="prefetch" href="/assets/index.html-BVJ3TYLz.js" as="script"><link rel="prefetch" href="/assets/index.html-DrPkqAzd.js" as="script"><link rel="prefetch" href="/assets/index.html-YpJn40CE.js" as="script"><link rel="prefetch" href="/assets/index.html-BwZYKak6.js" as="script"><link rel="prefetch" href="/assets/index.html-Dey9DC7x.js" as="script"><link rel="prefetch" href="/assets/index.html-Da-zUP1v.js" as="script"><link rel="prefetch" href="/assets/index.html-I7S4XJLq.js" as="script"><link rel="prefetch" href="/assets/index.html-Hgl1FE5m.js" as="script"><link rel="prefetch" href="/assets/index.html-By3jMTP8.js" as="script"><link rel="prefetch" href="/assets/index.html-CvmHKBhd.js" as="script"><link rel="prefetch" href="/assets/index.html-CIy_Yi_w.js" as="script"><link rel="prefetch" href="/assets/index.html-Ctw8wlyu.js" as="script"><link rel="prefetch" href="/assets/index.html-i-z3miKG.js" as="script"><link rel="prefetch" href="/assets/index.html-Bu-WzCsl.js" as="script"><link rel="prefetch" href="/assets/index.html-DOF_AHFN.js" as="script"><link rel="prefetch" href="/assets/index.html-CeTyRQ3y.js" as="script"><link rel="prefetch" href="/assets/index.html-DZc4v-eh.js" as="script"><link rel="prefetch" href="/assets/index.html-BymKTn8M.js" as="script"><link rel="prefetch" href="/assets/index.html-BNwUkLFy.js" as="script"><link rel="prefetch" href="/assets/index.html-CP8fQU8o.js" as="script"><link rel="prefetch" href="/assets/index.html-Da6a_C92.js" as="script"><link rel="prefetch" href="/assets/index.html-DajR23Xq.js" as="script"><link rel="prefetch" href="/assets/index.html-hvo3PQtu.js" as="script"><link rel="prefetch" href="/assets/index.html-BPBBCG7_.js" as="script"><link rel="prefetch" href="/assets/index.html-CH0JtYwV.js" as="script"><link rel="prefetch" href="/assets/index.html-LzoBTvW2.js" as="script"><link rel="prefetch" href="/assets/index.html-CtZjJB_W.js" as="script"><link rel="prefetch" href="/assets/index.html-BHTAxX95.js" as="script"><link rel="prefetch" href="/assets/index.html-pe29OMFV.js" as="script"><link rel="prefetch" href="/assets/index.html-DWamKelI.js" as="script"><link rel="prefetch" href="/assets/index.html-A590qWAu.js" as="script"><link rel="prefetch" href="/assets/index.html-C6Thhcpl.js" as="script"><link rel="prefetch" href="/assets/index.html-CEV70ddX.js" as="script"><link rel="prefetch" href="/assets/index.html-BdB1p7ly.js" as="script"><link rel="prefetch" href="/assets/index.html-BvmJuW2b.js" as="script"><link rel="prefetch" href="/assets/index.html-JBx1QSyx.js" as="script"><link rel="prefetch" href="/assets/index.html-D_00zvCP.js" as="script"><link rel="prefetch" href="/assets/index.html-DP7pl_9O.js" as="script"><link rel="prefetch" href="/assets/index.html-C4z6aZ48.js" as="script"><link rel="prefetch" href="/assets/index.html-CsjqBD7v.js" as="script"><link rel="prefetch" href="/assets/index.html-CkFBBVyi.js" as="script"><link rel="prefetch" href="/assets/index.html-DZ_NRaaB.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy_EriWr.js" as="script"><link rel="prefetch" href="/assets/index.html-smFE6WIU.js" as="script"><link rel="prefetch" href="/assets/index.html-Cgu5IQR2.js" as="script"><link rel="prefetch" href="/assets/index.html-CKw0nh4O.js" as="script"><link rel="prefetch" href="/assets/index.html-u1Sxtf_E.js" as="script"><link rel="prefetch" href="/assets/index.html-aLkpjQ5q.js" as="script"><link rel="prefetch" href="/assets/index.html-DIpteTAE.js" as="script"><link rel="prefetch" href="/assets/index.html-CKw0nh4O.js" as="script"><link rel="prefetch" href="/assets/index.html-CKxUGzU8.js" as="script"><link rel="prefetch" href="/assets/index.html-VU1WAVp5.js" as="script"><link rel="prefetch" href="/assets/index.html-D4W1c7-8.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/avatar.jpg" alt><!----><span class="vp-site-name hide-in-pad">æ‚¦ â–ª å®å®</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ" iconsizing="height"><!--[--><i class="vp-icon iconfont icon-home" sizing="height"></i><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Python"><!--[--><i class="vp-icon iconfont icon-python" sizing="height"></i>Python<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">è¯­è¨€</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80/%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85.html" aria-label="åŸºç¡€" iconsizing="both"><!---->åŸºç¡€<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E8%BF%9B%E9%98%B6/%E5%8F%98%E9%87%8F%E6%9C%BA%E5%88%B6.html" aria-label="è¿›é˜¶" iconsizing="both"><!---->è¿›é˜¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E6%B7%B1%E5%85%A5/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6.html" aria-label="æ·±å…¥" iconsizing="both"><!---->æ·±å…¥<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/Socket.html" aria-label="ç½‘ç»œç¼–ç¨‹" iconsizing="both"><!---->ç½‘ç»œç¼–ç¨‹<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%BC%96%E7%A8%8B/%E8%BF%9B%E7%A8%8B.html" aria-label="å¤šä»»åŠ¡ç¼–ç¨‹" iconsizing="both"><!---->å¤šä»»åŠ¡ç¼–ç¨‹<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/asyncio/asyncio%E5%9F%BA%E7%A1%80.html" aria-label="asyncio" iconsizing="both"><!---->asyncio<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E8%AF%AD%E8%A8%80/%E5%BA%93/%E6%A0%87%E5%87%86%E5%BA%93%E9%93%BE%E6%8E%A5.html" aria-label="åº“" iconsizing="both"><!---->åº“<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ç”Ÿæ€</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/Web%E6%A1%86%E6%9E%B6/%E7%BD%91%E7%BB%9C%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80/WEB%E6%A1%86%E6%9E%B6%E6%9C%AC%E8%B4%A8.html" aria-label="Webæ¡†æ¶" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-framework" sizing="both"></i><!--]-->Webæ¡†æ¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8/gRPC.html" aria-label="è¿œç¨‹è°ƒç”¨" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-rpc" sizing="both"></i><!--]-->è¿œç¨‹è°ƒç”¨<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/kafka.html" aria-label="æ¶ˆæ¯é˜Ÿåˆ—" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-kafka" sizing="both"></i><!--]-->æ¶ˆæ¯é˜Ÿåˆ—<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/python/%E7%94%9F%E6%80%81/%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/Celery.html" aria-label="å¼‚æ­¥ä»»åŠ¡" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-tasks" sizing="both"></i><!--]-->å¼‚æ­¥ä»»åŠ¡<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Golang"><!--[--><i class="vp-icon iconfont icon-go" sizing="height"></i>Golang<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">åŸºç¡€</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E5%9F%BA%E7%A1%80/go%E8%AF%AD%E8%A8%80%E9%80%9F%E8%AE%B0.html" aria-label="goè¯­è¨€é€Ÿè®°" iconsizing="both"><!---->goè¯­è¨€é€Ÿè®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E5%9F%BA%E7%A1%80/go%E5%B7%A5%E5%85%B7%E9%80%9F%E7%94%A8.html" aria-label="goå·¥å…·é€Ÿç”¨" iconsizing="both"><!---->goå·¥å…·é€Ÿç”¨<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ç®—æ³•ä¸æ•°æ®ç»“æ„</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A6%82%E8%BF%B0.html" aria-label="æ¦‚è¿°" iconsizing="both"><!---->æ¦‚è¿°<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ä¼˜åŒ–</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/go/%E4%BC%98%E5%8C%96/%E5%85%B3%E4%BA%8EMapReduce.html" aria-label="ä¼˜åŒ–" iconsizing="both"><!---->ä¼˜åŒ–<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ•°æ®åº“"><!--[--><i class="vp-icon iconfont icon-database" sizing="height"></i>æ•°æ®åº“<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/etcd/etcd.html" aria-label="etcd" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-etcd" sizing="both"></i><!--]-->etcd<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/MySQL/MySQL.html" aria-label="MySQL" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-mysql" sizing="both"></i><!--]-->MySQL<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/Redis/redis.html" aria-label="Redis" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-redis" sizing="both"></i><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/PostgreSQL/PostgreSQL.html" aria-label="PostgreSQL" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-postgresql" sizing="both"></i><!--]-->PostgreSQL<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ“ä½œç³»ç»Ÿ"><!--[--><i class="vp-icon iconfont icon-os" sizing="height"></i>æ“ä½œç³»ç»Ÿ<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/Linux/Linux%E5%9F%BA%E7%A1%80%E6%8C%87%E5%BC%95/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%A6%82%E8%AE%BA.html" aria-label="Linux" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-linux" sizing="both"></i><!--]-->Linux<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/CentOS/%E5%AE%89%E8%A3%85/CentOS%E7%9A%84%E5%AE%89%E8%A3%85.html" aria-label="CentOS" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-centos" sizing="both"></i><!--]-->CentOS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/Ubuntu/%E4%B8%8B%E8%BD%BD/Ubuntu%E7%B3%BB%E7%BB%9F.html" aria-label="Ubuntu" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-ubuntu" sizing="both"></i><!--]-->Ubuntu<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/unix/%E8%99%9A%E6%8B%9F%E6%9C%BA/PVE/PVE.html" aria-label="è™šæ‹Ÿæœº" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-pve" sizing="both"></i><!--]-->è™šæ‹Ÿæœº<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="è¿ç»´å·¥å…·"><!--[--><i class="vp-icon iconfont icon-devops" sizing="height"></i>è¿ç»´å·¥å…·<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Git/Git.html" aria-label="Git" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-git" sizing="both"></i><!--]-->Git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Nginx/Nginx%E5%9F%BA%E7%A1%80.html" aria-label="Nginx" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-nginx" sizing="both"></i><!--]-->Nginx<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Docker/docker%E5%AE%B9%E5%99%A8.html" aria-label="Docker" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-docker" sizing="both"></i><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Kubernetes/k8s%E8%B5%84%E6%BA%90Pod.html" aria-label="Kubernetes" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-kubernetes" sizing="both"></i><!--]-->Kubernetes<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Prometheus/%E5%AE%89%E8%A3%85.html" aria-label="Prometheus" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-prometheus" sizing="both"></i><!--]-->Prometheus<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tool/Other/%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86.html" aria-label="å·¥å…·" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-other" sizing="both"></i><!--]-->å·¥å…·<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ¼«æ¼«å…¨å¹²å·çš„è‹¦"><!--[--><!---->æ¼«æ¼«å…¨å¹²å·çš„è‹¦<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://draveness.me/golang/" aria-label="GOè¯­è¨€è®¾è®¡ä¸å®ç°" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-go" sizing="both"></i><!--]-->GOè¯­è¨€è®¾è®¡ä¸å®ç°<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://pegasuswang.github.io/LetsGo/basics/01_go_basic_types/basic_types/" aria-label="GOå¤‡å¿˜" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-go" sizing="both"></i><!--]-->GOå¤‡å¿˜<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://notes.fe-mm.com/interview/base/types.html" aria-label="å‰ç«¯å†…å·ä¸å½’è·¯" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-javascript" sizing="both"></i><!--]-->å‰ç«¯å†…å·ä¸å½’è·¯<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/Igarashi-G" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><i class="vp-icon iconfont icon-mysql" sizing="both"></i><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/database/MySQL/" aria-label="MySQL" iconsizing="both"><!---->MySQL<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/database/MySQL/MySQL.html" aria-label="MySQL" iconsizing="both"><!---->MySQL<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Mysqlè°ƒä¼˜</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/Igarashi-G" target="_blank" rel="noopener noreferrer">æ‚¦Â·å®å®</a></span><span property="author" content="æ‚¦Â·å®å®"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2022/10/12</span><meta property="datePublished" content="2022-10-12T14:58:07.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 36 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT36M"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="mysql-æœºåˆ¶è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#mysql-æœºåˆ¶è¯¦è§£"><span>MYSQL æœºåˆ¶è¯¦è§£</span></a></h1><h4 id="mysql-æ‰§è¡ŒæŸ¥è¯¢çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#mysql-æ‰§è¡ŒæŸ¥è¯¢çš„è¿‡ç¨‹"><span>MySQL æ‰§è¡ŒæŸ¥è¯¢çš„è¿‡ç¨‹</span></a></h4><ol><li>å®¢æˆ·ç«¯é€šè¿‡ TCP è¿æ¥å‘é€è¿æ¥è¯·æ±‚åˆ° MySQL è¿æ¥å™¨ï¼Œè¿æ¥å™¨ä¼šå¯¹è¯¥è¯·æ±‚è¿›è¡Œæƒé™éªŒè¯åŠè¿æ¥èµ„æºåˆ†é…</li><li>æŸ¥ç¼“å­˜ã€‚ï¼ˆå½“åˆ¤æ–­ç¼“å­˜æ˜¯å¦å‘½ä¸­æ—¶ï¼ŒMySQL ä¸ä¼šè¿›è¡Œè§£ææŸ¥è¯¢è¯­å¥ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ SQL è¯­å¥å’Œå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„å…¶ä»–åŸå§‹ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œä»»ä½•å­—ç¬¦ä¸Šçš„ä¸åŒï¼Œä¾‹å¦‚ç©ºæ ¼ã€æ³¨è§£ç­‰éƒ½ä¼šå¯¼è‡´ç¼“å­˜çš„ä¸å‘½ä¸­ã€‚ï¼‰</li><li>è¯­æ³•åˆ†æï¼ˆSQL è¯­æ³•æ˜¯å¦å†™é”™äº†ï¼‰ã€‚ å¦‚ä½•æŠŠè¯­å¥ç»™åˆ°é¢„å¤„ç†å™¨ï¼Œæ£€æŸ¥æ•°æ®è¡¨å’Œæ•°æ®åˆ—æ˜¯å¦å­˜åœ¨ï¼Œè§£æåˆ«åçœ‹æ˜¯å¦å­˜åœ¨æ­§ä¹‰ã€‚</li><li>ä¼˜åŒ–ã€‚æ˜¯å¦ä½¿ç”¨ç´¢å¼•ï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ã€‚</li><li>äº¤ç»™æ‰§è¡Œå™¨ï¼Œå°†æ•°æ®ä¿å­˜åˆ°ç»“æœé›†ä¸­ï¼ŒåŒæ—¶ä¼šé€æ­¥å°†æ•°æ®ç¼“å­˜åˆ°æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œæœ€ç»ˆå°†ç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ol><p><img src="/assets/image-20250611115432780-CrLnOf-R.png" alt="image-20250611115432780"></p><p>å¼•æ“ï¼š</p><ul><li><strong>InnoDBï¼š</strong> æ’å…¥æ—¶æŒ‰ä¸»é”®æ’åºæ’å…¥ï¼ˆæœ€å¸¸ç”¨ï¼‰ -- èšé›†</li><li><strong>MYISAMï¼š</strong> æŒ‰ç…§æ’å…¥æ—¶é¡ºåºæ’å…¥ -- å †è¡¨ï¼ˆæ•°æ®å †åœ¨ä¸€èµ·ï¼‰</li></ul><h2 id="ä¸€ã€innodb-å­˜å‚¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€innodb-å­˜å‚¨ç»“æ„"><span>ä¸€ã€InnoDB å­˜å‚¨ç»“æ„</span></a></h2><h3 id="_1-é¡µå­˜å‚¨æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_1-é¡µå­˜å‚¨æœºåˆ¶"><span>1. é¡µå­˜å‚¨æœºåˆ¶</span></a></h3><ul><li><strong>æ“ä½œç³»ç»Ÿå†…å­˜é¡µ</strong>ï¼š4KB</li><li><strong>InnoDBé¡µå¤§å°</strong>ï¼šé»˜è®¤16KB (<code>innodb_page_size = 16384</code>)</li></ul><h4 id="é¡µç»“æ„ç»„æˆ" tabindex="-1"><a class="header-anchor" href="#é¡µç»“æ„ç»„æˆ"><span>é¡µç»“æ„ç»„æˆï¼š</span></a></h4><div class="language-markdown line-numbers-mode" data-highlighter="shiki" data-ext="markdown" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">File Header</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Page Header</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Infimum + Supremum Records</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">User Records</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Free Space</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Page Directory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">File Trailer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-innodbè¡Œæ ¼å¼" tabindex="-1"><a class="header-anchor" href="#_2-innodbè¡Œæ ¼å¼"><span>2. InnoDBè¡Œæ ¼å¼</span></a></h3><table><thead><tr><th style="text-align:center;">è¡Œæ ¼å¼</th><th style="text-align:center;">ç‰¹ç‚¹</th><th style="text-align:center;">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td style="text-align:center;">Compact</td><td style="text-align:center;">å˜é•¿å­—æ®µé•¿åº¦åˆ—è¡¨ + NULLæ ‡å¿—ä½ + è®°å½•å¤´ä¿¡æ¯ + åˆ—æ•°æ®</td><td style="text-align:center;">å¸¸è§„ä½¿ç”¨</td></tr><tr><td style="text-align:center;">Redundant</td><td style="text-align:center;">å…¼å®¹è€ç‰ˆæœ¬</td><td style="text-align:center;">å†å²é—ç•™ç³»ç»Ÿ</td></tr><tr><td style="text-align:center;">Dynamic</td><td style="text-align:center;">è¡Œæº¢å‡ºæ•°æ®å…¨éƒ¨å­˜å‚¨åˆ°å…¶ä»–é¡µé¢ï¼Œåªä¿ç•™åœ°å€</td><td style="text-align:center;">å¤§å­—æ®µæ•°æ®</td></tr><tr><td style="text-align:center;">Compressed</td><td style="text-align:center;">åœ¨DynamicåŸºç¡€ä¸Šå¢åŠ é¡µé¢å‹ç¼©</td><td style="text-align:center;">å­˜å‚¨æ•æ„Ÿåœºæ™¯</td></tr></tbody></table><p><strong>è®¾ç½®è¯­æ³•</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> è¡¨å</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (åˆ—ä¿¡æ¯) ROW_FORMAT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è¡Œæ ¼å¼åç§°;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> è¡¨å ROW_FORMAT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è¡Œæ ¼å¼åç§°;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-è¡Œå­˜å‚¨ç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#_3-è¡Œå­˜å‚¨ç‰¹æ€§"><span>3. è¡Œå­˜å‚¨ç‰¹æ€§</span></a></h3><ul><li><strong>è¡Œå¤§å°é™åˆ¶</strong>ï¼šéBLOBå­—æ®µæœ€å¤§65535å­—èŠ‚</li><li><strong>éšè—åˆ—</strong>ï¼š <ul><li><code>DB_ROW_ID</code>(6B)ï¼šæ— ä¸»é”®æ—¶è‡ªåŠ¨ç”Ÿæˆ</li><li><code>DB_TRX_ID</code>(7B)ï¼šäº‹åŠ¡ID</li><li><code>DB_ROLL_PTR</code>(7B)ï¼šå›æ»šæŒ‡é’ˆ</li></ul></li><li><strong>è¡Œæº¢å‡ºå¤„ç†</strong>ï¼š <ul><li>æ–¹å¼1ï¼šå½“å‰é¡µå­˜éƒ¨åˆ†æ•°æ®+ä¸‹ä¸€é¡µåœ°å€</li><li>æ–¹å¼2ï¼šåªå­˜èµ·å§‹é¡µå’Œæœ«å°¾é¡µåœ°å€ï¼ˆä¸ç´¢å¼•ç›¸å…³ï¼‰</li></ul></li></ul><h2 id="äºŒã€ç´¢å¼•æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#äºŒã€ç´¢å¼•æœºåˆ¶"><span>äºŒã€ç´¢å¼•æœºåˆ¶</span></a></h2><h3 id="_1-b-æ ‘ç´¢å¼•ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-b-æ ‘ç´¢å¼•ç»“æ„"><span>1. B+æ ‘ç´¢å¼•ç»“æ„</span></a></h3><div class="language-markdown line-numbers-mode" data-highlighter="shiki" data-ext="markdown" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æ ¹èŠ‚ç‚¹(éå¶å­èŠ‚ç‚¹)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  â†“</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ä¸­é—´èŠ‚ç‚¹(éå¶å­èŠ‚ç‚¹ï¼Œå­˜å‚¨ä¸»é”®+æŒ‡é’ˆ)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  â†“</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å¶å­èŠ‚ç‚¹(å­˜å‚¨å®é™…æ•°æ®)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>éå¶å­èŠ‚ç‚¹ä»…å­˜å‚¨é”®å€¼å’ŒæŒ‡é’ˆ</li><li>å¶å­èŠ‚ç‚¹å½¢æˆæœ‰åºé“¾è¡¨ï¼Œæ”¯æŒé«˜æ•ˆèŒƒå›´æŸ¥è¯¢</li><li>æ¯ä¸ªèŠ‚ç‚¹å¯å­˜å‚¨å¤šä¸ªå…ƒç´ ï¼ˆç›¸æ¯”äºŒå‰æ ‘é«˜åº¦æ›´ä½ï¼‰</li></ul><h3 id="_2-ç´¢å¼•å­˜å‚¨è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#_2-ç´¢å¼•å­˜å‚¨è®¡ç®—"><span>2. ç´¢å¼•å­˜å‚¨è®¡ç®—</span></a></h3><ul><li>å‡è®¾ä¸»é”®ä¸ºBIGINT(8B)ï¼ŒæŒ‡é’ˆ6B</li><li>å•é¡µå¯å­˜å‚¨é”®å€¼å¯¹ï¼š16KB/(8+6) â‰ˆ 1170</li><li>é«˜åº¦ä¸º3çš„B+æ ‘å¯å­˜å‚¨ï¼š1170Ã—1170Ã—16 â‰ˆ 2åƒä¸‡æ¡è®°å½•</li></ul><h3 id="_3-ç´¢å¼•ä½¿ç”¨åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#_3-ç´¢å¼•ä½¿ç”¨åŸåˆ™"><span>3. ç´¢å¼•ä½¿ç”¨åŸåˆ™</span></a></h3><h4 id="è¾…åŠ©ç´¢å¼•-äºŒçº§ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#è¾…åŠ©ç´¢å¼•-äºŒçº§ç´¢å¼•"><span>è¾…åŠ©ç´¢å¼•ï¼ˆäºŒçº§ç´¢å¼•ï¼‰</span></a></h4><ul><li>é¢å¤–æ„å»ºB+æ ‘ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨ä¸»é”®å€¼</li><li>æŸ¥è¯¢æµç¨‹ï¼šè¾…åŠ©ç´¢å¼•â†’ä¸»é”®ç´¢å¼•â†’æ•°æ®ï¼ˆå›è¡¨ï¼‰</li></ul><h4 id="æœ€å·¦å‰ç¼€åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#æœ€å·¦å‰ç¼€åŸåˆ™"><span>æœ€å·¦å‰ç¼€åŸåˆ™</span></a></h4><ul><li><p>è”åˆç´¢å¼•(b,c,d)åªèƒ½åŒ¹é…ï¼š</p><ul><li><code>WHERE b=1 AND c=1 AND d=1</code>ï¼ˆå®Œå…¨åŒ¹é…ï¼‰</li><li><code>WHERE b=1 AND c=1</code>ï¼ˆéƒ¨åˆ†åŒ¹é…ï¼‰</li><li><code>WHERE b LIKE &#39;101%&#39;</code>ï¼ˆå‰ç¼€åŒ¹é…ï¼‰</li></ul><p>ä¸åŒ¹é…ï¼š</p><ul><li><code>WHERE c=1 AND d=1</code></li><li><code>WHERE b LIKE &#39;%101%&#39;</code></li></ul></li></ul><h4 id="ç´¢å¼•ä¼˜åŒ–æŠ€å·§" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ä¼˜åŒ–æŠ€å·§"><span>ç´¢å¼•ä¼˜åŒ–æŠ€å·§</span></a></h4><ul><li>åç¼€åŒ¹é…ä¼˜åŒ–ï¼š<code>LIKE &#39;%com&#39;</code> â†’ å­˜å‚¨é€†åº<code>moc%</code></li><li>NULLå€¼åœ¨ç´¢å¼•ä¸­è§†ä¸ºæœ€å°å€¼</li><li>ç›¸åŒå€¼çš„éå”¯ä¸€ç´¢å¼•ä¼šé™„åŠ ä¸»é”®å€¼</li></ul><h3 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h3><p><strong>é¡µç›®å½•ï¼š</strong> æœ¬è´¨æ˜¯æ ‘ï¼Œå³ç”¨ä¸€ä¸ªé¡µ åˆ©ç”¨äºŒåˆ†æ³•è¿›è¡Œæ¥è®°å½•å„æ•°æ®çš„åœ°å€ï¼Œæ¯ä¸€é¡µä¼šæœ‰ä¸»é”®ï¼Œå¹¶æŠŠä¸»é”®æå‡ºæ¥ä½œä¸ºç´¢å¼•éƒ¨åˆ†</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>              é¡µå·100                       é¡µå·200</span></span>
<span class="line"><span>            1 -&gt;  1111a                   5 -&gt; 5555e</span></span>
<span class="line"><span>                  2222b       -&gt;               6666f</span></span>
<span class="line"><span>            3 -&gt;  3333c...                7 -&gt; 7777g ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç›®å½•é¡µ:</strong><br> é¢å¤–æå‡ºä¸€ä¸ªé¡µï¼Œç”¨æ¥å­˜å‚¨é¡µå·ï¼Œä½†æ¯ä¸€é¡µçš„é¡µå·å¯ä¸æ˜¯ç›¸é‚»çš„ï¼Œåè€Œä¼šå†ç”¨ä¸€ä¸ª key-value å»å­˜å‚¨é¡µå·</p><pre><code>                1                          5            --  ä¸»é”®
               100                        200           --  æŒ‡é’ˆ
                |                          |
             é¡µå·100                    é¡µå·200          --  æŒ‡é’ˆæŒ‡å‘çš„è¡Œæ•°æ®
</code></pre><ul><li>**keyï¼š**æ¯é¡µä¸­æœ€å°çš„å€¼ï¼Œ åˆ©ç”¨ä¸»é”®éƒ½æ˜¯é€’å¢é¡ºåºæ’åˆ—</li><li>**valueï¼š**å¯¹åº”çš„é¡µå·</li></ul><p>å› æ­¤å°±æ˜¯ä¸€ä¸ªB+æ ‘ç»“æ„(æ ¹èŠ‚ç‚¹çš„å…ƒç´ æ€»ä¼šç•™ä¸€ä¸ªåœ¨å¶å­èŠ‚ç‚¹ä¸Š) ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥å­˜å¤šä¸ªå…ƒç´ </p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>                                 0003 0005</span></span>
<span class="line"><span>             |                       |                         |</span></span>
<span class="line"><span>           0002                    0004                       0005</span></span>
<span class="line"><span>        |         |           |            |              |            |</span></span>
<span class="line"><span>    0001   -&gt;    0002   -&gt;   0003    -&gt;   0004   -&gt;    0005    -&gt;    0006 0007</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>å¶å­èŠ‚ç‚¹ï¼šå­˜æ•°æ®</span></span>
<span class="line"><span>    éå¶å­èŠ‚ç‚¹ï¼šå­˜ä¸»é”® + æŒ‡é’ˆ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    æ‰€ä»¥æ’å…¥ç´¢å¼•çš„è¿‡ç¨‹ä¸­æ˜¯ç”ŸæˆB+æ ‘çš„è¿‡ç¨‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰åºçš„åŸå› ï¼Œæ˜¯å­˜åœ¨äº†B+æ ‘çš„å¶å­èŠ‚ç‚¹é‡Œ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    æ³¨ï¼š</span></span>
<span class="line"><span>        1.ä¸»é”®IDä¸é€‚åˆå¤ªé•¿ï¼Œè‹¥è¿‡äºé•¿çš„è¯ä¸€é¡µæ”¾ä¸ä¸‹ï¼Œå†ä¼šå°†æ ‘çš„é«˜åº¦æ‹‰é•¿ï¼Œæ ‘çš„é«˜åº¦è¶Šé«˜ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å°±ä¼šä¸‹é™</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        2.mysql åˆ›å»ºè¿‡ç¨‹ç•¥å¾®ä¸åŒï¼Œä»–æ˜¯å½“æ‰§è¡Œåˆ›å»ºè¡¨å‘½ä»¤æ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªé¡µï¼Œå½“ä¸€ä¸ªé¡µè£…ä¸ä¸‹åï¼Œä¸æ˜¯åœ¨åˆ›å»ºç¬¬äºŒä¸ªé¡µï¼Œ</span></span>
<span class="line"><span>          è€Œæ˜¯å°†ç¬¬ä¸€ä¸ªé¡µcopyä¸€ä»½ï¼Œåˆ›å»ºç¬¬äºŒä¸ªé¡µï¼Œå†å°†ä¹‹å‰çš„ç¬¬ä¸€é¡µæ”¹ä¸ºç›®å½•é¡µ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        3.B+æ ‘çš„ä¼˜åŠ¿ï¼Œç›¸æ¯”äºAVLæ ‘ï¼ˆäºŒå‰ï¼‰ B+æ ‘çš„ä¼˜åŠ¿åœ¨äºä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å¤šä¸ªå…ƒç´ ï¼Œå› æ­¤ä¼šæ¯”AVLæ ‘é«˜åº¦è¦ä½ï¼Œå› æ­¤æŸ¥æ‰¾</span></span>
<span class="line"><span>          æ—¶çš„æ‰§è¡Œæ•ˆç‡è¦ä½ã€‚è™½ç„¶æ•°æ®å†—ä½™äº†ï¼ŒæŸ¥æ‰¾ = ç­‰äºçš„æ¡ä»¶ä¸æ˜æ˜¾ï¼Œä½†æŸ¥æ‰¾&gt; &lt; æ¡ä»¶æ—¶åˆ™ä¸åŒ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>          ä¾‹å¦‚ï¼š æŸ¥ &gt; 0002 çš„æ•°æ®ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ç´¢å¼•ï¼ˆ0002åçš„é“¾è¡¨æŒ‡é’ˆï¼‰æå–æ‰€æœ‰æ•°æ®ï¼Œè€ŒAVLæ ‘è¦å…ˆæ‰¾å‡ºå³å­æ ‘</span></span>
<span class="line"><span>                çš„èŠ‚ç‚¹ï¼Œä¹‹åè¿˜è¦å›å½’çˆ¶èŠ‚ç‚¹ï¼Œå±‚å±‚éå†  ï¼ˆSQLèŒƒå›´æŸ¥è¯¢ï¼‰</span></span>
<span class="line"><span></span></span>
<span class="line"><span>          æ®è¯´ B+æ ‘é«˜åº¦ç­‰äº2 çš„æ—¶å€™ï¼Œå¤§çº¦å¯å­˜ 20000å¤šæ¡æ•°æ®ï¼Œ B+æ ‘é«˜åº¦ç­‰äº3 çš„æ—¶å€™ï¼Œ å¯ä»¥å­˜ 2åƒä¸‡å¤šæ¡æ•°æ®</span></span>
<span class="line"><span></span></span>
<span class="line"><span>          å‡è®¾æ¨ç®—ï¼šä¸»é”®ç”¨bigintç±»å‹ å 8å­—èŠ‚ æŒ‡é’ˆå 6ä¸ªå­—èŠ‚ å› æ­¤åœ¨ä¸€é¡µä¸­ï¼Œå¯ä»¥å­˜å¤šå°‘ä¸ªéå¶å­èŠ‚ç‚¹</span></span>
<span class="line"><span>                   16kb/(8+6)=1170.28... å¯ä»¥å­˜1170å¯¹ é”®å€¼å¯¹ï¼ˆä»£è¡¨ä¸‹é¢æœ‰å¤šå°‘ä¸ªå¶å­èŠ‚ç‚¹ï¼‰</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                   æ­¤æ—¶å‡è®¾ä¸€è¡Œæ•°æ®ä¸º1KBï¼Œä¸€é¡µå­˜16æ¡æ•°æ®ï¼Œé‚£ä¹ˆé«˜åº¦ä¸º2çš„æƒ…å†µä¸‹ å¯å­˜ 1170 * 16 = 18724 æ¡æ•°æ®</span></span>
<span class="line"><span>                   å› æ­¤ç”¨B+æ ‘æ‰¾æœ€å¤šæ‰¾ä¸¤æ¬¡å°±èƒ½åœ¨2åƒå¤šä¸‡æ¡æ•°æ®ä¸­æ‰¾åˆ°é‚£ä¸ªé¡µ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åŸºæœ¬ç»“æ„" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç»“æ„"><span>åŸºæœ¬ç»“æ„</span></a></h4><ul><li><strong>æœ¬è´¨</strong>ï¼šä¸€ç§ä¼˜åŒ–é¡µå†…æ•°æ®æŸ¥æ‰¾çš„äºŒåˆ†æœç´¢ç»“æ„</li><li><strong>ä½ç½®</strong>ï¼šä½äºæ¯ä¸ªæ•°æ®é¡µçš„å°¾éƒ¨ï¼ˆPage DirectoryåŒºåŸŸï¼‰</li><li><strong>ç»„æˆï¼š</strong><ul><li>æ§½ä½ï¼ˆSlotsï¼‰ï¼šå­˜å‚¨æ¯ç»„è®°å½•çš„æœ€å¤§ä¸»é”®å€¼</li><li>æŒ‡é’ˆï¼šæŒ‡å‘å¯¹åº”è®°å½•ç»„çš„èµ·å§‹ä½ç½®</li></ul></li></ul><h4 id="å·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#å·¥ä½œæµç¨‹"><span>å·¥ä½œæµç¨‹</span></a></h4><div class="language-markdown line-numbers-mode" data-highlighter="shiki" data-ext="markdown" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æ•°æ®é¡µå†…éƒ¨ç»“æ„ï¼š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| è®°å½•1 (ID=1)        |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| è®°å½•2 (ID=3)        |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| è®°å½•3 (ID=5)        |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| ...                 |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| é¡µç›®å½•              |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| Slot1: ID=5 -&gt; è®°å½•3 |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| Slot2: ID=3 -&gt; è®°å½•2 |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| Slot3: ID=1 -&gt; è®°å½•1 |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------------+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æŸ¥æ‰¾è¿‡ç¨‹-ä»¥æŸ¥æ‰¾id-4ä¸ºä¾‹" tabindex="-1"><a class="header-anchor" href="#æŸ¥æ‰¾è¿‡ç¨‹-ä»¥æŸ¥æ‰¾id-4ä¸ºä¾‹"><span>æŸ¥æ‰¾è¿‡ç¨‹ï¼ˆä»¥æŸ¥æ‰¾ID=4ä¸ºä¾‹ï¼‰ï¼š</span></a></h4><ol><li>é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç¡®å®šID=4ä½äºSlot1(ID=5)å’ŒSlot2(ID=3)ä¹‹é—´</li><li>æ ¹æ®æŒ‡é’ˆå®šä½åˆ°è®°å½•ç»„ï¼ˆè®°å½•2åˆ°è®°å½•3ä¹‹é—´ï¼‰</li><li>åœ¨ç»„å†…çº¿æ€§æŸ¥æ‰¾ç›®æ ‡è®°å½•</li></ol><h3 id="_2-b-æ ‘ç´¢å¼•çš„å®Œæ•´ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_2-b-æ ‘ç´¢å¼•çš„å®Œæ•´ç»“æ„"><span>2. B+æ ‘ç´¢å¼•çš„å®Œæ•´ç»“æ„</span></a></h3><h4 id="å±‚çº§å…³ç³»ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å±‚çº§å…³ç³»ç¤ºä¾‹"><span>å±‚çº§å…³ç³»ç¤ºä¾‹</span></a></h4><div class="language-markdown line-numbers-mode" data-highlighter="shiki" data-ext="markdown" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æ ¹èŠ‚ç‚¹ï¼ˆé¡µå·300ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| é”®å€¼: 5       | â†’ æŒ‡å‘é¡µ200</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| é”®å€¼: 10      | â†’ æŒ‡å‘é¡µ250</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       â†“</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ä¸­é—´èŠ‚ç‚¹ï¼ˆé¡µ200ï¼‰        ä¸­é—´èŠ‚ç‚¹ï¼ˆé¡µ250ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------+       +---------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| é”®å€¼: 3       | â†’     | é”®å€¼: 7      | â†’</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| é”®å€¼: 5       | â†’     | é”®å€¼: 10     | â†’</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------+       +---------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       â†“                       â†“</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å¶å­èŠ‚ç‚¹ï¼ˆé¡µ100ï¼‰      å¶å­èŠ‚ç‚¹ï¼ˆé¡µ150ï¼‰      å¶å­èŠ‚ç‚¹ï¼ˆé¡µ300ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------+       +---------------+       +---------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| 1 â†’ è®°å½•A     |       | 5 â†’ è®°å½•E     |       | 10 â†’ è®°å½•J    |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| 2 â†’ è®°å½•B     |       | 6 â†’ è®°å½•F     |       | 11 â†’ è®°å½•K    |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| 3 â†’ è®°å½•C     |       | 7 â†’ è®°å½•G     |       | ...           |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+---------------+       +---------------+       +---------------+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…³é”®ç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#å…³é”®ç‰¹æ€§"><span>å…³é”®ç‰¹æ€§</span></a></h4><ol><li><p><strong>åŒå‘é“¾è¡¨è¿æ¥</strong>ï¼šæ‰€æœ‰å¶å­èŠ‚ç‚¹é€šè¿‡æŒ‡é’ˆå½¢æˆåŒå‘é“¾è¡¨ï¼Œæ”¯æŒé«˜æ•ˆèŒƒå›´æŸ¥è¯¢</p><div class="language-markdown line-numbers-mode" data-highlighter="shiki" data-ext="markdown" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">é¡µ100 â†’ é¡µ150 â†’ é¡µ300 â†’ ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>å¡«å……å› å­</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹é€šå¸¸å¡«å……15/16çš„ç©ºé—´ï¼ˆçº¦93.75%ï¼‰</p></li><li><p><strong>åˆ†è£‚è§„åˆ™</strong>ï¼š</p><ul><li>å½“é¡µæ»¡æ—¶å‘ç”Ÿåˆ†è£‚</li><li>ä¸­é—´é”®å€¼ä¼šä¸Šæåˆ°çˆ¶èŠ‚ç‚¹</li><li>ç¤ºä¾‹ï¼šé¡µ150æ»¡æ—¶åˆ†è£‚ä¸ºé¡µ150å’Œé¡µ155ï¼Œé”®å€¼7ä¸Šæåˆ°çˆ¶èŠ‚ç‚¹</li></ul></li></ol><h3 id="_3-ç´¢å¼•æ“ä½œç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#_3-ç´¢å¼•æ“ä½œç¤ºä¾‹"><span>3. ç´¢å¼•æ“ä½œç¤ºä¾‹</span></a></h3><h4 id="æŸ¥æ‰¾id-6çš„è®°å½•" tabindex="-1"><a class="header-anchor" href="#æŸ¥æ‰¾id-6çš„è®°å½•"><span>æŸ¥æ‰¾ID=6çš„è®°å½•</span></a></h4><ol><li>ä»æ ¹èŠ‚ç‚¹ï¼ˆé¡µ300ï¼‰å¼€å§‹ï¼š <ul><li>6 &lt; 10 â†’ é€‰æ‹©å·¦åˆ†æ”¯ï¼ˆé¡µ200ï¼‰</li></ul></li><li>åœ¨é¡µ200ä¸­ï¼š <ul><li>3 &lt; 6 â‰¤ 5 â†’ é€‰æ‹©é¡µ150</li></ul></li><li>åœ¨é¡µ150ä¸­çº¿æ€§æŸ¥æ‰¾æ‰¾åˆ°ID=6çš„è®°å½•F</li></ol><h4 id="èŒƒå›´æŸ¥è¯¢id-between-4-and-8" tabindex="-1"><a class="header-anchor" href="#èŒƒå›´æŸ¥è¯¢id-between-4-and-8"><span>èŒƒå›´æŸ¥è¯¢ID BETWEEN 4 AND 8</span></a></h4><ol><li>å®šä½åˆ°ID=4çš„èµ·å§‹ä½ç½®ï¼ˆé¡µ150ï¼‰</li><li>æ²¿å¶å­èŠ‚ç‚¹é“¾è¡¨æ‰«æï¼š <ul><li>é¡µ150ï¼š5(E), 6(F), 7(G)</li><li>é¡µ300ï¼š...ï¼ˆç›´åˆ°ID&gt;8åœæ­¢ï¼‰</li></ul></li></ol><h3 id="_4-ä¸å“ˆå¸Œç´¢å¼•çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_4-ä¸å“ˆå¸Œç´¢å¼•çš„åŒºåˆ«"><span>4. ä¸å“ˆå¸Œç´¢å¼•çš„åŒºåˆ«</span></a></h3><table><thead><tr><th style="text-align:center;">ç‰¹æ€§</th><th style="text-align:center;">B+æ ‘ç´¢å¼•</th><th style="text-align:center;">å“ˆå¸Œç´¢å¼•</th></tr></thead><tbody><tr><td style="text-align:center;">æŸ¥è¯¢ç±»å‹æ”¯æŒ</td><td style="text-align:center;">ç­‰å€¼ã€èŒƒå›´ã€æ’åº</td><td style="text-align:center;">ä»…ç­‰å€¼æŸ¥è¯¢</td></tr><tr><td style="text-align:center;">ç£ç›˜I/Oæ•ˆç‡</td><td style="text-align:center;">é«˜ï¼ˆé¡ºåºè®¿é—®ï¼‰</td><td style="text-align:center;">éšæœºè®¿é—®</td></tr><tr><td style="text-align:center;">å†…å­˜åˆ©ç”¨ç‡</td><td style="text-align:center;">é«˜ï¼ˆèŠ‚ç‚¹å¯ç¼“å­˜ï¼‰</td><td style="text-align:center;">ä¾èµ–å“ˆå¸Œè¡¨å¤§å°</td></tr><tr><td style="text-align:center;">é€‚åˆåœºæ™¯</td><td style="text-align:center;">OLTP/OLAP</td><td style="text-align:center;">å†…å­˜è¡¨/ç¼“å­˜</td></tr></tbody></table><h3 id="_5-å®é™…ä¼˜åŒ–æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_5-å®é™…ä¼˜åŒ–æ¡ˆä¾‹"><span>5. å®é™…ä¼˜åŒ–æ¡ˆä¾‹</span></a></h3><p><strong>é—®é¢˜</strong>ï¼šæŸç”µå•†å¹³å°å•†å“è¡¨æŸ¥è¯¢ç¼“æ…¢</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- åŸç»“æ„</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> products</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BIGINT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> PRIMARY KEY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    name</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> VARCHAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    category_id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    price </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DECIMAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- ä¼˜åŒ–æ–¹æ¡ˆ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> products </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ADD</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> idx_category_price (category_id, price),</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ADD</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> idx_name (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æŸ¥è¯¢ä¼˜åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> products </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> category_id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ORDER BY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> price </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DESC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">LIMIT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- ç°åœ¨å¯ä»¥åˆ©ç”¨è”åˆç´¢å¼•ç›´æ¥å®šä½</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ•ˆæœ</strong>ï¼š</p><ul><li>æŸ¥è¯¢æ—¶é—´ä»1200msé™è‡³15ms</li><li>ç£ç›˜I/Oå‡å°‘80%</li><li>å†…å­˜ç¼“å­˜å‘½ä¸­ç‡æå‡è‡³95%</li></ul><h2 id="ä¸‰ã€äº‹åŠ¡æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€äº‹åŠ¡æœºåˆ¶"><span>ä¸‰ã€äº‹åŠ¡æœºåˆ¶</span></a></h2><h3 id="_1-acidç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#_1-acidç‰¹æ€§"><span>1. ACIDç‰¹æ€§</span></a></h3><table><thead><tr><th style="text-align:center;">ç‰¹æ€§</th><th style="text-align:center;">ä¿è¯æœºåˆ¶</th><th style="text-align:center;">å®ç°åŸç†</th></tr></thead><tbody><tr><td style="text-align:center;">åŸå­æ€§</td><td style="text-align:center;">Undo Log</td><td style="text-align:center;">å›æ»šæœªæäº¤äº‹åŠ¡</td></tr><tr><td style="text-align:center;">éš”ç¦»æ€§</td><td style="text-align:center;">é”/MVCC</td><td style="text-align:center;">æ§åˆ¶å¹¶å‘è®¿é—®</td></tr><tr><td style="text-align:center;">æŒä¹…æ€§</td><td style="text-align:center;">Redo Log</td><td style="text-align:center;">æ•…éšœæ¢å¤</td></tr><tr><td style="text-align:center;">ä¸€è‡´æ€§</td><td style="text-align:center;">ä»¥ä¸Šä¸‰è€…å…±åŒä¿è¯</td><td style="text-align:center;">ä¸šåŠ¡è§„åˆ™çº¦æŸ</td></tr></tbody></table><h3 id="_2-äº‹åŠ¡æ§åˆ¶è¯­å¥" tabindex="-1"><a class="header-anchor" href="#_2-äº‹åŠ¡æ§åˆ¶è¯­å¥"><span>2. äº‹åŠ¡æ§åˆ¶è¯­å¥</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BEGIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å¼€å¯äº‹åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">COMMIT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;                   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æäº¤äº‹åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ROLLBACK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;                 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å›æ»šäº‹åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SAVEPOINT åç§°;           </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- åˆ›å»ºä¿å­˜ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ROLLBACK</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> åç§°;         </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å›æ»šåˆ°ä¿å­˜ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">RELEASE SAVEPOINT åç§°;   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- é‡Šæ”¾ä¿å­˜ç‚¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-éš”ç¦»çº§åˆ«å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#_3-éš”ç¦»çº§åˆ«å¯¹æ¯”"><span>3. éš”ç¦»çº§åˆ«å¯¹æ¯”</span></a></h3><table><thead><tr><th style="text-align:center;">éš”ç¦»çº§åˆ«</th><th style="text-align:center;">è„è¯»</th><th style="text-align:center;">ä¸å¯é‡å¤è¯»</th><th style="text-align:center;">å¹»è¯»</th><th style="text-align:center;">å®ç°æœºåˆ¶</th></tr></thead><tbody><tr><td style="text-align:center;">READ UNCOMMITTED</td><td style="text-align:center;">å¯èƒ½</td><td style="text-align:center;">å¯èƒ½</td><td style="text-align:center;">å¯èƒ½</td><td style="text-align:center;">æ— é˜²æŠ¤</td></tr><tr><td style="text-align:center;">READ COMMITTED</td><td style="text-align:center;">ä¸å¯èƒ½</td><td style="text-align:center;">å¯èƒ½</td><td style="text-align:center;">å¯èƒ½</td><td style="text-align:center;">MVCCå¿«ç…§è¯»</td></tr><tr><td style="text-align:center;">REPEATABLE READ</td><td style="text-align:center;">ä¸å¯èƒ½</td><td style="text-align:center;">ä¸å¯èƒ½</td><td style="text-align:center;">å¯èƒ½*</td><td style="text-align:center;">MVCC+é—´éš™é”</td></tr><tr><td style="text-align:center;">SERIALIZABLE</td><td style="text-align:center;">ä¸å¯èƒ½</td><td style="text-align:center;">ä¸å¯èƒ½</td><td style="text-align:center;">ä¸å¯èƒ½</td><td style="text-align:center;">å®Œå…¨ä¸²è¡ŒåŒ–</td></tr></tbody></table><div class="hint-container tip"><p class="hint-container-title">å…³äº <strong>REPEATABLE READ</strong> å’Œå¹»è¯»</p><p><strong>MySQL</strong> çš„ <strong>InnoDB</strong> åœ¨ <strong>REPEATABLE READ</strong> éš”ç¦»çº§åˆ«ä¸‹ï¼Œé€šè¿‡ <strong>é—´éš™é”</strong> è§£å†³äº†éƒ¨åˆ†å¹»è¯»ï¼Œä½†æ²¡æœ‰å®Œå…¨è§£å†³å¿«ç…§è¯»ä¸‹çš„å¹»è¯»é—®é¢˜</p><p>å¯ä»¥åšè¿™ä¸ªå®éªŒï¼š</p><ol><li>å½“å‰DBå·²æœ‰id 5, 10, 15ä¸‰æ¡æ•°æ®ã€‚</li><li>äº‹åŠ¡AæŸ¥è¯¢id &lt; 10çš„æ•°æ®ï¼Œå¯ä»¥æŸ¥å‡ºä¸€è¡Œè®°å½•id = 5</li><li>äº‹åŠ¡Bæ’å…¥id = 6çš„æ•°æ®</li><li>äº‹åŠ¡Aå†æŸ¥è¯¢id &lt; 10çš„æ•°æ®ï¼Œå¯ä»¥æŸ¥å‡ºä¸€è¡Œè®°å½•id = 5ï¼ŒæŸ¥ä¸å‡ºid = 6çš„æ•°æ®ï¼ˆè¯»åœºæ™¯ï¼Œè§£å†³äº†å¹»è¯»ï¼‰</li><li>äº‹åŠ¡Aå¯ä»¥æ›´æ–°/åˆ é™¤id = 6çš„æ•°æ®ï¼Œä¸èƒ½æ’å…¥id = 6çš„æ•°æ®ï¼ˆå†™åœºæ™¯ï¼Œå¹»è¯»ä¸å½»åº•ï¼‰</li></ol><h4 id="å®éªŒåœºæ™¯å¤ç°" tabindex="-1"><a class="header-anchor" href="#å®éªŒåœºæ™¯å¤ç°"><span>å®éªŒåœºæ™¯å¤ç°</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- åˆå§‹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> test </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">15</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BEGIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> test </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- çœ‹åˆ°id=5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                -- äº‹åŠ¡B</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                BEGIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> test </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                COMMIT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> test </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- ä»åªçœ‹åˆ°id=5ï¼ˆå¿«ç…§è¯»é˜²å¹»è¯»ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- ä½†å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> test </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SET</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> val</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- èƒ½æ›´æ–°&quot;å¹»å½±è¡Œ&quot;ï¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DELETE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> test </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;       </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- èƒ½åˆ é™¤&quot;å¹»å½±è¡Œ&quot;ï¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œ**MySQL **è™½ç„¶é€šè¿‡ <strong>MVCC</strong> çš„ç‰ˆæœ¬å·æ¥è§£å†³äº†è¯»åœºæ™¯ä¸‹çš„å¹»è¯»ï¼Œä½†å¯¹äºä¸Šé¢ <strong>ç¬¬5æ­¥</strong> é‚£ç§å†™åœºæ™¯çš„æƒ…å†µï¼Œå…¶å®æ˜¯æ— èƒ½ä¸ºåŠ›çš„ï¼Œå› ä¸º <strong>MVCC</strong> æ¯•ç«Ÿæ˜¯æ— é”å®ç°ã€‚</p><h5 id="mysqlé˜²å¹»è¯»æœºåˆ¶çš„ä¸¤é¢æ€§" tabindex="-1"><a class="header-anchor" href="#mysqlé˜²å¹»è¯»æœºåˆ¶çš„ä¸¤é¢æ€§"><span>MySQLé˜²å¹»è¯»æœºåˆ¶çš„ä¸¤é¢æ€§</span></a></h5><table><thead><tr><th style="text-align:center;">é˜²æŠ¤ç±»å‹</th><th style="text-align:center;">æœºåˆ¶</th><th style="text-align:center;">æ•ˆæœ</th><th style="text-align:center;">å±€é™æ€§</th></tr></thead><tbody><tr><td style="text-align:center;"><strong>è¯»é˜²æŠ¤</strong></td><td style="text-align:center;">MVCCå¿«ç…§</td><td style="text-align:center;">åŒä¸€äº‹åŠ¡å†…ç›¸åŒæŸ¥è¯¢è¿”å›ä¸€è‡´ç»“æœ</td><td style="text-align:center;">ä»…é€‚ç”¨äºSELECTæŸ¥è¯¢</td></tr><tr><td style="text-align:center;"><strong>å†™é˜²æŠ¤</strong></td><td style="text-align:center;">é—´éš™é”</td><td style="text-align:center;">é˜»æ­¢å…¶ä»–äº‹åŠ¡æ’å…¥é—´éš™æ•°æ®</td><td style="text-align:center;">åªåœ¨ä½¿ç”¨é”æ“ä½œæ—¶ç”Ÿæ•ˆ</td></tr></tbody></table><h5 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§-åŠè§£å†³-çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§-åŠè§£å†³-çŠ¶æ€"><span>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§&quot;åŠè§£å†³&quot;çŠ¶æ€ï¼Ÿ</span></a></h5><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŠ€æœ¯æ ¹æºï¼š MVCCç®€åŒ–å®ç°åŸç†</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> InnoDB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.version_chain </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å­˜å‚¨æ‰€æœ‰ç‰ˆæœ¬æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> transaction_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # åªè¯»å–ç‰ˆæœ¬å·&lt;=äº‹åŠ¡IDä¸”å·²æäº¤çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [v </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> v </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.version_chain </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">               if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> v.version </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> transaction_id </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">               and</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> v.committed]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> transaction_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å†™å…¥æ—¶ä¸æ£€æŸ¥å…¶ä»–äº‹åŠ¡çš„å¿«ç…§è§†å›¾</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.version_chain.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">NewVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(transaction_id))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ol><li>è¯»æ“ä½œåŸºäºäº‹åŠ¡å¼€å§‹æ—¶çš„ <strong>ReadView</strong></li><li>å†™æ“ä½œåŸºäºå½“å‰æœ€æ–°æ•°æ®</li><li>è¿™ç§è¯»å†™åˆ†ç¦»çš„è®¾è®¡å¯¼è‡´äº†ç°è±¡ä¸ä¸€è‡´</li></ol><h5 id="ç”Ÿäº§ç¯å¢ƒè§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#ç”Ÿäº§ç¯å¢ƒè§£å†³æ–¹æ¡ˆ"><span>ç”Ÿäº§ç¯å¢ƒè§£å†³æ–¹æ¡ˆ</span></a></h5><ul><li><p><strong>æ–¹æ¡ˆ1ï¼š</strong> åç»­è¦å¯¹æ•°æ®è¿›è¡Œå†™æ“ä½œï¼Œå¼ºåˆ¶ä½¿ç”¨é”æŸ¥è¯¢</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å®‰å…¨å†™æ³•ï¼ˆå½»åº•é˜²å¹»è¯»ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> table</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> condition </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ–¹æ¡ˆ2ï¼š</strong> ä¹è§‚é”æ§åˆ¶</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Pythonç¤ºä¾‹ï¼ˆä½¿ç”¨ç‰ˆæœ¬å·ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">row </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;SELECT id, version FROM table WHERE id=1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">fetchone</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¸šåŠ¡å¤„ç†...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">affected </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;UPDATE table SET value=?, version=version+1 WHERE id=? AND version=?&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    [new_value, row.id, row.version]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> affected.rowcount </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    raise</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å¹¶å‘ä¿®æ”¹å†²çª&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ–¹æ¡ˆ3ï¼š</strong> åˆç†è®¾è®¡äº‹åŠ¡</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* å¥½çš„å®è·µ */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BEGIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æ‰€æœ‰æŸ¥è¯¢éƒ½åŠ é”</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ...;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">COMMIT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* å±é™©å®è·µ */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BEGIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ...; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- ä¸åŠ é”çš„å¿«ç…§è¯»</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ...;        </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å¯èƒ½æ“ä½œå¹»å½±è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">COMMIT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="ä¸ºä»€ä¹ˆæ•¢ç”¨read-committed" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆæ•¢ç”¨read-committed"><span>ä¸ºä»€ä¹ˆæ•¢ç”¨READ COMMITTEDï¼Ÿ</span></a></h3><ol><li><p><strong>æœ‰è¡¥å¿æªæ–½</strong>ï¼š</p><p>ç›‘æ§ç³»ç»Ÿå®æ—¶æ£€æµ‹å¼‚å¸¸æ•°æ®</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¼ªä»£ç ï¼šå®šæœŸæ ¡éªŒæ•°æ®ä¸€è‡´æ€§</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> consistency_check</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> db.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">transaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">isolation</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;READ COMMITTED&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> tx:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        data1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> tx.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;SELECT COUNT(*) FROM orders&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ä¸šåŠ¡å¤„ç†...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        data2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> tx.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;SELECT COUNT(*) FROM orders&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> data1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> data2:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">            alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å‘ç°ä¸å¯é‡å¤è¯»ç°è±¡&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å…³é”®æ“ä½œä½¿ç”¨æ˜¾å¼é”</li><li>é€šè¿‡ä¸šåŠ¡é€»è¾‘è®¾è®¡è§„é¿é—®é¢˜</li></ul></li><li><p><strong>ç†è§£æœ¬è´¨ï¼š</strong></p><p><strong>MySQL</strong> çš„ <strong>RR</strong> æ˜¯&quot;80åˆ†è§£å†³æ–¹æ¡ˆ&quot;ï¼Œ<strong>ä¸æ˜¯100% é˜²å¹»è¯»</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¥½çš„ä»£ç æ³¨é‡Šç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> update_inventory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">item_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;&quot;&quot;åº“å­˜æ›´æ–°æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    æ³¨æ„ï¼šä½¿ç”¨SELECT FOR UPDATEç¡®ä¿é˜²å¹»è¯»</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> transaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">isolation</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;REPEATABLE READ&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        row </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> session.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;SELECT * FROM inventory WHERE item_id=? FOR UPDATE&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            [item_id]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        )</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ...ä¸šåŠ¡é€»è¾‘</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>è¿™ç§è®¾è®¡å…¶å®æ˜¯å·¥ç¨‹ä¸Šçš„æƒè¡¡â€”â€”åœ¨ä¿è¯å¤§éƒ¨åˆ†åœºæ™¯å¯ç”¨çš„å‰æä¸‹ï¼ŒæŠŠå¤æ‚æƒ…å†µäº¤ç»™å¼€å‘è€…æ˜¾å¼å¤„ç†ï¼Œæ—¢è·å¾—äº†æ€§èƒ½æå‡ï¼ŒåˆæŠŠæ§åˆ¶æƒäº¤ç»™äº†æœ€äº†è§£ä¸šåŠ¡çš„äººã€‚</p><h3 id="_4-mvccæœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_4-mvccæœºåˆ¶"><span>4. MVCCæœºåˆ¶</span></a></h3><ul><li><strong>ç‰ˆæœ¬é“¾</strong>ï¼šé€šè¿‡<code>DB_TRX_ID</code>å’Œ<code>DB_ROLL_PTR</code>æ„å»º</li><li>ReadViewï¼šåŒ…å«ï¼š <ul><li><code>m_ids</code>ï¼šæ´»è·ƒäº‹åŠ¡åˆ—è¡¨</li><li><code>min_trx_id</code>ï¼šæœ€å°æ´»è·ƒäº‹åŠ¡ID</li><li><code>max_trx_id</code>ï¼šé¢„åˆ†é…æœ€å¤§äº‹åŠ¡ID</li><li><code>creator_trx_id</code>ï¼šåˆ›å»ºè¯¥ReadViewçš„äº‹åŠ¡ID</li></ul></li></ul><p><strong>ä¸åŒéš”ç¦»çº§åˆ«çš„ReadViewç”Ÿæˆç­–ç•¥</strong>ï¼š</p><ul><li>READ COMMITTEDï¼šæ¯æ¬¡SELECTç”Ÿæˆæ–°ReadView</li><li>REPEATABLE READï¼šç¬¬ä¸€æ¬¡SELECTç”ŸæˆReadViewåå¤ç”¨</li></ul><h2 id="å››ã€é”æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#å››ã€é”æœºåˆ¶"><span>å››ã€é”æœºåˆ¶</span></a></h2><h3 id="_1-é”ç±»å‹çŸ©é˜µ" tabindex="-1"><a class="header-anchor" href="#_1-é”ç±»å‹çŸ©é˜µ"><span>1. é”ç±»å‹çŸ©é˜µ</span></a></h3><table><thead><tr><th style="text-align:center;">é”ç±»å‹</th><th style="text-align:center;">Xé”(æ’ä»–)</th><th style="text-align:center;">Sé”(å…±äº«)</th><th style="text-align:center;">ISé”(æ„å‘å…±äº«)</th><th style="text-align:center;">IXé”(æ„å‘æ’ä»–)</th></tr></thead><tbody><tr><td style="text-align:center;">Xé”</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td></tr><tr><td style="text-align:center;">Sé”</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å†²çª</td></tr><tr><td style="text-align:center;">ISé”</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å…¼å®¹</td></tr><tr><td style="text-align:center;">IXé”</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å…¼å®¹</td></tr></tbody></table><h3 id="_2-innodbé”ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_2-innodbé”ç®—æ³•"><span>2. InnoDBé”ç®—æ³•</span></a></h3><table><thead><tr><th style="text-align:center;">é”ç®—æ³•</th><th style="text-align:center;">é”å®šèŒƒå›´</th><th style="text-align:center;">è§£å†³ä»€ä¹ˆé—®é¢˜</th></tr></thead><tbody><tr><td style="text-align:center;">Record Lock</td><td style="text-align:center;">å•ä¸ªè¡Œè®°å½•</td><td style="text-align:center;">ä¿è¯è¡Œæ›´æ–°å®‰å…¨</td></tr><tr><td style="text-align:center;">Gap Lock</td><td style="text-align:center;">è®°å½•ä¹‹é—´çš„é—´éš™</td><td style="text-align:center;">é˜²æ­¢å¹»è¯»</td></tr><tr><td style="text-align:center;">Next-Key Lock</td><td style="text-align:center;">è®°å½•+å‰é—´éš™</td><td style="text-align:center;">é˜²æ­¢å¹»è¯»(é»˜è®¤)</td></tr></tbody></table><h3 id="_3-ä¸åŒéš”ç¦»çº§åˆ«çš„é”è¡Œä¸º" tabindex="-1"><a class="header-anchor" href="#_3-ä¸åŒéš”ç¦»çº§åˆ«çš„é”è¡Œä¸º"><span>3. ä¸åŒéš”ç¦»çº§åˆ«çš„é”è¡Œä¸º</span></a></h3><h4 id="read-committed" tabindex="-1"><a class="header-anchor" href="#read-committed"><span>READ COMMITTEDï¼š</span></a></h4><ul><li>ä»…ä½¿ç”¨Record Lock</li><li>å¯èƒ½å‡ºç°å¹»è¯»</li></ul><h4 id="repeatable-read" tabindex="-1"><a class="header-anchor" href="#repeatable-read"><span>REPEATABLE READï¼š</span></a></h4><ul><li>é»˜è®¤ä½¿ç”¨Next-Key Lock</li><li>åŸºæœ¬è§£å†³å¹»è¯»é—®é¢˜</li><li>å…¨è¡¨æ‰«æä¼šé”å…¨è¡¨</li></ul><h3 id="_4-ä¹è§‚é”ä¸æ‚²è§‚é”å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#_4-ä¹è§‚é”ä¸æ‚²è§‚é”å¯¹æ¯”"><span>4. ä¹è§‚é”ä¸æ‚²è§‚é”å¯¹æ¯”</span></a></h3><table><thead><tr><th style="text-align:center;">ç‰¹æ€§</th><th style="text-align:center;">æ‚²è§‚é”</th><th style="text-align:center;">ä¹è§‚é”</th></tr></thead><tbody><tr><td style="text-align:center;">åŸç†</td><td style="text-align:center;">å…ˆåŠ é”åè®¿é—®</td><td style="text-align:center;">ç‰ˆæœ¬å·/æ—¶é—´æˆ³æ ¡éªŒ</td></tr><tr><td style="text-align:center;">å®ç°</td><td style="text-align:center;"><code>SELECT...FOR UPDATE</code></td><td style="text-align:center;">åº”ç”¨å±‚å®ç°</td></tr><tr><td style="text-align:center;">ä¼˜ç‚¹</td><td style="text-align:center;">ä¿è¯å¼ºä¸€è‡´æ€§</td><td style="text-align:center;">é«˜å¹¶å‘æ€§èƒ½</td></tr><tr><td style="text-align:center;">ç¼ºç‚¹</td><td style="text-align:center;">é”å¼€é”€å¤§</td><td style="text-align:center;">é‡è¯•æˆæœ¬é«˜</td></tr><tr><td style="text-align:center;">é€‚ç”¨</td><td style="text-align:center;">å†™å¤šè¯»å°‘</td><td style="text-align:center;">è¯»å¤šå†™å°‘</td></tr></tbody></table><p><strong>ä¹è§‚é”å®ç°ç¤ºä¾‹</strong>ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éœ€è¦è®¾ç½®éš”ç¦»çº§åˆ«ä¸ºREAD COMMITTED</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@transaction</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">atomic</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> update_inventory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æœ€å¤§é‡è¯•5æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        product </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Product.objects.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        old_stock </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> product.stock</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        new_stock </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> old_stock </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        affected </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Product.objects.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">filter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">            id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stock</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">old_stock</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stock</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">new_stock)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> affected: </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            break</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # æ›´æ–°æˆåŠŸ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        raise</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;æ›´æ–°å¤±è´¥&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="äº”ã€sqlä¼˜åŒ–å»ºè®®" tabindex="-1"><a class="header-anchor" href="#äº”ã€sqlä¼˜åŒ–å»ºè®®"><span>äº”ã€SQLä¼˜åŒ–å»ºè®®</span></a></h2><ol><li><p><strong>å­—æ®µè®¾è®¡</strong>ï¼š</p><ul><li>ä½¿ç”¨åˆé€‚çš„æ•°æ®ç±»å‹</li><li>å°½é‡è®¾ç½®NOT NULL</li><li>æšä¸¾ç±»å‹ä½¿ç”¨ENUM</li></ul></li><li><p><strong>æŸ¥è¯¢ä¼˜åŒ–</strong>ï¼š</p><ul><li>ç”¨JOINä»£æ›¿å­æŸ¥è¯¢</li><li>ç”¨UNIONä»£æ›¿ä¸´æ—¶è¡¨</li><li>åˆç†ä½¿ç”¨ç´¢å¼•</li></ul></li><li><p><strong>äº‹åŠ¡ä¼˜åŒ–</strong>ï¼š</p><ul><li>ç¼©çŸ­äº‹åŠ¡æ‰§è¡Œæ—¶é—´</li><li>é¿å…é•¿äº‹åŠ¡</li><li>åˆç†è®¾ç½®éš”ç¦»çº§åˆ«</li></ul></li><li><p><strong>é”ä¼˜åŒ–</strong>ï¼š</p><ul><li>å°½é‡ä½¿ç”¨è¡Œé”è€Œéè¡¨é”</li><li>è®¿é—®é‡å¤§çš„ç³»ç»Ÿè€ƒè™‘READ COMMITTED</li><li>å…³é”®ä¸šåŠ¡ä½¿ç”¨SERIALIZABLE</li></ul><p>ä¸‰ã€ç´¢å¼•ï¼š<br> é¡µç›®å½•ï¼š<br> æœ¬è´¨æ˜¯æ ‘ï¼Œå³ç”¨ä¸€ä¸ªé¡µ åˆ©ç”¨äºŒåˆ†æ³•è¿›è¡Œæ¥è®°å½•å„æ•°æ®çš„åœ°å€ï¼Œæ¯ä¸€é¡µä¼šæœ‰ä¸»é”®ï¼Œå¹¶æŠŠä¸»é”®æå‡ºæ¥ä½œä¸ºç´¢å¼•éƒ¨åˆ†</p><pre><code>           é¡µå·100                       é¡µå·200
         1 -&gt;  1111a                   5 -&gt; 5555e
               2222b       -&gt;               6666f
         3 -&gt;  3333c...                7 -&gt; 7777g ...

 ç›®å½•é¡µ:
     é¢å¤–æå‡ºä¸€ä¸ªé¡µï¼Œç”¨æ¥å­˜å‚¨é¡µå·ï¼Œä½†æ¯ä¸€é¡µçš„é¡µå·å¯ä¸æ˜¯ç›¸é‚»çš„ï¼Œåè€Œä¼šå†ç”¨ä¸€ä¸ª key-value å»å­˜å‚¨é¡µå·
                 1                          5            --  ä¸»é”®
                100                        200           --  æŒ‡é’ˆ
                 |                          |
              é¡µå·100                    é¡µå·200          --  æŒ‡é’ˆæŒ‡å‘çš„è¡Œæ•°æ®

     keyï¼šæ¯é¡µä¸­æœ€å°çš„å€¼ï¼Œ åˆ©ç”¨ä¸»é”®éƒ½æ˜¯é€’å¢é¡ºåºæ’åˆ—
     valueï¼šå¯¹åº”çš„é¡µå·

 å› æ­¤å°±æ˜¯ä¸€ä¸ªB+æ ‘ç»“æ„(æ ¹èŠ‚ç‚¹çš„å…ƒç´ æ€»ä¼šç•™ä¸€ä¸ªåœ¨å¶å­èŠ‚ç‚¹ä¸Š) ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥å­˜å¤šä¸ªå…ƒç´ 
                              0003 0005
          |                       |                         |
        0002                    0004                       0005
     |         |           |            |              |            |
 0001   -&gt;    0002   -&gt;   0003    -&gt;   0004   -&gt;    0005    -&gt;    0006 0007

 å¶å­èŠ‚ç‚¹ï¼šå­˜æ•°æ®
 éå¶å­èŠ‚ç‚¹ï¼šå­˜ä¸»é”® + æŒ‡é’ˆ

 æ‰€ä»¥æ’å…¥ç´¢å¼•çš„è¿‡ç¨‹ä¸­æ˜¯ç”ŸæˆB+æ ‘çš„è¿‡ç¨‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰åºçš„åŸå› ï¼Œæ˜¯å­˜åœ¨äº†B+æ ‘çš„å¶å­èŠ‚ç‚¹é‡Œ

 æ³¨ï¼š
     1.ä¸»é”®IDä¸é€‚åˆå¤ªé•¿ï¼Œè‹¥è¿‡äºé•¿çš„è¯ä¸€é¡µæ”¾ä¸ä¸‹ï¼Œå†ä¼šå°†æ ‘çš„é«˜åº¦æ‹‰é•¿ï¼Œæ ‘çš„é«˜åº¦è¶Šé«˜ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å°±ä¼šä¸‹é™

     2.mysql åˆ›å»ºè¿‡ç¨‹ç•¥å¾®ä¸åŒï¼Œä»–æ˜¯å½“æ‰§è¡Œåˆ›å»ºè¡¨å‘½ä»¤æ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªé¡µï¼Œå½“ä¸€ä¸ªé¡µè£…ä¸ä¸‹åï¼Œä¸æ˜¯åœ¨åˆ›å»ºç¬¬äºŒä¸ªé¡µï¼Œ
       è€Œæ˜¯å°†ç¬¬ä¸€ä¸ªé¡µcopyä¸€ä»½ï¼Œåˆ›å»ºç¬¬äºŒä¸ªé¡µï¼Œå†å°†ä¹‹å‰çš„ç¬¬ä¸€é¡µæ”¹ä¸ºç›®å½•é¡µ

     3.B+æ ‘çš„ä¼˜åŠ¿ï¼Œç›¸æ¯”äºAVLæ ‘ï¼ˆäºŒå‰ï¼‰ B+æ ‘çš„ä¼˜åŠ¿åœ¨äºä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å¤šä¸ªå…ƒç´ ï¼Œå› æ­¤ä¼šæ¯”AVLæ ‘é«˜åº¦è¦ä½ï¼Œå› æ­¤æŸ¥æ‰¾
       æ—¶çš„æ‰§è¡Œæ•ˆç‡è¦ä½ã€‚è™½ç„¶æ•°æ®å†—ä½™äº†ï¼ŒæŸ¥æ‰¾ = ç­‰äºçš„æ¡ä»¶ä¸æ˜æ˜¾ï¼Œä½†æŸ¥æ‰¾&gt; &lt; æ¡ä»¶æ—¶åˆ™ä¸åŒ

       ä¾‹å¦‚ï¼š æŸ¥ &gt; 0002 çš„æ•°æ®ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ç´¢å¼•ï¼ˆ0002åçš„é“¾è¡¨æŒ‡é’ˆï¼‰æå–æ‰€æœ‰æ•°æ®ï¼Œè€ŒAVLæ ‘è¦å…ˆæ‰¾å‡ºå³å­æ ‘
             çš„èŠ‚ç‚¹ï¼Œä¹‹åè¿˜è¦å›å½’çˆ¶èŠ‚ç‚¹ï¼Œå±‚å±‚éå†  ï¼ˆSQLèŒƒå›´æŸ¥è¯¢ï¼‰

       æ®è¯´ B+æ ‘é«˜åº¦ç­‰äº2 çš„æ—¶å€™ï¼Œå¤§çº¦å¯å­˜ 20000å¤šæ¡æ•°æ®ï¼Œ B+æ ‘é«˜åº¦ç­‰äº3 çš„æ—¶å€™ï¼Œ å¯ä»¥å­˜ 2åƒä¸‡å¤šæ¡æ•°æ®

       å‡è®¾æ¨ç®—ï¼šä¸»é”®ç”¨bigintç±»å‹ å 8å­—èŠ‚ æŒ‡é’ˆå 6ä¸ªå­—èŠ‚ å› æ­¤åœ¨ä¸€é¡µä¸­ï¼Œå¯ä»¥å­˜å¤šå°‘ä¸ªéå¶å­èŠ‚ç‚¹
                16kb/(8+6)=1170.28... å¯ä»¥å­˜1170å¯¹ é”®å€¼å¯¹ï¼ˆä»£è¡¨ä¸‹é¢æœ‰å¤šå°‘ä¸ªå¶å­èŠ‚ç‚¹ï¼‰

                æ­¤æ—¶å‡è®¾ä¸€è¡Œæ•°æ®ä¸º1KBï¼Œä¸€é¡µå­˜16æ¡æ•°æ®ï¼Œé‚£ä¹ˆé«˜åº¦ä¸º2çš„æƒ…å†µä¸‹ å¯å­˜ 1170 * 16 = 18724 æ¡æ•°æ®
                å› æ­¤ç”¨B+æ ‘æ‰¾æœ€å¤šæ‰¾ä¸¤æ¬¡å°±èƒ½åœ¨2åƒå¤šä¸‡æ¡æ•°æ®ä¸­æ‰¾åˆ°é‚£ä¸ªé¡µ


 è¾…åŠ©ç´¢å¼•ï¼š
     å‡ºäº†ä¸»é”®ç´¢å¼•ä¹‹å¤–ï¼Œåˆ›å»ºçš„æ™®é€šç´¢å¼•ã€‚å¥½å¤„åœ¨äºæ›´æ–¹ä¾¿æŸ¥æ‰¾ï¼Œä½†èµ°è¾…åŠ©ç´¢å¼•ä¼šèµ°ä¸¤æ¬¡ï¼Œå› ä¸ºå»ºç«‹è¾…åŠ©ç´¢å¼•æ„å‘³ç€å…¨è¡¨
     åˆé‡æ–°æ„å»ºäº†ä¸€é¢—B+æ ‘ï¼Œå­èŠ‚ç‚¹å­˜çš„æ˜¯ä¸»é”®ï¼Œèµ°è¾…åŠ©ç´¢å¼•ä¼šå…ˆæ‰¾åˆ°ä¸»é”®åœ¨å»ä¸»é”®è¡¨ä¸­æ‰¾æ•°æ®ã€‚
     ä¾‹ï¼š
         create index idx_t1_bcd on t1(b,c,d);
         åˆ›å»ºåä¸ºidx_t1_bcdçš„ç´¢å¼•ï¼Œbcdä¸‰åˆ—å¿…é¡»å”¯ä¸€ä¸”ä¼šè¿›è¡Œæ’åºï¼Œå¹¶å†æ¬¡ç”Ÿæˆä¸€ä¸ªå·²bcdä¸º é”®çš„B+æ ‘

     æŸ¥æ‰¾æ–¹å¼ï¼š
     1.è¾…åŠ©ç´¢å¼•+ å›è¡¨
     2.å…¨è¡¨æ‰«æ

     ä½†å½“ä¸€ä¸ªæ¯”è¾ƒæç«¯çš„æƒ…å†µï¼Œèµ°è¾…åŠ©ç´¢å¼•å§å…¨è¡¨çš„ä¸»é”®éƒ½æ‰¾äº†ä¸€éï¼Œæ­¤æ—¶è¿˜ä¸å¦‚èµ°å…¨è¡¨ç´¢å¼•æ¥å¾—å¿«ï¼š
     create index idx_t1_b on t1(b);   -- æ­¤æ—¶åªå»ºç«‹ä¸€ä¸ªbçš„ç´¢å¼•ï¼ˆä¸Šæ–‡ç´¢å¼•æ— ï¼‰
     explain select * from t1 where b &gt; 0; æ­¤æ—¶ è‹¥èµ°è¾…åŠ©ç´¢å¼•è¿˜ä¸å¦‚èµ°ä¸»é”®å…¨è¡¨æ‰«ææ¥çš„å¿«
     å› ä¸º b &gt; 0 è¿™ä¸ªæ¡ä»¶å§ä¸»é”®ç´¢å¼•éƒ½æ‰¾äº†å‡ºæ¥ï¼Œåˆå»å…¨è¡¨ç´¢å¼•å†æ‰¾ä¸€éï¼Œè¿™å°±å¾ˆæ…¢ã€‚

     æœ€å·¦å‰ç¼€åŸåˆ™ï¼š
         å½“å»ºç«‹ bcd ä¸‰åˆ—çš„ç´¢å¼•æ—¶ï¼Œ
         explain select * from t1 where b = 1 and c = 1 and d = 1; -- å‘½ä¸­ç´¢å¼•
         explain select * from t1 where c = 1 and d = 1; -- æœªå‘½ä¸­

         è‹¥æ•°æ®ä» 111 åˆ° 644  *11 æ˜¯æ²¡æœ‰åŠæ³•è¿›è¡Œæ¯”è¾ƒçš„ï¼Œç¬¬ä¸€ä¸ªå€¼ä¸çŸ¥é“å› æ­¤æœªèµ°ç´¢å¼•
                                 111     644
                                 é¡µå·    é¡µå·
                         |                           |
                  111    235                     322     644

         explain select * from t1 where b like &#39;%101%&#39;;  -- æœªå‘½ä¸­ç´¢å¼•
         åŒä¸Š % åœ¨å¼€å¤´ä¹Ÿæ„å‘³ç€ ç¬¬ä¸€ä¸ªå€¼æ˜¯æ¨¡ç³Šçš„,å¼€å¤´å¯ä»¥æ˜¯å¤šä¸ª,è€Œ &#39;101%&#39; åˆ™å¯ä»¥

     æ³¨ï¼š
         1.ç”¨ä¸Šæ–‡çš„é“ç†ï¼Œè‹¥è¦æŸ¥æ‰¾å·².com ä¸ºåç¼€ç»“å°¾çš„ ç”¨ %comï¼Œåˆ™ä¼šå…¨è¡¨æ‰«æï¼Œ
             å¯ä»¥å°† www.baidu.com ã€www.google.com è¿™æ ·çš„ç½‘ç«™é€†åºå­˜å‚¨ï¼Œç„¶ååˆ©ç”¨ %moc è¿›è¡ŒæŸ¥æ‰¾
             åˆ™å¯ç›´æ¥å‘½ä¸­ç´¢å¼•

             select * from t1 order by b,c,d;  -- èµ°å…¨è¡¨
             select b from t1 order by b,c,d;  -- å‘½ä¸­ç´¢å¼•
             è¿™æ˜¯å› ä¸º åªæ‰¾ä¸€ä¸ªbå­—æ®µï¼Œbå­—æ®µæœ¬èº«æœ‰ç´¢å¼•ï¼Œå› æ­¤å°±æ— é¡»å†èµ°ä¸€æ¬¡å…¨è¡¨äº†


         2.NULL å€¼åœ¨MYSQLä¸­å°äºä»»ä½•å€¼

         3.è‹¥å…¶ä»–ç´¢å¼•æœ‰ç›¸åŒçš„æ•°æ®ï¼ˆä¸æ˜¯å”¯ä¸€ç´¢å¼•ï¼‰ï¼Œåˆ™ç³»ç»Ÿä¼šé»˜è®¤å°†ä¸»é”®ç´¢å¼•ä¹ŸåŠ å…¥B+æ ‘çš„æ„æˆä¸­ï¼Œä¾¿äºåŒºåˆ†
</code></pre></li></ol><p>MYSQL äº‹åŠ¡ï¼š</p><pre><code>ä¸€ã€äº‹åŠ¡ï¼ˆACIDï¼‰
    åœºæ™¯ï¼šå°æ˜å‘å°èƒ–è½¬è´¦10å—é’±

    åŸå­æ€§ï¼šè½¬è´¦æ“ä½œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æ“ä½œï¼Œè¦ä¹ˆè½¬è´¦å¤±è´¥ï¼Œè¦ä¹ˆè½¬è´¦æˆåŠŸï¼Œä¸å¯èƒ½å­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è½¬äº†ä¸€åŠçš„è¿™ç§æƒ…å†µ
        æˆ‘ä»¬æŠŠè¦ä¹ˆå…¨åšè¦ä¹ˆä¸åšè¿™ç§çš„è§„åˆ™æˆä¸ºåŸå­æ€§è§„åˆ™

    éš”ç¦»æ€§ï¼š
        å¦ä¸€ä¸ªåœºæ™¯ï¼šå°æ˜å‘å°ç™½è½¬è´¦10å…ƒé’±
                   å°æ˜å‘å°èƒ–è½¬è´¦10å…ƒé’±
        éš”ç¦»æ€§è¡¨ç¤ºä¸Šé¢çš„ä¸¤ä¸ªæ“ä½œæ˜¯ä¸èƒ½ç›¸äº’å½±å“çš„

    ä¸€è‡´æ€§ï¼š
        æ¯ä¸€æ¬¡è½¬è´¦å®Œæˆåï¼Œéƒ½éœ€è¦ä¿è¯æ•´ä¸ªç³»ç»Ÿä½™é¢ç­‰äºæ‰€æœ‰è´¦æˆ·çš„æ”¶å…¥å‡å»æ‰€æœ‰è´¦æˆ·çš„æ”¯å‡ºã€‚
        è‹¥ä¸éµå¾ªåŸå­æ€§ï¼Œä¹Ÿå°±æ˜¯å¦‚æœå°æ˜å‘å°èƒ–è½¬è´¦10å…ƒï¼Œä½†æ˜¯åªè½¬äº†ä¸€åŠï¼Œå°æ˜è´¦æˆ·ä¸Šå°‘äº†10å…ƒï¼Œå°èƒ–è´¦æˆ·ä¸Šæ²¡æœ‰å¢åŠ ï¼Œ
        è¿™å°±æ˜¯ä¸æ»¡è¶³ä¸€è‡´æ€§åŸåˆ™ã€‚
        åŒæ ·ä¸æ»¡è¶³éš”ç¦»æ€§ï¼Œä¹Ÿæœ‰å¯èƒ½ç ´åä¸€è‡´æ€§ã€‚å› æ­¤åŸå­æ€§å’Œéš”ç¦»æ€§éƒ½æ˜¯ä¿è¯æ»¡è¶³ä¸€è‡´æ€§çš„æ‰‹æ®µã€‚

        å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¡¨å»ºç«‹çº¦æŸæ¥ä¿è¯ä¸€è‡´æ€§ã€‚

    æŒä¹…æ€§ï¼š
        å¯¹äºè½¬è´¦çš„äº¤æ˜“è®°å½•ï¼Œéœ€è¦æ°¸ä¹…ä¿å­˜ã€‚

    äº‹åŠ¡çš„æ¦‚å¿µï¼š
        æŠŠéœ€è¦ä¿è¯åŸå­æ€§ã€éš”ç¦»æ€§ã€ä¸€è‡´æ€§ã€å’ŒæŒä¹…æ€§çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®åº“æ“ä½œç§°ä¹‹ä¸ºä¸€ä¸ªäº‹åŠ¡ã€‚


äºŒã€è‡ªåŠ¨æäº¤ï¼š
    mysql&gt; SHOW VARIABLES LIKE &#39;autocommit&#39;;   -- æ­£å¸¸æƒ…å†µä¸‹ï¼ŒMYSQLé»˜è®¤äº‹åŠ¡æ˜¯ON è‡ªåŠ¨æäº¤çš„

    è‡ªåŠ¨æäº¤æ„å‘³ç€ï¼š å½“å†™ä¸€ä¸ªupdateä¹‹ç±»çš„è¯­å¥æ—¶ï¼Œ
     - å®ƒä¼šå…ˆå¸®æˆ‘å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œ
     - å†å»æ‰§è¡Œæˆ‘å†™çš„SQL
     - å†å»æŠŠè¿™ä¸ªäº‹åŠ¡æäº¤ä¸Šå»

    1ã€å¼€å¯äº‹åŠ¡
        mysql&gt; BEGIN;  -- æ‰‹åŠ¨å¼€å¯ä¸€ä¸ªäº‹åŠ¡

        mysql&gt; START TRANSACTION;   -- å’ŒBEGINåŠŸæ•ˆç›¸åŒï¼Œéƒ½æ˜¯å¼€å¯ä¸€ä¸ªäº‹åŠ¡

        1.å½“å¼€å¯ä¸¤ä¸ªMYSQLå®¢æˆ·ç«¯æ˜¯ï¼Œå®¢æˆ·ç«¯1 æ‰§è¡Œè¯­å¥
        update t1 set c = 2 where  a = 1 ;  -- ç›®çš„æ˜¯æŠŠa = 1 è¿™è¡Œæ•°æ®çš„cå­—æ®µçš„å€¼æ”¹ä¸º 2

        2.æ­¤æ—¶åœ¨å®¢æˆ·ç«¯2 ä¸Šæ‰§è¡Œ
        select * from t1 where a = 1; -- å‘ç°å®¢æˆ·ç«¯2 ä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®å¹¶æ²¡æœ‰æ”¹å˜

        3.è¿™æ—¶åœ¨ å®¢æˆ·ç«¯1 æ‰§è¡Œ commit; æäº¤ä¸€ä¸‹ï¼Œå®¢æˆ·ç«¯2 ä¸­æ‰èƒ½çœŸæ­£æŸ¥åˆ°æ”¹åŠ¨åçš„æ•°æ®ã€‚
          ä½†å®¢æˆ·ç«¯1 åˆ™è‡ªå·±æ”¹çš„è‡ªå·±å¯ä»¥æŸ¥åˆ°ã€‚

        4.è‹¥æ­¤æ—¶å®¢æˆ·ç«¯1 ä¸Šæ‰§è¡Œrollback åˆ™ä¼šè¿›è¡Œå›æ»šï¼Œä¹‹å‰æ”¹åŠ¨çš„æ•°æ®åˆ™ä¼šæ”¹å›ã€‚
            æ³¨ï¼šrollback æ˜¯æˆ‘ä»¬ç¨‹åºå‘˜æ‰‹åŠ¨å»å›æ»šäº‹åŠ¡æ—¶æ‰å»ä½¿ç”¨çš„ï¼Œè‹¥äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°äº†æŸäº›é”™è¯¯è€Œæ— æ³•ç»§ç»­æ‰§è¡Œçš„
                è¯ï¼Œäº‹åŠ¡è‡ªèº«ä¼šå›æ»šã€‚

ä¸‰ã€éšå¼æäº¤ï¼š
    å½“ä½¿ç”¨ begin æˆ– start transaction å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œæˆ–è€…æŠŠç³»ç»Ÿå˜é‡autocommit çš„å€¼è®¾ç½®ä¸ºOFF æ—¶ï¼Œäº‹åŠ¡å°±ä¸ä¼šè¿›è¡Œè‡ªåŠ¨
    æäº¤ï¼Œä½†æ˜¯æˆ‘ä»¬è¾“å…¥äº†æŸäº›è¯­å¥ä¹‹åä¼šæ‚„æ‚„çš„æäº¤æ‰ï¼Œå°±åƒæˆ‘ä»¬è¾“å…¥äº†commit è¯­å¥ä¸€æ ·ï¼Œè¿™æ˜¯å› ä¸ºæŸäº›ç‰¹æ®Šçš„è¯­å¥è€Œå¯¼è‡´äº‹åŠ¡
    æäº¤çš„æƒ…å†µç§°ä¸ºéšå¼æäº¤ã€‚

    å¯¼è‡´éšå¼æäº¤çš„è¯­å¥åŒ…æ‹¬ï¼š
    - å®šä¹‰æˆ–ä¿®æ”¹æ•°æ®åº“å¯¹è±¡çš„æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆData definition language ç¼©å†™ï¼šDDLï¼‰æ•°æ®åº“å¯¹è±¡ â€”â€” æ˜¯æŒ‡æ•°æ®åº“ã€è¡¨ã€
      è§†å›¾ã€å­˜å‚¨è¿‡ç¨‹ã€ç­‰ç­‰è¿™äº›ä¸œè¥¿ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ createã€alterã€dropç­‰è¯­å¥å»ä¿®æ”¹è¿™äº›æ‰€è°“çš„æ•°æ®åº“å¯¹è±¡æ—¶ï¼Œå°±ä¼šéšå¼çš„
      æäº¤å‰è¾¹è¯­å¥æ‰€å±äºçš„äº‹åŠ¡ã€‚

    - éšå¼ä½¿ç”¨æˆ–ä¿®æ”¹mysql æ•°æ®åº“ä¸­çš„è¡¨; å½“æˆ‘ä»¬ä½¿ç”¨ alter user ã€create userã€drop userã€grantã€ rename userã€
      set password ç­‰è¯­å¥æ—¶ä¹Ÿä¼šéšå¼çš„æäº¤å‰è¾¹è¯­å¥æ‰€å±äºçš„äº‹åŠ¡ã€‚

    - äº‹åŠ¡æ§åˆ¶æˆ–å…³äºé”å®šçš„è¯­å¥ï¼šå½“æˆ‘ä»¬åœ¨ä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æäº¤æˆ–è€…å›æ»šæ—¶å°±åˆä½¿ç”¨start transaction æˆ–è€…begin å¼€å¯äº†
      å¦ä¸€ä¸ªäº‹åŠ¡æ—¶ï¼Œä¼šéšå¼çš„æäº¤ä¸Šä¸€ä¸ªäº‹åŠ¡ï¼Œæˆ–è€…å½“å‰çš„autocommit ç³»ç»Ÿå˜é‡ä¸ºOFFï¼Œæˆ‘ä»¬æ‰‹åŠ¨æŠŠå®ƒè°ƒä¸ºONæ—¶ï¼Œä¹Ÿä¼šéšå¼
      çš„æäº¤å‰è¾¹è¯­å¥æ‰€å±çš„äº‹åŠ¡ï¼Œæˆ–è€…ç”¨LOCK TABLESã€ UNLOCK TABLES ç­‰å…³äºé”å®šçš„è¯­å¥ä¹Ÿä¼šéšå¼çš„æäº¤å‰è¾¹çš„è¯­å¥æ‰€å±
      çš„äº‹åŠ¡ã€‚

    - åŠ è½½æ•°æ®çš„è¯­å¥ï¼šæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨LOAD DATA è¯­å¥æ¥æ‰¹é‡å¾€æ•°æ®åº“ä¸­å¯¼å…¥æ•°æ®æ—¶ï¼Œä¹Ÿä¼šéšå¼çš„æäº¤å‰è¾¹è¯­å¥æ‰€å±çš„äº‹åŠ¡ã€‚

    - å…¶ä»–çš„ä¸€äº›è¯­å¥ï¼šä½¿ç”¨analyze tableã€ cache indexã€ check tableã€flushã€ load index into cacheã€
      optimize tableã€ repair tableã€ reset ç­‰è¯­å¥ä¹Ÿä¼šéšå¼çš„æäº¤å‰è¾¹è¯­å¥æ‰€å±çš„äº‹åŠ¡ã€‚
      ï¼ˆæ›´æ–°æŸ¥è¯¢ä¼˜åŒ–å™¨çš„ç»Ÿè®¡æ•°æ®çš„å‘½ä»¤ï¼‰

å››ã€ä¿å­˜ç‚¹ï¼š
    mysql&gt; savepoint ä¿å­˜ç‚¹åç§°ï¼š

    - é¦–å…ˆï¼Œå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼š
      begin

    - ç„¶åæ‰§è¡Œæ›´æ”¹å‘½ä»¤ï¼š
      update t1 set c = 6 where a = 1;

    - å†æ‰§è¡Œä¿å­˜ç‚¹å‘½ä»¤ï¼š
      savepoint t123

    - å†æ”¹
      update t1 set c = 7 where a = 1;

    - æ‰§è¡Œå›æ»š
      rollback to t123;  -- rollback [WORK] to [savepoint] ä¿å­˜ç‚¹åç§°ï¼›
      è‹¥rollback åé¢ä¸è·Ÿéšä¿å­˜ç‚¹åç§°çš„è¯ï¼Œä¼šç›´æ¥å›æ»šåˆ°äº‹åŠ¡æ‰§è¡Œä¹‹å‰çš„çŠ¶æ€ã€‚

    - åˆ é™¤ä¿å­˜ç‚¹:
      release savepoint ä¿å­˜ç‚¹åç§°;


äº”ã€éš”ç¦»æ€§è¯¦è§£ ï¼ï¼
    ä¸€å…±æœ‰å››ç§éš”ç¦»çº§åˆ«ï¼š
    mysql&gt; set session transaction isolation level read uncommitted; -- ä¿®æ”¹éš”ç¦»çº§åˆ«ä¸ºï¼ˆè¯»æœªæäº¤ï¼‰

    mysql&gt; select @@tx_isolation;

    1.è¯»æœªæäº¤ï¼ˆread uncommittedï¼‰
        ä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»åˆ°å…¶ä»–äº‹åŠ¡è¿˜æœªæäº¤çš„æ•°æ®ï¼Œä¼šå‡ºç°è„è¯»ã€‚
        &gt; ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹è¿‡ä½†æœªæäº¤çš„æ•°æ®ï¼Œå³ä¸ºè„è¯»ã€‚

        ç”¨çš„å°‘ï¼Œè¿èƒŒäº‹åŠ¡çš„ç‰¹æ€§ï¼Œä¸ä¸¥è°¨

    2.è¯»å·²æäº¤ï¼ˆread committedï¼‰
        ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹è¿‡å¹¶å·²æäº¤çš„æ•°æ®ï¼Œå¹¶ä¸”å…¶ä»–äº‹åŠ¡æ¯å¯¹æ”¹æ•°æ®è¿›è¡Œä¸€æ¬¡ä¿®æ”¹å¹¶æäº¤åï¼Œè¯¥äº‹åŠ¡éƒ½èƒ½æŸ¥è¯¢åˆ°
        æœ€æ–°å€¼ï¼Œä¼šå‡ºç°ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚
        &gt; å¦‚æœä¸€ä¸ªäº‹åŠ¡å…ˆæ ¹æ®æŸäº›æ¡ä»¶æŸ¥è¯¢å‡ºä¸€äº›è®°å½•ï¼Œä¹‹åå¦ä¸€ä¸ªäº‹åŠ¡åˆå‘è¡¨ä¸­æ’å…¥äº†ç¬¦åˆè¿™äº›æ¡ä»¶çš„è®°å½•ï¼ˆå¹¶æäº¤ï¼‰ï¼ŒåŸå…ˆçš„
        äº‹åŠ¡å†æ¬¡æŒ‰ç…§è¯¥æ¡ä»¶æŸ¥è¯¢æ—¶ï¼Œèƒ½æŠŠå¦ä¸€ä¸ªäº‹åŠ¡æ’å…¥çš„è®°å½•ä¹Ÿè¯»å‡ºæ¥ï¼Œè¿™å°±æ˜¯å¹»è¯»ã€‚

    3.å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰
        ä¸€ä¸ªäº‹åŠ¡ç¬¬ä¸€æ¬¡è¯»è¿‡æŸæ¡è®°å½•åï¼Œå³ä½¿å…¶ä»–äº‹åŠ¡ä¿®æ”¹äº†è¯¥è®°å½•çš„å€¼å¹¶ä¸”æäº¤ï¼Œè¯¥äº‹åŠ¡ä¹‹åå†è¯»è¯¥æ¡è®°å½•æ—¶ï¼Œè¯»åˆ°çš„ä»æ˜¯ç¬¬ä¸€æ¬¡
        è¯»åˆ°çš„å€¼ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½è¯»åˆ°ä¸åŒçš„æ•°æ®ï¼Œè¿™å°±æ˜¯å¯é‡å¤è¯»ï¼Œè¿™ç§éš”ç¦»çº§åˆ«è§£å†³äº†ä¸å¯é‡å¤ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šå‡ºç°å¹»è¯»ã€‚

        ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯1 å°½ç®¡commit å®¢æˆ·ç«¯2 ä¹Ÿè¯»ä¸åˆ°å®¢æˆ·ç«¯1 commit åçš„å€¼ ï¼ˆå…¶å®æŒ‰ç†è¯´ä¸ä¼šå‡ºç°å¹»è¯»äº†ï¼Œä½†ä¹Ÿå¯èƒ½å‘ç”Ÿï¼‰
        ï¼ˆMYSQLé»˜è®¤çš„éš”ç¦»çº§åˆ« å°±æ˜¯å¯é‡å¤è¯»ï¼‰

    4.ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰
        ä»¥ä¸Šä¸‰ç§éš”ç¦»çº§åˆ«éƒ½å…è®¸å¯¹åŒä¸€æ¡è®°å½•åŒæ—¶è¿›è¡Œè¯»-è¯»ã€ è¯»-å†™ã€ å†™-è¯»ã€çš„å¹¶å‘æ“ä½œï¼Œå¦‚æœæˆ‘ä»¬ä¸å…è®¸è¯»-å†™ã€ å†™-è¯»
        çš„å¹¶å‘æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨serializable éš”ç¦»çº§åˆ«ï¼Œè¿™ç§éš”ç¦»çº§åˆ«å› ä¸ºå¯¹åŒä¸€æ¡è®°å½•éƒ½æ˜¯ä¸²è¡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°è„è¯»ã€å¹»è¯»
        ç­‰ç°è±¡

        è¿™ä¸­éš”ç¦»æ–¹å¼ï¼Œç”¨çš„ä¹Ÿä¸å¤šï¼Œå®ƒä¼šåœ¨ä¸€ä¸ªå®¢æˆ·ç«¯ çš„äº‹åŠ¡å°šæœªæ“ä½œcommit æ—¶é˜»å¡å…¶ä»–çš„äº‹åŠ¡è¿›è¡ŒæŸ¥æ‰¾

    æ³¨ï¼š
        1.è¿™å››ç§éš”ç¦»çº§åˆ«æ˜¯SQLå®šä¹‰çš„æ ‡å‡†ï¼Œä¸åŒæ•°æ®åº“ä¼šæœ‰ä¸åŒçš„å®ç°ï¼Œç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ [MYSQL åœ¨ repeatable read éš”ç¦»
            çº§åˆ«ä¸‹ï¼Œæ˜¯å¯ä»¥ç¦æ­¢å¹»è¯»é—®é¢˜çš„å‘ç”Ÿ]

        2.å¹»è¯»ï¼šæœ¬è´¨å’Œä¸å¯é‡å¤åº¦å·®ä¸å¤šï¼Œå¹»è¯»åªçš„æ˜¯å¤šè¯»å‡ºäº†å¦ä¸€ä¸ªäº‹åŠ¡ç”Ÿæˆçš„ä¸€è¡Œè®°å½•ï¼Œè€Œä¸å¯é‡å¤è¯»ï¼ŒæŒ‡çš„æ˜¯è¯»æŸä¸ªè®°å½•çš„
            åŸæœ¬å­—æ®µå‘ç”Ÿå˜åŒ–

å…­ã€äº‹åŠ¡IDåŠå›æ»šæŒ‡é’ˆ
    1.äº‹åŠ¡idï¼š
        å¦‚ä¸Šæ–‡æåˆ°ï¼Œmysqlé™¤è‡ªå®šä¹‰æ•°æ®å¤–ï¼Œè¿˜æœ‰ä¸‰ä¸ªéšè—åˆ—ï¼Œè¡Œidã€äº‹åŠ¡idã€å›æ»šæŒ‡é’ˆ
        æ¯ä¸€æ¬¡æ•°æ®è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½è¦å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå› æ­¤è¿™è¡Œçš„å…¶ä¸­ä¸€ä¸ªéšè—åˆ—ä¼šè®°å½•å½“æ—¶ä¿®æ”¹çš„äº‹åŠ¡id

    2.å›æ»šæŒ‡é’ˆï¼š
        å½“ä¿®æ”¹äº†ä¸€æ¬¡æ•°æ®ï¼Œä¸ä»…ä¼šä¿®æ”¹äº‹åŠ¡idï¼Œè¿˜æœ‰å›æ»šæŒ‡é’ˆè®°å½•ä¸Šä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼ˆåƒé“¾è¡¨ï¼Œå­˜åœ¨æ—¥å¿—ä¸­ï¼‰
        å¦‚ï¼š
                     æ•°æ®      äº‹åŠ¡id       å›æ»šæŒ‡é’ˆ
                1 5 1 1 a2 a3   300    trx_id_roll_pointer  ____
            ____________________________________________________|
            |   1 4 1 1 a2 a3   200    trx_id_roll_pointer  ____
            ____________________________________________________|
            |â€”â€”&gt;1 3 1 1 a2 a3   82     trx_id_roll_pointer  ____
            ____________________________________________________|
            |â€”â€”&gt;1 2 1 1 a2 a3   81     trx_id_roll_pointer....


    3.ç‰ˆæœ¬é“¾ï¼š
        ä»¥ä¸Šä¸ºæŸä¸€è¡Œæ•°æ®çš„ç‰ˆæœ¬é“¾ï¼Œå¯¹äºinnodbæ¥è¯´ï¼Œèšç°‡ç´¢å¼•è®°å½•ä¸­éƒ½åŒ…å«ä¸¤ä¸ªå¿…è¦çš„éšè—åˆ—ï¼Œï¼ˆrow_id å¹¶ä¸æ˜¯å¿…è¦çš„ï¼Œæˆ‘ä»¬
        åˆ›å»ºçš„è¡¨ä¸­æœ‰ä¸»é”®æˆ–è€…éNULLå”¯ä¸€é”®æ—¶éƒ½ä¸ä¼šåŒ…å«row_idåˆ—ï¼‰
        trx_id:æ¯æ¬¡å¯¹æŸæ¡è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½ä¼šæŠŠå¯¹åº”çš„äº‹åŠ¡idèµ‹å€¼ç»™trx_id éšè—åˆ—
        roll_pointer:æ¯æ¬¡å¯¹æŸæ¡è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œè¿™ä¸ªéšè—åˆ—ä¼šå­˜ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ‰¾åˆ°è®°å½•ä¿®æ”¹å‰çš„ä¿¡æ¯

        æ³¨ï¼šäº‹åŠ¡å›æ»šçš„ä¾æ®æ˜¯ undolog ï¼ˆåé¢æï¼‰

    4.read view:
        åœºæ™¯ï¼šAäº‹åŠ¡ï¼ˆid 300ï¼‰ è¯»å–æŸä¸€åˆ—å€¼ä¸º 1   Bäº‹åŠ¡ï¼ˆid 200ï¼‰ ä¿®æ”¹æŸä¸€åˆ—å€¼ä¸º 2
        å¯¹äºAäº‹åŠ¡åœ¨ select è¯»çš„æ—¶å€™ä¼šç”Ÿæˆä¸€ä¸ªread view (é‡Œé¢ä¼šæœ‰ä¸€ä¸ªé‡è¦å±æ€§ m_ids)
            m_ids:[]   -- é‡Œé¢ä¿å­˜äº†æ´»è·ƒçš„äº‹åŠ¡id ï¼ˆè¿˜æœªæäº¤çš„ï¼‰ [82, 200, 300]

            - å½“Aäº‹åŠ¡æœªæäº¤æ—¶ï¼š
                ä¼šç”¨äº‹åŠ¡idåˆ—è¡¨å»ç‰ˆæœ¬é“¾æ¯”å¯¹ï¼Œåˆ¤æ–­å¯¹åº”äº‹åŠ¡æ˜¯å¦æ˜¯æ´»è·ƒçš„ï¼Œè‹¥æ˜¯ï¼Œåˆ™ä¸å»é‡Œé¢æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸æ´»è·ƒçš„ï¼ˆå·²ç»
                æäº¤äº†çš„äº‹åŠ¡ï¼Œå› æ­¤ä¼šæŠŠä¹‹å‰æäº¤è¿‡çš„äº‹åŠ¡ 81 å¯¹åº”çš„æ•°æ®ç»™æ‰¾å‡ºæ¥ï¼‰[82, 200, 300]

            - å½“Aäº‹åŠ¡å·²ç»æäº¤ï¼šï¼ˆè¯»å·²æäº¤ä¸‹ï¼‰
                å’Œä¸Šè¿°ç±»ä¼¼ï¼Œä½†ç”±äºAå·²ç»æäº¤ï¼Œåˆ™ä¼šæ ¹æ®Aäº‹åŠ¡id 300æŠŠå¯¹åº”æ•°æ®è¯»å‡º[82, 300]

            - å½“Aäº‹åŠ¡å·²æäº¤ï¼šï¼ˆå¯é‡å¤è¯»ï¼‰
                m_ids = [82, 200, 300]  æ­¤æ—¶ä¸ä¸Šé¢ä¸åŒï¼Œä¸ä¼šæŠŠ200 å»æ‰ï¼Œä¼šç›´æ¥ç”¨ç¬¬ä¸€æ¬¡select äº‹ï¼Œç®—å‡ºæ¥çš„
                read view ä¼šç›´æ¥å»å¤ç”¨read view å³Aäº‹åŠ¡æœªæäº¤å‰çš„read view ã€‚æ‰€ä»¥æœ€åè¿˜æ˜¯æŠŠ81 æ‰¾å‡ºçš„æ¥ã€‚

            åŒºåˆ«ï¼šåœ¨äºç”Ÿæˆread view çš„æ—¶æœºä¸åŒï¼Œè¯»å·²æäº¤ï¼Œæ˜¯æ¯æ¬¡select éƒ½ä¼šç”Ÿæˆæ–°çš„read viewï¼Œ
                  å¯é‡å¤è¯»åˆ™æ˜¯ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡ç”Ÿæˆread view ä¹‹åéƒ½æ²¿ç”¨è¿™ä¸ª read view


    5.MVCCæ€»ç»“ï¼š
        MVCCï¼ˆmulti-version concurrency controlï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰æŒ‡çš„æ˜¯ è¯»å·²æäº¤ã€å¯é‡å¤è¯»è¿™ä¸¤ä¸­éš”ç¦»çº§åˆ«
        çš„äº‹åŠ¡åœ¨æ‰§è¡Œæ™®é€šçš„select è®¿é—®ç‰ˆæœ¬é“¾çš„è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ä¸åŒäº‹åŠ¡çš„è¯»-å†™ã€å†™-è¯»æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œä»è€Œæå‡ç³»ç»Ÿæ€§èƒ½ã€‚
        ï¼ˆé¿å…ä½¿ç”¨é”ï¼Œç­‰é‡Šæ”¾çš„ä½æ•ˆç‡è¡Œä¸ºï¼‰



ä¸ƒã€é”
    0.æ¦‚å¿µå›¾ï¼š
                                                                                â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  è¡¨é”
            ä¹è§‚é” â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”                                               |
                                 â€”â€”â€”â€” åŠ é”æœºåˆ¶                      é”ç²’åº¦ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” è¡Œé”
            æ‚²è§‚é” â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”             |                    |            |
                                                                                â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” é¡µé”
                                              â€”â€”â€”â€”â€”â€”â€”â€” é”  â€”â€”â€”â€”â€”â€”â€”â€”

            å…±äº«é” â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”                                               â€”â€”â€”Record Lockï¼ˆå•ä¸ªè®°å½•ä¸Šé”ï¼‰
                               |           |                       |         |
            æ’ä»–é” â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  â€”â€”â€”â€” å…¼å®¹æ€§                         é”ç®—æ³• â€”â€”â€”â€”â€”â€”â€”Gap Lockï¼ˆé—´éš™é”ï¼Œè§£å†³å¹»è¯»ï¼‰
                               |                                             |
            æ„å‘é” â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”                                               â€”â€”â€”Next-Key Lockï¼šGap Lock+Record Lock


    1.è¯»é”å’Œå†™é”
        è¯»é”ï¼šå…±äº«é”ï¼Œshared locks Sé”ã€‚
        å†™é”ï¼šæ’ä»–é”ï¼Œexclusive locks Xé”ã€‚ï¼ˆä¸€ä¸ªèµ„æºä¸ŠåŠ äº†å†™é”ï¼Œå…¶ä»–è‹¥éœ€è¦åŠ é”åˆ™éœ€è¦æ’é˜Ÿï¼‰
        selectï¼šä¸åŠ é”ï¼ˆå¯ä»¥è·³è¿‡é”å»è®¿é—®ï¼‰

        è¯»æ“ä½œï¼šå¯¹äºæ™®é€šçš„select è¯­å¥ï¼ŒInnoDBä¸ä¼šåŠ ä»»ä½•é”

    2.select ...lock in share mode
        å°†æŸ¥æ‰¾åˆ°çš„æ•°æ®åŠ ä¸Šä¸€ä¸ªSé”ï¼Œå…è®¸å…¶ä»–äº‹åŠ¡ç»§ç»­è·å–è¿™äº›è®°å½•çš„Sé”ï¼Œä¸èƒ½è·å–è¿™äº›è®°å½•çš„Xé”ï¼ˆä¼šé˜»å¡ï¼‰

        åœºæ™¯ï¼šè¯»å‡ºæ•°æ®åï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½ä¿®æ”¹ï¼Œä½†æ˜¯è‡ªå·±ä¹Ÿä¸ä¸€å®šèƒ½ä¿®æ”¹ï¼Œå› ä¸ºå…¶ä»–äº‹åŠ¡ä¹Ÿå¯ä»¥ä½¿ç”¨&quot; select ...lock
         in share mode&quot; ç»§ç»­åŠ è¯»é”ã€‚

    3.select ...for update
        å°†æŸ¥æ‰¾åˆ°çš„æ•°æ®åŠ ä¸Šä¸€ä¸ªXé”ï¼Œä¸å…è®¸å…¶ä»–äº‹åŠ¡è·å–è¿™äº›è®°å½•çš„Sé”å’ŒXé”ã€‚

        ä½¿ç”¨åœºæ™¯ï¼šè¯»å‡ºæ•°æ®åï¼Œå…¶ä»–äº‹åŠ¡æ—¢ä¸èƒ½å†™ï¼Œä¹Ÿä¸èƒ½åŠ è¯»é”ï¼Œé‚£ä¹ˆå°±å¯¼è‡´åªæœ‰è‡ªå·±å¯ä»¥ä¿®æ”¹æ•°æ®ã€‚


    4.å†™æ“ä½œï¼š
        DELETEï¼šåˆ é™¤ä¸€æ¡è®°å½•ï¼Œä¼šå…ˆå¯¹è®°å½•åŠ Xé”ï¼Œå†æ‰§è¡Œ
        INSERTï¼šæ’å…¥ä¸€æ¡è®°å½•ï¼Œä¼šå…ˆåŠ &quot;éšå¼é”&quot;æ¥ä¿æŠ¤è¿™æ¡æ–°è®°å½•åœ¨æœ¬äº‹åŠ¡æäº¤å‰ä¸è¢«å…¶ä»–äº‹åŠ¡è®¿é—®åˆ°ã€‚
        UPDATEï¼š
            - å¦‚æœè¢«æ›´æ–°çš„åˆ—ï¼Œä¿®æ”¹å‰åæ²¡æœ‰å¯¼è‡´å­˜å‚¨ç©ºé—´çš„å˜åŒ–ï¼Œé‚£ä¹ˆä¼šå…ˆç»™è®°å½•åŠ Xé”ï¼Œå†ç›´æ¥å¯¹è®°å½•è¿›è¡Œä¿®æ”¹ã€‚
            - å¦‚æœè¢«æ›´æ–°çš„åˆ—ï¼Œä¿®æ”¹å‰åå¯¼è‡´å­˜å‚¨ç©ºé—´å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆåå…ˆç»™è®°å½•åŠ Xé”ï¼Œç„¶åå†å°†è®°å½•åˆ æ‰ï¼Œå†
              insertä¸€æ¡æ–°çºªå½•ã€‚

        éšå¼é”ï¼šä¸€ä¸ªäº‹åŠ¡æ’å…¥ä¸€æ¡è®°å½•åï¼Œè¿˜æœªæäº¤ï¼Œè¿™æ¡è®°å½•ä¼šä¿å­˜æœ¬æ¬¡äº‹åŠ¡idï¼Œè€Œå…¶ä»–äº‹åŠ¡å¦‚æœæƒ³æ¥å¯¹è¿™ä¸ªè®°å½•åŠ é”
            æ—¶ä¼šå‘ç°äº‹åŠ¡id ä¸å¯¹åº”ï¼Œè¿™æ—¶ä¼šäº§ç”ŸXé”ï¼Œæ‰€ä»¥ç›¸å½“äºåœ¨æ’å…¥ä¸€æ¡è®°å½•æ—¶ï¼Œéšå¼çš„ç»™è¿™æ¡è®°å½•åŠ äº†ä¸€æŠŠéšå¼çš„Xé”ã€‚

        æ³¨ï¼š
            &gt; äº‹åŠ¡æäº¤æˆ–ç»“æŸåï¼Œé”æ‰ä¼šè‡ªåŠ¨è¿›è¡Œé‡Šæ”¾ã€‚
            &gt; é”å¿…é¡»æ˜¯åœ¨äº‹åŠ¡é‡Œé¢æ‰ç”¨çš„ã€‚ å› ä¸ºå¹³æ—¶å¼€å¯æ˜¯ä¸ªäº‹åŠ¡ä¸ä¼šæ‰‹å†™beginã€commit ï¼Œè€Œæ˜¯ç›´æ¥å†™sqlï¼Œ
              å¦‚ï¼šselect * from t1 where a = 1 for update ;
              ä½†è¦ä¸‹æ„è¯†çŸ¥é“ï¼Œå†™è¿™äº›sqlçš„æ—¶å€™ï¼Œä¼šé»˜è®¤çš„å…ˆå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè€Œå†æ¥æ‰§è¡Œè¿™ä¸ªsqlï¼Œç„¶åå†æäº¤è¿™ä¸ªsqlã€‚

    5.è¡Œé”ï¼ˆé”ç®—æ³•ï¼‰
        LOCK_REC_NOT_GAP: å•ä¸ªè¡Œè®°å½•ä¸Šçš„é”
        LOCK_GAP: é—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä½†ä¸åŒ…æ‹¬è®°å½•æœ¬èº«ï¼ŒGAPé”çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢åŒä¸€äº‹åŠ¡çš„ä¸¤æ¬¡å½“å‰è¯»ï¼Œå‡ºç°å¹»è¯»
                    çš„æƒ…å†µ
        LOCK_ORDINARY: é”å®šä¸€ä¸ªèŒƒå›´ï¼Œå¹¶ä¸”é”å®šè®°å½•æœ¬èº«å¯¹äºè¡Œçš„æŸ¥è¯¢ï¼Œéƒ½æ˜¯é‡‡ç”¨è¯¥æ–¹æ³•ï¼Œä¸»è¦ç›®çš„æ˜¯è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚


    6.read committed çº§åˆ«ä¸‹çš„é”ï¼š
        - å½“ç”¨ä¸»é”®æŸ¥è¯¢æ—¶
            select * from t1 where a = 1 for update;
            å†å¼€å¯äº‹åŠ¡2ï¼Œè¿›è¡Œä¸ä¸ŠåŒæ ·å¯¹ a = 1 çš„æŸ¥è¯¢ï¼Œæ­¤æ—¶ä¼šå‘ç°ä¼šé˜»å¡ã€‚å¯è‹¥è¿›è¡Œ a = 2 çš„ä¸»é”®æŸ¥è¯¢åˆ™ä¸ä¼šé˜»å¡ã€‚
            è¿™è¯´æ˜ï¼Œäº‹åŠ¡1 åˆ©ç”¨ä¸»é”®æŸ¥è¯¢ï¼Œåªä¼šé”ä½æŸ¥å‡ºæ¥çš„è¿™ä¸€è¡Œæ•°æ®

        - å½“ç”¨å”¯ä¸€ç´¢å¼•æŸ¥è¯¢æ—¶ï¼š
            ä¸ä¸Šæ–‡å…¶å®æ˜¯ä¸€è‡´çš„ï¼Œ

        - å½“æŸ¥è¯¢ä½¿ç”¨æ™®é€šç´¢å¼•æ—¶ï¼š
            select * from t1 where e = &quot;b&quot; for update; -- æ­¤æ—¶æŸ¥å‡ºå¤šæ¡e = &quot;b&quot;çš„æ•°æ®
            å†å¼€å¯äº‹åŠ¡2ï¼Œä½†æ‰§è¡Œ a = 1 çš„ä¸»é”®æŸ¥è¯¢ï¼ˆa = 1 çš„é‚£æ¡æ•°æ® eä¹Ÿç­‰äº&quot;b&quot;ï¼‰å‘ç°äº‹åŠ¡2ä¹Ÿä¼šé˜»å¡ï¼Œä½†è‹¥æ‰¾ä¸€ä¸ª
            a = 6 è¿™ç§ï¼ˆe ä¸ç­‰äº &quot;b&quot;ï¼‰çš„æ•°æ®ï¼Œå‘ç°æ²¡æœ‰é˜»å¡ã€‚
            è¿™è¯´æ˜ï¼Œæ™®é€šç´¢å¼•ï¼Œä¼šå¯¹ä»–æŸ¥è¯¢å‡ºæ¥çš„ç»“æœåŠ é”ã€‚

            æ­¤æ—¶æ‰§è¡Œ insert t1(b, c, d, e) values(30, 1, 1, &quot;b&quot;); æ’å…¥æ•°æ®ï¼Œæ˜¯å¯ä»¥è¿›è¡Œæ’å…¥e = &quot;b&quot;ç›¸å…³æ•°æ®çš„ã€‚

        - å½“å…¨è¡¨æ‰«ææ—¶ï¼šï¼ˆæœªä½¿ç”¨ç´¢å¼•ï¼‰
            å…¶å®åŒä¸Šï¼Œå¹¶ä¸ä¼šé”ä½å…¨è¡¨ï¼Œä¹Ÿåªä¼šå°†äº‹åŠ¡1æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®é”ä½ã€‚


    7.repeatable read çº§åˆ«ä¸‹çš„é”ï¼šï¼ˆmysql é»˜è®¤çš„éš”ç¦»çº§åˆ« -- å¯é‡å¤è¯»ï¼‰
        - å½“ä½¿ç”¨ä¸»é”®ã€å”¯ä¸€ç´¢å¼•æŸ¥è¯¢æ—¶ï¼š
            å’ŒRCéš”ç¦»çº§åˆ«ä¸€æ ·ï¼Œå½“æ‰§è¡Œä¸»é”® a &gt; 1 for update æ¡ä»¶æ—¶ï¼Œä¼šé”ä½å…¨è¡¨ï¼ŒåŒæ ·äº‹åŠ¡2 æ— æ³•æ’å…¥ä»»ä½•è®°å½•ã€‚

        - å½“ä½¿ç”¨æ™®é€šç´¢å¼•æŸ¥è¯¢æ—¶:
            æ¡ä»¶ä¸ä¸Šæ–‡ä¸€è‡´ï¼Œè¿˜æ˜¯e = &quot;b&quot; ä¹‹åç”¨äº‹åŠ¡2 æŸ¥è¯¢äº‹åŠ¡1 ä¹‹å¤–çš„æ•°æ®ï¼Œå‘ç°è¿˜æ˜¯å¯ä»¥æŸ¥è¯¢åˆ°ï¼Œä½†è‹¥æ­¤æ—¶æ‰§è¡Œæ’å…¥
            insert t1(b, c, d, e) values(30, 1, 1, &quot;b&quot;);    æ­¤æ—¶ä¼šå‘ç°è¿™æ¡è®°å½•æ˜¯æ’ä¸è¿›å»çš„ã€‚

            ä½†å¥½ç†è§£çš„æ˜¯ï¼Œè¿™æ ·çš„ç›®çš„æœ¬è´¨å°±æ˜¯ä¸ºäº†é˜²æ­¢ &quot;å¹»è¯»&quot; çš„å‘ç”Ÿ

        - å½“ä½¿ç”¨å…¨è¡¨æ‰«ææ—¶ï¼š
            åŒä¸Šï¼Œä¼šå°†å…¨è¡¨é”ä½ï¼Œå“ªæ€•æŸ¥è¯¢æ¡ä»¶æ—¶ c = 1 for updateï¼Œä¹Ÿä¸èƒ½æ›´æ”¹ c = 10 çš„è®°å½•ï¼Œå› ä¸ºå¯èƒ½ä¼šå‡ºç°
            ä½ æƒ³æŠŠ c = 10 æ”¹ä¸º c = 1 çš„æƒ…å†µï¼Œå› æ­¤é”ä½ï¼Œé˜²æ­¢å¹»è¯»ç°è±¡ã€‚

            æ³¨ï¼š
                å¯¹äºå¯é‡å¤è¯»çš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œ é€šå¸¸ä¼šå°†å…¨è¡¨ã€æ‰€æœ‰çš„è¡Œã€ç”šè‡³åŒ…æ‹¬é—´éš™éƒ½å…¨éƒ¨é”ä½ã€‚


    8.ä¹è§‚é”å’Œæ‚²è§‚é”ï¼š
                    æ‚²è§‚é”                                         ä¹è§‚é”
    æ¦‚å¿µï¼šæŸ¥è¯¢æ—¶ç›´æ¥é”ä½è®°å½•ä½¿å¾—å…¶ä»–äº‹åŠ¡ä¸èƒ½æŸ¥è¯¢          æäº¤æ›´æ–°æ—¶æ£€æŸ¥ç‰ˆæœ¬æˆ–æ—¶é—´æˆ³æ˜¯å¦ç¬¦åˆ
    è¯­æ³•ï¼šselect * for update                          ä½¿ç”¨version æˆ–è€… timestampè¿›è¡Œæ¯”è¾ƒ
    å®ç°è€…ï¼šæ•°æ®åº“æœ¬èº«                                  å¼€å‘è€…
    é€‚ç”¨åœºæ™¯ï¼šå¹¶å‘é‡å¤§                                  å¹¶å‘é‡å°

    æ‚²è§‚é”ï¼š
        æ‚²è§‚çš„è®¤ä¸ºæ•°æ®å¤„ç†ä¸­ï¼Œè‚¯å®šä¼šæœ‰å…¶ä»–äº‹åŠ¡è¿›è¡Œä¿®æ”¹æ•°æ®ï¼Œå› æ­¤å°±å°†æ•°æ®åŠ é”ï¼Œé€šå¸¸ä¾é å…³ç³»å‹æ•°æ®åº“çš„é”æœºåˆ¶ã€‚
        ä¸è®ºæ˜¯è¡Œé”ã€è¡¨é”ã€è¯»å†™é”ã€éƒ½æ˜¯æ‚²è§‚é”

    ä¹è§‚é”ï¼š
        è®¤ä¸ºæ¯æ¬¡è‡ªå·±æ“ä½œæ•°æ®ï¼Œéƒ½ä¸ä¼šæœ‰å…¶ä»–äº‹åŠ¡æ¥ä¿®æ”¹å®ƒï¼Œå› æ­¤ä¸åŠ é”ï¼Œä½†åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­æ­¤æœŸé—´çš„æ•°æ®æœ‰æ²¡æœ‰è¿›è¡Œä¿®æ”¹ã€‚éœ€è¦
        è‡ªå·±å®ç°ï¼Œä¸ä¼šå‘ç”Ÿå¹¶å‘æŠ¢å èµ„æºï¼Œåªæœ‰åœ¨æäº¤çš„æ—¶å€™æ£€æŸ¥ï¼Œæ˜¯å¦è¿åæ•°æ®å®Œæ•´æ€§ã€‚
        åŸç†å‡ºå·®CASç®—æ³•ï¼ˆä¸æ‡‚ï¼‰ä½†å¤§æ¦‚å°±åƒgitä¸€æ ·ã€‚

    åœºæ™¯ï¼š
        è¯»æ“ä½œ  è¿œ&gt;  å†™æ“ä½œ æ—¶ï¼Œæ­¤æ—¶ä¸€ä¸ªæ›´æ–°æ“ä½œåŠ é”å°±ä¼šé˜»å¡æ‰€æœ‰çš„è¯»æ“ä½œï¼Œé™ä½ååé‡ï¼Œæœ€åè¿˜è¦é‡Šæ”¾é”ï¼Œé”è¿˜è¦å¼€é”€ï¼Œå› æ­¤ç”¨ä¹è§‚é”

        è¯»æ“ä½œ  ==  å†™æ“ä½œ éƒ½å·®ä¸å¤šæ—¶ï¼Œæˆ–è€…ç³»ç»Ÿæ²¡æœ‰å“åº”ä¸åŠæ—¶ï¼ˆé˜»å¡ä½çš„æƒ…å†µã€ååé‡ç“¶é¢ˆç­‰é—®é¢˜ï¼‰é‚£å°±ä¸è¦ä½¿ç”¨ä¹è§‚é”ï¼Œå®ƒå¢åŠ äº†
        å¤æ‚åº¦ï¼Œè¿˜å¸¦æ¥äº†é¢å¤–çš„ä¸šåŠ¡é£é™©ï¼Œæ­¤æ—¶ç”¨æ‚²è§‚é”å³å¯ã€‚

    pythonä¸­ä½¿ç”¨æ‚²ä¹é”ï¼š
        1.æ‚²è§‚é”çš„ä½¿ç”¨ï¼š
            å¿…é¡»å…³é—­mysqlçš„è‡ªåŠ¨æäº¤å±æ€§ï¼Œå³æ‰§è¡Œæ›´æ”¹æ“ä½œæ—¶ä¼šç«‹å³å°†ç»“æœæäº¤ã€‚set autocommit = 0
            ç”±select * from è¡¨å where id = 1 for update  åŠ Xé”è¿™ç±»å‹çš„è¯­å¥è¡ç”Ÿ
            ORMä¸­ï¼š
                # å¼€å¯äº‹åŠ¡è£…é¥°å™¨ åœ¨æŒ‡å®šå‡½æ•°å‰åŠ ä¸Š
                @transaction.atomic
                obj = æ¨¡å‹ç±»å.objects.select_for_update.get(id = 1) # å³å¯å®ç°æ‚²è§‚é”ï¼Œè‹¥åŠ é”å¤±è´¥åˆ™è¯´æ˜è®°å½•æ­£åœ¨è¢«ä¿®æ”¹ï¼Œ
                                                                    # éœ€è¦ç­‰å¾…æˆ–æ˜¯æŠ›å‡ºå¼‚å¸¸

        2.ä¹è§‚é”çš„ä½¿ç”¨ï¼š
            ä¹è§‚é”å…¶å®å¹¶ä¸æ˜¯é”ã€‚é€šè¿‡SQLçš„whereå­å¥ä¸­çš„æ¡ä»¶æ˜¯å¦æ»¡è¶³æ¥åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ›´æ–°æ¡ä»¶æ¥æ›´æ–°æ•°æ®åº“ï¼Œé€šè¿‡å—å½±å“è¡Œæ•°åˆ¤æ–­
            æ˜¯å¦æ›´æ–°æˆåŠŸï¼Œå¦‚æœæ›´æ–°å¤±è´¥å¯ä»¥å†æ¬¡è¿›è¡Œå°è¯•ï¼Œå¦‚æœå¤šæ¬¡å°è¯•å¤±è´¥å°±è¿”å›æ›´æ–°å¤±è´¥çš„ç»“æœã€‚

            ä½¿ç”¨ä¹è§‚é”æ—¶ï¼Œå¿…é¡»è®¾ç½®æ•°æ®åº“çš„éš”ç¦»çº§åˆ«æ˜¯Read Committed(å¯ä»¥è¯»åˆ°å…¶ä»–çº¿ç¨‹å·²æäº¤çš„æ•°æ®)ã€‚å¦‚æœéš”ç¦»çº§åˆ«æ˜¯
            Repeatable Read(å¯é‡å¤è¯»ï¼Œè¯»åˆ°çš„æ•°æ®éƒ½æ˜¯å¼€å¯äº‹åŠ¡æ—¶åˆ»çš„æ•°æ®ï¼Œå³ä½¿å…¶ä»–çº¿ç¨‹æäº¤æ›´æ–°æ•°æ®ï¼Œè¯¥çº¿ç¨‹è¯»å–çš„æ•°æ®
            ä¹Ÿæ˜¯ä¹‹å‰è¯»åˆ°çš„æ•°æ®)ï¼Œä¹è§‚é”å¦‚æœç¬¬ä¸€æ¬¡å°è¯•å¤±è´¥,é‚£ä¹ˆä¸ç®¡å°è¯•å¤šå°‘æ¬¡éƒ½ä¼šå¤±è´¥ã€‚ (Mysqlæ•°æ®åº“çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯
            Repeatable Readï¼Œéœ€è¦ä¿®æ”¹æˆRead Committed)ã€‚

            # é¦–å…ˆå¼•å…¥
            from django.db import transaction

            # ä»¥ä¸‹ä¸ºä¹è§‚é”è§†å›¾å±‚ç¤ºä¾‹
            class MyView(View):

                @transaction.atomic
                def post(self, request):
                    &#39;&#39;&#39;è®¢å•åˆ›å»º&#39;&#39;&#39;
                    count = 3   # è®¢è´­3ä»¶å•†å“

                    # è®¾ç½®äº‹åŠ¡ä¿å­˜ç‚¹
                    s1 = transaction.savepoint()

                    # ä¹è§‚é”ï¼Œæœ€å¤šå°è¯•5æ¬¡
                    for i in range(5):
                        # æŸ¥è¯¢å•†å“çš„ä¿¡æ¯(åº“å­˜)
                        try:
                            sku = GoodsSKU.objects.get(id=1)
                        except:
                            # å•†å“ä¸å­˜åœ¨
                            transaction.savepoint_rollback(s1)
                            return JsonResponse({&#39;res&#39;: 1, &#39;errmsg&#39;: &#39;å•†å“ä¸å­˜åœ¨&#39;})

                        # åˆ¤æ–­å•†å“çš„åº“å­˜
                        if count &gt; sku.stock:
                            transaction.savepoint_rollback(s1)
                            return JsonResponse({&#39;res&#39;: 2, &#39;errmsg&#39;: &#39;å•†å“åº“å­˜ä¸è¶³&#39;})

                        # æ›´æ–°å•†å“çš„åº“å­˜å’Œé”€é‡
                        orgin_stock = sku.stock   # åŸåº“å­˜ (æ•°æ®åº“éš”ç¦»çº§åˆ«å¿…é¡»æ˜¯Read Committedï¼›å¦‚æœæ˜¯Repeatable Read,
                                                  #  é‚£ä¹ˆå¤šæ¬¡å°è¯•è¯»å–çš„åŸåº“å­˜éƒ½æ˜¯ä¸€æ ·çš„,è¯»ä¸åˆ°å…¶ä»–çº¿ç¨‹æäº¤æ›´æ–°åçš„æ•°æ®ã€‚)
                        new_stock = orgin_stock - count   # æ›´æ–°åçš„åº“å­˜
                        new_sales = sku.sales + count   # æ›´æ–°åçš„é”€é‡

                        # update å•†å“è¡¨ set stock=new_stock, sales=new_sales where id=1 and stock = orgin_stock
                        # é€šè¿‡whereå­å¥ä¸­çš„æ¡ä»¶åˆ¤æ–­åº“å­˜æ˜¯å¦è¿›è¡Œäº†ä¿®æ”¹ã€‚(å¹¶å‘ï¼Œä¹è§‚é”)
                        # è¿”å›å—å½±å“çš„è¡Œæ•°
                        res = GoodsSKU.objects.filter(id=1, stock=orgin_stock).update(stock=new_stock, sales=new_sales)
                        if res == 0:  # å¦‚æœä¿®æ”¹å¤±è´¥
                            if i == 4:
                                # å¦‚æœå°è¯•5æ¬¡éƒ½å¤±è´¥
                                transaction.savepoint_rollback(s1)
                                return JsonResponse({&#39;res&#39;: 3, &#39;errmsg&#39;: &#39;ä¸‹å•å¤±è´¥&#39;})
                            continue  # å†æ¬¡å°è¯•

                        # å¦åˆ™æ›´æ–°æˆåŠŸ
                        # è·³å‡ºå°è¯•å¾ªç¯
                        break


                    # æäº¤äº‹åŠ¡
                    transaction.savepoint_commit(s1)

                    # è¿”å›åº”ç­”
                    return JsonResponse({&#39;res&#39;: 4, &#39;message&#39;: &#39;åˆ›å»ºæˆåŠŸ&#39;})


        æ³¨ï¼š
            åœ¨å¹¶å‘æ¯”è¾ƒå°‘æ—¶å»ºè®®ä½¿ç”¨ä¹è§‚é”,å‡å°‘åŠ é”ã€é‡Šæ”¾é”çš„å¼€é”€ã€‚åœ¨å¹¶å‘æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œå»ºè®®ä½¿ç”¨æ‚²è§‚é”ã€‚

            å¦‚æœä¹è§‚é”å¤šæ¬¡å°è¯•çš„ä»£ä»·æ¯”è¾ƒå¤§ï¼Œä¹Ÿå»ºè®®ä½¿ç”¨æ‚²è§‚é”ã€‚

            ä¹è§‚é”çš„å¤„ç†æ–¹å¼å¯ä»¥ç†è§£ä¸ºåœ¨è¿›è¡Œæ•°æ®æ“ä½œæ—¶ä¸åŠ é”ï¼Œåœ¨è¿›è¡Œæ•°æ®æ›´æ–°æ—¶è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­æ›´æ–°æ—¶çš„æ•°æ®å’Œä¹‹å‰çš„æ•°æ®æ˜¯å¦ä¸€è‡´ï¼Œ
            å¦‚æœä¸ä¸€è‡´è¯´æ˜å·²è¢«å…¶ä»–è¿›ç¨‹å…ˆè¿›è¡Œæ“ä½œ


    9.ä¼˜åŒ–SQLçš„æ–¹æ³•ï¼š
        1.é€‰å–æœ€é€‚ç”¨çš„å­—æ®µå±æ€§ï¼Œå°½å¯èƒ½å‡å°‘å®šä¹‰å­—æ®µå®½åº¦ï¼Œå°½é‡æŠŠå­—æ®µè®¾ç½®NOTNULLï¼Œä¾‹å¦‚â€™çœä»½â€™ã€&#39;æ€§åˆ«â€™æœ€å¥½é€‚ç”¨ENUM
        2.ä½¿ç”¨è¿æ¥(JOIN)æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼ˆä½¿ç”¨å¤šæ¬¡æŸ¥è¯¢æ¥ä»£æ›¿ JOINï¼‰
        3.é€‚ç”¨è”åˆ(UNION)æ¥ä»£æ›¿æ‰‹åŠ¨åˆ›å»ºçš„ä¸´æ—¶è¡¨
        4.äº‹åŠ¡å¤„ç†
        5.é”å®šè¡¨ã€ä¼˜åŒ–äº‹åŠ¡å¤„ç†
        6.é€‚ç”¨å¤–é”®ï¼Œä¼˜åŒ–é”å®šè¡¨
        7.å»ºç«‹ç´¢å¼•
</code></pre><h2 id="å¿«ç…§è¯»æ²¡æœ‰å®Œå…¨è§£å†³å¹»è¯»" tabindex="-1"><a class="header-anchor" href="#å¿«ç…§è¯»æ²¡æœ‰å®Œå…¨è§£å†³å¹»è¯»"><span>å¿«ç…§è¯»æ²¡æœ‰å®Œå…¨è§£å†³å¹»è¯»ï¼Ÿ</span></a></h2><p>æ˜¯çš„ï¼ŒMySQLæ²¡æœ‰å®Œå…¨è§£å†³å¿«ç…§è¯»ä¸‹çš„å¹»è¯»é—®é¢˜ã€‚</p><p>å¯ä»¥åšè¿™ä¸ªå®éªŒï¼š</p><ol><li>å½“å‰DBå·²æœ‰id 5, 10, 15ä¸‰æ¡æ•°æ®ã€‚</li><li>äº‹åŠ¡AæŸ¥è¯¢id &lt; 10çš„æ•°æ®ï¼Œå¯ä»¥æŸ¥å‡ºä¸€è¡Œè®°å½•id = 5</li><li>äº‹åŠ¡Bæ’å…¥id = 6çš„æ•°æ®</li><li>äº‹åŠ¡Aå†æŸ¥è¯¢id &lt; 10çš„æ•°æ®ï¼Œå¯ä»¥æŸ¥å‡ºä¸€è¡Œè®°å½•id = 5ï¼ŒæŸ¥ä¸å‡ºid = 6çš„æ•°æ®ï¼ˆè¯»åœºæ™¯ï¼Œè§£å†³äº†å¹»è¯»ï¼‰</li><li>äº‹åŠ¡Aå¯ä»¥æ›´æ–°/åˆ é™¤id = 6çš„æ•°æ®ï¼Œä¸èƒ½æ’å…¥id = 6çš„æ•°æ®ï¼ˆå†™åœºæ™¯ï¼Œå¹»è¯»ä¸å½»åº•ï¼‰</li></ol><p>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼ŒMySQLè™½ç„¶é€šè¿‡MVCCçš„ç‰ˆæœ¬å·æ¥è§£å†³äº†è¯»åœºæ™¯ä¸‹çš„å¹»è¯»ï¼Œä½†å¯¹äºä¸Šé¢ç¬¬5æ­¥é‚£ç§å†™åœºæ™¯çš„æƒ…å†µï¼Œå…¶å®æ˜¯æ— èƒ½ä¸ºåŠ›çš„ï¼Œå› ä¸ºMVCCæ¯•ç«Ÿæ˜¯æ— é”å®ç°ã€‚</p><p>æ‰€ä»¥å¦‚æœåç»­è¦å¯¹æ•°æ®è¿›è¡Œå†™æ“ä½œï¼Œè¿˜æ˜¯<strong>é€šè¿‡for updateè¯­å¥ä¸Šé”</strong>æ¯”è¾ƒç¨³å¦¥ï¼Œä¸ç„¶å°±å¯èƒ½ä¼šå‡ºç°ä¸Šé¢ç¬¬5æ­¥é‚£æ ·çš„é—®é¢˜ã€‚</p></div></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°ï¼š</span><time class="vp-meta-info" datetime="2025-06-13T06:08:46.000Z" data-allow-mismatch>2025/6/13 06:08</time></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">é»˜è®¤é¡µè„š</div><div class="vp-copyright">Copyright Â© 2025 æ‚¦Â·å®å® </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DM342j-t.js" defer></script>
  </body>
</html>
