import{_ as a}from"./plugin-vueexport-helper.2444895f.js";import{o as e,c as n,e as i,a as s,b as l,f as r}from"./app.cc6737f0.js";const d={},c=s("p",null,[s("strong",null,"UFS"),l(" \u7BA1\u7406\u5E73\u53F0\u5E38\u7528\u5FEB\u6377\u547D\u4EE4")],-1),t=r(`<h1 id="ufs-\u5FEB\u6377\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#ufs-\u5FEB\u6377\u547D\u4EE4" aria-hidden="true">#</a> UFS \u5FEB\u6377\u547D\u4EE4</h1><h3 id="_1-\u90E8\u7F72\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_1-\u90E8\u7F72\u76F8\u5173" aria-hidden="true">#</a> 1. \u90E8\u7F72\u76F8\u5173</h3><h4 id="_1-1-\u66F4\u65B0\u96C6\u7FA4\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#_1-1-\u66F4\u65B0\u96C6\u7FA4\u4EE3\u7801" aria-hidden="true">#</a> 1.1 \u66F4\u65B0\u96C6\u7FA4\u4EE3\u7801</h4><ul><li><p>\u514D\u5BC6\u8BA4\u8BC1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen
$ ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa.pub <span class="token parameter variable">-p</span> <span class="token number">22</span> root@172.16.120.142
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u8FDC\u7A0B\u62F7\u8D1D</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">scp</span> <span class="token parameter variable">-r</span> agent conf dashboard monitor mounter rook static version.py ubind watchdog root@172.16.120.142:/opt/uxs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u8FDC\u7A0B\u6267\u884C\u547D\u4EE4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ssh</span> <span class="token number">172.16</span>.120.142 <span class="token string">&quot;systemctl restart uxs-agent&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u91CD\u542F\u670D\u52A1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl restart uxs-dashboard
systemctl restart uxs-agent
systemctl restart uxs-monitor
systemctl status uxs-dashboard
systemctl status uxs-agent
systemctl status uxs-monitor
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u624B\u52A8\u542F\u52A8\u670D\u52A1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ python3 /opt/uxs/dashboard/uxsdashboard.py

$ python3 /opt/uxs/agent/uxsagent.py

$ python3 /opt/uxs/monitor/uxsmonitor.py
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u67E5\u770B\u670D\u52A1\u8FDB\u7A0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span><span class="token function">grep</span> uxsdashboard

$ <span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span><span class="token function">grep</span> uxsagent

$ <span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span><span class="token function">grep</span> uxsmonitor
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u5220\u9664\u670D\u52A1 PID \u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/run/uxsagent.pid

$ <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/run/uxsmonitor.pid
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u67E5\u770B\u5404\u4E2A\u670D\u52A1\u65E5\u5FD7</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ tailf /var/log/uxs/uxsdashboard.log

$ tailf /var/log/uxs/uxsagent.log

$ tailf /var/log/uxs/uxsmonitor.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_1-2-etcd-\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_1-2-etcd-\u76F8\u5173" aria-hidden="true">#</a> 1.2 ETCD \u76F8\u5173</h4><ul><li><p>\u91CD\u7F6E <strong>etcd</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u4FEE\u6539 new</span>
$ <span class="token function">vim</span> /etc/uxs/config.json

<span class="token comment"># \u91CD\u7F6Eendpoints</span>
$ <span class="token function">vim</span> /etc/uxs/etcd.json

<span class="token punctuation">{</span>
    <span class="token string">&quot;etcd_endpoints&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ipv4:///127.0.0.1:22379&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># \u6E05\u7A7Aetcd</span>
systemctl stop uxsetcd
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/etcd/uxs_default.etcd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_1-3-\u751F\u6210\u8BB8\u53EF" tabindex="-1"><a class="header-anchor" href="#_1-3-\u751F\u6210\u8BB8\u53EF" aria-hidden="true">#</a> 1.3 \u751F\u6210\u8BB8\u53EF</h4><ul><li><p>\u751F\u6210\u8BB8\u53EF\u8BC1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ufs_make_license <span class="token parameter variable">--serial_number</span> 17A179CFF629D10322E69AF61A959E013DCE5075  <span class="token parameter variable">--chunkservers</span><span class="token operator">=</span><span class="token number">1000</span> <span class="token parameter variable">--clients</span><span class="token operator">=</span><span class="token number">10000</span> <span class="token parameter variable">--expire_date</span><span class="token operator">=</span><span class="token number">2099</span>-01-01 <span class="token parameter variable">--capcity</span><span class="token operator">=</span>2PiB
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h4 id="_1-4-mss-\u670D\u52A1\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_1-4-mss-\u670D\u52A1\u76F8\u5173" aria-hidden="true">#</a> 1.4 MSS \u670D\u52A1\u76F8\u5173</h4><h5 id="\u89E3\u51B3-mss-\u65E0\u6CD5\u542F\u52A8\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3-mss-\u65E0\u6CD5\u542F\u52A8\u95EE\u9898" aria-hidden="true">#</a> \u89E3\u51B3 <code>MSS</code> \u65E0\u6CD5\u542F\u52A8\u95EE\u9898</h5><ul><li><p><code>-a</code> \u53C2\u6570</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ufsmetaserver restart <span class="token parameter variable">-a</span>

<span class="token comment"># \u7136\u540E\u518D\u6267\u884C stop\uFF0C\u5E76\u53BB\u7BA1\u7406\u5E73\u53F0\u624B\u52A8\u542F\u52A8</span>
ufsmetaserver stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>test</code> \u53C2\u6570</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u67E5\u770B ufsmetaserver \u5F53\u524D\u60C5\u51B5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><code>-f</code> \u53C2\u6570</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u670D\u52A1\u9519\u8BEF\u65E5\u5FD7</span>
ufsmetaserver <span class="token parameter variable">-f</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><blockquote><p><strong>\u5907\u6CE8</strong>\uFF1A \u7EC8\u6781\u89E3\u51B3\u529E\u6CD5: <code>ufsmeatserver -e</code></p><p>\u6B64\u65B9\u5F0F\u4F1A\u5C06\u6240\u6709 <code>meta</code>\u3001<code>chunk</code> \u90FD\u91CD\u65B0\u542F\u52A8\uFF0C\u53EF\u80FD\u4F1A\u5BFC\u81F4\u4E22\u6570\u636E\uFF01\uFF01\uFF01\uFF01</p><p>\u4EC5\u6709\u5341\u5206\u5341\u5206\u7279\u6B8A\u60C5\u51B5\u4E0B\uFF0C\u4E5F\u5E94\u8BE5\u5148\u786E\u8BA4\uFF0C\u518D\u4F7F\u7528</p></blockquote><h4 id="_1-5-css-\u670D\u52A1\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_1-5-css-\u670D\u52A1\u76F8\u5173" aria-hidden="true">#</a> 1.5 CSS \u670D\u52A1\u76F8\u5173</h4><h5 id="\u89E3\u51B3-css-\u65E0\u6CD5\u542F\u52A8\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3-css-\u65E0\u6CD5\u542F\u52A8\u95EE\u9898" aria-hidden="true">#</a> \u89E3\u51B3 <code>CSS</code> \u65E0\u6CD5\u542F\u52A8\u95EE\u9898</h5><ul><li><p><code>-f</code> \u53C2\u6570</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u670D\u52A1\u9519\u8BEF\u65E5\u5FD7</span>
ufschunkserver <span class="token parameter variable">-f</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_1-x-\u6302\u8F7D\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_1-x-\u6302\u8F7D\u76F8\u5173" aria-hidden="true">#</a> 1.x \u6302\u8F7D\u76F8\u5173</h4><ul><li><p>\u6302\u8F7D\u5B50\u76EE\u5F55</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ /usr/bin/ufsmount <span class="token parameter variable">-o</span> <span class="token assign-left variable">ufsioretries</span><span class="token operator">=</span><span class="token number">3</span>,ufstimeout<span class="token operator">=</span><span class="token number">1</span>,ufsdelayedinit,internal /export/nas/Users
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u6302\u8F7D\u56DE\u6536\u7AD9\u76EE\u5F55</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ /usr/bin/ufsmount <span class="token parameter variable">-m</span> /export/meta/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u8FDC\u7A0B\u6302\u8F7D</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ufsmount <span class="token parameter variable">-H</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><hr><h3 id="_2-\u8C03\u5EA6\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_2-\u8C03\u5EA6\u76F8\u5173" aria-hidden="true">#</a> 2. \u8C03\u5EA6\u76F8\u5173</h3><h4 id="_2-1-\u8282\u70B9\u9AD8\u53EF\u7528" tabindex="-1"><a class="header-anchor" href="#_2-1-\u8282\u70B9\u9AD8\u53EF\u7528" aria-hidden="true">#</a> 2.1 \u8282\u70B9\u9AD8\u53EF\u7528</h4><h4 id="_2-2-nas-\u670D\u52A1\u9AD8\u53EF\u7528" tabindex="-1"><a class="header-anchor" href="#_2-2-nas-\u670D\u52A1\u9AD8\u53EF\u7528" aria-hidden="true">#</a> 2.2 NAS \u670D\u52A1\u9AD8\u53EF\u7528</h4><ul><li><p>\u76D1\u542C IP</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">watch</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token string">&quot;ip a&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u79D2 <code>ping</code> IP</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u76EE\u524D\u7528\u4E8E\u9AD8\u53EF\u7528\u68C0\u6D4B\u7F51\u5361\u662F\u5426ping\u901A\uFF0C\u7531\u4E8E\u4E0A\u9501\u540C\u6B65\u5BFC\u81F4\u81F3\u5C11\u97001s</span>
<span class="token function">ping</span> <span class="token number">192.16</span>.120.175 <span class="token parameter variable">-c</span> <span class="token number">1</span> <span class="token parameter variable">-t</span> <span class="token number">1</span> <span class="token parameter variable">-W</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u6DFB\u52A0\u7F51\u5361 IP</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ip</span> addr <span class="token function">add</span> <span class="token number">172.16</span>.120.171/24 broadcast <span class="token number">172.16</span>.120.255 dev eth1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u5220\u9664\u7F51\u5361 IP</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ip</span> addr del <span class="token number">172.16</span>.120.171/24 dev eth1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u5237\u65B0\u7F51\u5361</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ip</span> addr flush eth1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u8BBE\u7F6E\u7F51\u5361\u72B6\u6001</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> eth1 down
$ <span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> eth1 up
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h3 id="_3-\u57FA\u7840\u6392\u9519\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_3-\u57FA\u7840\u6392\u9519\u76F8\u5173" aria-hidden="true">#</a> 3. \u57FA\u7840\u6392\u9519\u76F8\u5173</h3><h4 id="_3-1-\u57FA\u7840\u670D\u52A1\u65E0\u6CD5\u542F\u52A8" tabindex="-1"><a class="header-anchor" href="#_3-1-\u57FA\u7840\u670D\u52A1\u65E0\u6CD5\u542F\u52A8" aria-hidden="true">#</a> 3.1 \u57FA\u7840\u670D\u52A1\u65E0\u6CD5\u542F\u52A8</h4><ul><li><p><code>systemctl</code> \u65E0\u6CD5\u542F\u52A8</p><blockquote><p>\u4F8B: <code>systemctl restart smb.service</code> \u65E0\u6CD5\u542F\u52A8</p></blockquote></li><li></li></ul>`,26);function p(o,u){return e(),n("div",null,[c,i(" more "),t])}const b=a(d,[["render",p],["__file","ufs\u7BA1\u7406\u5E73\u53F0.html.vue"]]);export{b as default};
