import{_ as r}from"./plugin-vueexport-helper.2444895f.js";import{o as c,c as d,a as s,b as n,d as a,w as o,f as e,r as i}from"./app.e5779470.js";const u={},m=e('<h1 id="nfs" tabindex="-1"><a class="header-anchor" href="#nfs" aria-hidden="true">#</a> NFS</h1><h3 id="_1-\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#_1-\u7B80\u4ECB" aria-hidden="true">#</a> 1. \u7B80\u4ECB</h3><h3 id="_2-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-\u914D\u7F6E" aria-hidden="true">#</a> 2. \u914D\u7F6E</h3><h4 id="_2-1-\u8F6F\u4EF6\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-1-\u8F6F\u4EF6\u914D\u7F6E" aria-hidden="true">#</a> 2.1 \u8F6F\u4EF6\u914D\u7F6E</h4><h4 id="_2-2-\u5BFC\u51FA\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-2-\u5BFC\u51FA\u914D\u7F6E" aria-hidden="true">#</a> 2.2 \u5BFC\u51FA\u914D\u7F6E</h4>',5),h={href:"https://insights-core.readthedocs.io/en/latest/shared_parsers_catalog/nfs_exports.html#insights.parsers.nfs_exports.NFSExportsBase",target:"_blank",rel:"noopener noreferrer"},v=e(`<h3 id="_3-\u4F7F\u7528\u53CA\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#_3-\u4F7F\u7528\u53CA\u8BF4\u660E" aria-hidden="true">#</a> 3. \u4F7F\u7528\u53CA\u8BF4\u660E</h3><h4 id="_3-1-exportfs-\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#_3-1-exportfs-\u5DE5\u5177" aria-hidden="true">#</a> 3.1 exportfs \u5DE5\u5177</h4><p><strong>\u8BED\u6CD5\u683C\u5F0F</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>exportfs <span class="token punctuation">[</span>\u5FC5\u8981\u53C2\u6570<span class="token punctuation">]</span> <span class="token punctuation">[</span>\u9009\u62E9\u53C2\u6570<span class="token punctuation">]</span> <span class="token punctuation">[</span>\u76EE\u5F55<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u529F\u80FD\u63CF\u8FF0</strong></p>`,5),b={href:"https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html/managing_file_systems/the-exportfs-utility_exporting-nfs-shares",target:"_blank",rel:"noopener noreferrer"},k=s("code",null,"/etc/exports",-1),_=s("code",null,"root",-1),g=e(`<ul><li><code>exportfs</code> \u4F1A\u5C06\u5BFC\u51FA\u7684\u6587\u4EF6\u7CFB\u7EDF\u5199\u5230 <code>/var/lib/nfs/xtab</code></li><li><code>nfs-mountd</code> \u670D\u52A1\u5728\u51B3\u5B9A\u8BBF\u95EE\u6587\u4EF6\u7CFB\u7EDF\u7684\u7279\u6743\u65F6\uFF0C\u4F1A\u53C2\u8003 <code>xtab</code> \u6587\u4EF6\uFF0C\u56E0\u6B64\u5BF9\u5BFC\u51FA\u7684\u6587\u4EF6\u7CFB\u7EDF\u5217\u8868\u7684\u66F4\u6539\uFF0C\u4F1A\u7ACB\u5373\u751F\u6548</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># reload \u5BFC\u51FA</span>
$ exportfs <span class="token parameter variable">-rv</span>  <span class="token operator">||</span>  <span class="token parameter variable">-arv</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-\u53D1\u73B0-nfs-\u5BFC\u51FA" tabindex="-1"><a class="header-anchor" href="#_3-2-\u53D1\u73B0-nfs-\u5BFC\u51FA" aria-hidden="true">#</a> 3.2 \u53D1\u73B0 NFS \u5BFC\u51FA</h4><ul><li><p>\u5BF9\u4E8E\u652F\u6301 <strong>NFSv3</strong> \u7684\u4EFB\u4F55\u670D\u52A1\u5668\uFF0C\u8BF7\u4F7F\u7528 <code>showmount</code> \u5DE5\u5177</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ showmount <span class="token parameter variable">-e</span> <span class="token number">172.16</span>.120.141
<span class="token comment"># Export list for 172.16.120.141:</span>
<span class="token comment"># /exports/zz              *</span>
<span class="token comment"># /share/Users/grpc-master *</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u5BF9\u4E8E\u652F\u6301 <strong>NFSv4</strong> \u7684\u4EFB\u4F55\u670D\u52A1\u5668\uFF0C\u6302\u8F7D\u6839\u76EE\u5F55\u5E76\u67E5\u627E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">mount</span> <span class="token number">172.16</span>.120.141:/share /mnt/zz
$ <span class="token function">ls</span> /mnt/zz
<span class="token comment"># exports</span>

<span class="token variable">$ls</span> /mnt/zz/exports/
<span class="token comment"># foo</span>
<span class="token comment"># bar</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_3-3-\u6302\u8F7D" tabindex="-1"><a class="header-anchor" href="#_3-3-\u6302\u8F7D" aria-hidden="true">#</a> 3.3 \u6302\u8F7D</h4><p>\u8BF7\u4F7F\u7528\u5982\u4E0B\u5F62\u5F0F\u7684\u547D\u4EE4\u53BB\u6302\u8F7D\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">mount</span> <span class="token parameter variable">-t</span> nfs <span class="token parameter variable">-o</span> options host:/remote/export /local/directory
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p>\u901A\u8FC7 <code>ip</code> \u6302\u8F7D</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># v3\u7248\u672C</span>
$ mount.nfs <span class="token parameter variable">-vvv</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">vers</span><span class="token operator">=</span><span class="token number">3</span> <span class="token number">172.16</span>.120.141:/share/Users/zz /home/zz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u901A\u8FC7 <strong>\u57DF\u540D</strong> \u6302\u8F7D</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># v4\u7248\u672C</span>
$ mount.nfs <span class="token parameter variable">-vvv</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">vers</span><span class="token operator">=</span><span class="token number">4</span> nas.local:/share/zz /home/zz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul>`,8),f={href:"https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html/managing_file_systems/common-nfs-mount-options_mounting-nfs-shares",target:"_blank",rel:"noopener noreferrer"},x=e(`<h4 id="_3-4-\u5378\u8F7D" tabindex="-1"><a class="header-anchor" href="#_3-4-\u5378\u8F7D" aria-hidden="true">#</a> 3.4 \u5378\u8F7D</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">umount</span> /home/zz

<span class="token comment"># \u82E5\u63D0\u793A umount.nfs4: /home/zz: device is busy</span>

<span class="token comment"># \u6267\u884C\u5982\u4E0B\u547D\u4EE4\uFF0C\u5F3A\u5236\u5378\u8F7D</span>
$ <span class="token function">umount</span> <span class="token parameter variable">-fl</span> /home/zz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-5-\u83B7\u53D6\u6302\u8F7D-nfs-\u5BA2\u6237\u7AEF" tabindex="-1"><a class="header-anchor" href="#_3-5-\u83B7\u53D6\u6302\u8F7D-nfs-\u5BA2\u6237\u7AEF" aria-hidden="true">#</a> 3.5 \u83B7\u53D6\u6302\u8F7D <code>nfs</code> \u5BA2\u6237\u7AEF:</h4><blockquote><p>\u67E5\u8BE2\u9ED8\u8BA4\u670D\u52A1\u7AEF\u53E3 <code>cat /etc/services| grep nfs</code></p></blockquote><ul><li><p>\u547D\u4EE4\u5FEB\u901F\u67E5: \uFF08<em>\u4E0D\u4E00\u5B9A\u597D\u7528</em>\uFF09</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ss <span class="token operator">|</span> <span class="token function">grep</span> :nfs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u4F7F\u7528 <strong>python</strong>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> psutil

<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;laddr&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>net<span class="token punctuation">.</span>laddr<span class="token punctuation">.</span>ip<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>net<span class="token punctuation">.</span>laddr<span class="token punctuation">.</span>port<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span>
        <span class="token string">&quot;raddr&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>net<span class="token punctuation">.</span>raddr<span class="token punctuation">.</span>ip<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>net<span class="token punctuation">.</span>raddr<span class="token punctuation">.</span>port<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> net <span class="token keyword">in</span> psutil<span class="token punctuation">.</span>net_connections<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> net<span class="token punctuation">.</span>laddr<span class="token punctuation">.</span>port <span class="token operator">==</span> <span class="token number">2049</span> <span class="token keyword">and</span>
    <span class="token builtin">isinstance</span><span class="token punctuation">(</span>net<span class="token punctuation">.</span>laddr<span class="token punctuation">,</span> psutil<span class="token punctuation">.</span>_common<span class="token punctuation">.</span>addr<span class="token punctuation">)</span> <span class="token keyword">and</span>
    <span class="token builtin">isinstance</span><span class="token punctuation">(</span>net<span class="token punctuation">.</span>raddr<span class="token punctuation">,</span> psutil<span class="token punctuation">.</span>_common<span class="token punctuation">.</span>addr<span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_4-v4-\u65E0\u6CD5\u76F4\u63A5\u6302\u8F7D\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_4-v4-\u65E0\u6CD5\u76F4\u63A5\u6302\u8F7D\u95EE\u9898" aria-hidden="true">#</a> 4. V4 \u65E0\u6CD5\u76F4\u63A5\u6302\u8F7D\u95EE\u9898</h3><p>\u7531\u4E8E <code>v4</code> \u7684\u6302\u8F7D\u548C <code>v3</code> \u4E0D\u540C\uFF0C\u8981\u5148\u5BFC\u51FA\u6839\u76EE\u5F55\uFF0C\u624D\u80FD\u6302\u5B50\u76EE\u5F55</p><p>\u82E5\u5E0C\u671B\u65E0\u9700\u5BFC\u51FA\u6839\u76EE\u5F55\uFF0C\u5B9E\u73B0\u7528\u6237\u901A\u8FC7 <code>v4</code> \u53EF\u81EA\u7531\u6302\u8F7D\u5B50\u76EE\u5F55\uFF0C\u5176\u89E3\u51B3\u529E\u6CD5\u5982\u4E0B\uFF1A</p>`,8),z=s("p",null,[n("\u4F7F\u7528 "),s("code",null,"--bind"),n(" \u5EFA\u7ACB\u6302\u8F7D\u94FE\u63A5")],-1),y={href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/deployment_guide/s1-nfs-server-config-exports",target:"_blank",rel:"noopener noreferrer"},q=e(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u82E5\u7528\u6237\u9700\u8981\u6302\u8F7D /share/Users/zz \u8FD9\u4E2A\u5B50\u76EE\u5F55:</span>
<span class="token function">mkdir</span> /exports/nfs/Users/zz

<span class="token comment"># \u4F7F\u7528 bind \u521B\u5EFA\u7ED1\u5B9A</span>
<span class="token function">mount</span> <span class="token parameter variable">--bind</span> /share/Users/zz /exports/nfs/Users/zz

<span class="token comment"># /etc/exports \u6587\u4EF6\u4E2D\u6DFB\u52A0\u5BFC\u51FA\uFF0C\u5982\uFF1A</span>
/exports/nfs/Users/zz		*<span class="token punctuation">(</span>fsid<span class="token operator">=</span><span class="token number">17</span>,async,root_squash,no_all_squash,anonuid<span class="token operator">=</span><span class="token number">65534</span>,anongid<span class="token operator">=</span><span class="token number">65534</span>,rw<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u6CE8\u610F\uFF1A</strong></p><ul><li>\u8C8C\u4F3C\u4E5F\u9700\u8981\u5148\u5BFC\u51FA\u5BF9\u5E94\u7684\u5B50\u76EE\u5F55\uFF0C\u624D\u80FD\u6302\u8F7D <code>bind</code> \u76EE\u5F55</li><li><code>fsid</code> \u82E5\u4E00\u81F4\uFF0C\u6709\u65E0\u5F71\u54CD\uFF0C\u6709\u53C2\u8003\u8BF4\u4F1A\u5F71\u54CD\u9AD8\u53EF\u7528\u3001\u6216\u51FA\u73B0\u4E0D\u540C\u76EE\u5F55 \u4F46\u540C\u4E00\u4E2A\u6302\u8F7D\u7684\u95EE\u9898</li><li>\u7528\u6B64\u65B9\u5F0F\uFF0C\u4F1A\u589E\u52A0\u5F00\u673A\u81EA\u52A8\u6302\u8F7D\u7B49\u6D41\u7A0B\u7684\u590D\u6742\u5EA6</li></ul></blockquote>`,2);function N(w,S){const t=i("ExternalLinkIcon"),p=i("Badge"),l=i("Alert");return c(),d("div",null,[m,s("p",null,[s("a",h,[n("NFS Export Config"),a(t)])]),v,s("p",null,[s("a",b,[n("exportfs \u547D\u4EE4"),a(t)]),n(" \uFF1A\u53EF\u4EE5\u5728\u4E0D\u76F4\u63A5\u7F16\u8F91 "),k,n(" \u6587\u4EF6\u7684\u60C5\u51B5\u4E0B\uFF0C\u4F7F "),_,n(" \u7528\u6237\u80FD\u591F\u6709\u9009\u62E9\u7684\u5BFC\u51FA\u6216\u53D6\u6D88\u5BFC\u51FA\u76EE\u5F55\uFF0C\u800C\u65E0\u9700\u91CD\u542F\u670D\u52A1")]),g,s("p",null,[s("a",f,[n("\u5E38\u7528\u6302\u8F7D\u9009\u9879"),a(t)])]),x,a(l,{type:"info"},{default:o(()=>[n(" \u9488\u5BF9 `NFSv4` \u7248\u672C `Linux` \u5BA2\u6237\u7AEF\u4E8C\u6B21\u5171\u4EAB: "),a(p,{type:"error"},{default:o(()=>[n("fsid")]),_:1}),n(" + "),a(p,{type:"info"},{default:o(()=>[n("bind")]),_:1})]),_:1}),z,s("p",null,[s("a",y,[n("\u53C2\u8003"),a(t)])]),q])}const U=r(u,[["render",N],["__file","NFS\u670D\u52A1.html.vue"]]);export{U as default};
