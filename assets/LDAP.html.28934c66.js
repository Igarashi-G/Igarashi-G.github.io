import{_ as d}from"./plugin-vueexport-helper.2444895f.js";import{o as u,c as v,e as m,a as s,b as n,d as a,w as l,f as i,r as c}from"./app.ba045285.js";const b="/assets/X500.862ccf77.png",k="/assets/DIT.dec5ada0.png",g="/assets/\u5206\u5E03\u5F0F.f3894712.png",h="/assets/LDAP.a0b37a7d.jpg",f="/assets/ssp.bff310ae.png",_="/assets/ldap\u52A0\u57DF\u8282\u70B9\u4FE1\u606F.4c24869f.png",y={},D=s("h1",{id:"ldap",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ldap","aria-hidden":"true"},"#"),n(" LDAP")],-1),x=s("p",null,[s("strong",null,"DAP\uFF08Directry Access Protocol\uFF09\uFF1A"),n(" \u5373\u76EE\u5F55\u8BBF\u95EE\u534F\u8BAE\uFF0C\u8F83\u8001\u3001\u590D\u6742\u4E14\u91CD\u91CF\u7EA7\uFF0C\u540E\u9762\u53C8\u51FA\u8F7B\u91CF\u7EA7\u3001\u66F4\u597D\u7528\u7684 "),s("strong",null,"LDAP")],-1),w=i('<h2 id="_1-x-500-\u534F\u8BAE" tabindex="-1"><a class="header-anchor" href="#_1-x-500-\u534F\u8BAE" aria-hidden="true">#</a> 1. X.500 \u534F\u8BAE</h2><h3 id="_1-1-\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#_1-1-\u6982\u8FF0" aria-hidden="true">#</a> 1.1 \u6982\u8FF0</h3><p><strong>X.500</strong> \u5B9A\u4E49\u4E86\u76EE\u5F55\u7CFB\u7EDF\uFF0C<strong>LDAP</strong> \u53EA\u662F\u5B83\u7684\u8F7B\u91CF\u7EA7\u5B9E\u73B0</p><h5 id="\u76EE\u5F55\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#\u76EE\u5F55\u7CFB\u7EDF" aria-hidden="true">#</a> <strong>\u76EE\u5F55\u7CFB\u7EDF</strong></h5><p><strong>Directory\uFF1A</strong> \u76EE\u5F55\u670D\u52A1\uFF0C\u65E8\u5728\u63D0\u4F9B\u4E00\u4E2A\u7528\u6237\u53CB\u597D\u7684 <code>name-address</code> \u7C7B\u7684\u6620\u5C04\uFF0C\u5176\u4E2D <code>name</code> \u4E0D\u53EF\u53D8\uFF0C<code>address</code> \u5141\u8BB8\u52A8\u6001\u53D8\u5316\uFF0C\u5373<code>key-value</code> \u7ED3\u6784</p><p><strong>DIB\uFF1A</strong> \u76EE\u5F55\u4FE1\u606F\u5E93\uFF0C\u7531\u4E00\u6279\u7CFB\u7EDF\u7EC4\u6210\uFF0C\u6BCF\u4E2A\u7CFB\u7EDF\u6301\u6709\u5BF9\u5E94\u73B0\u5B9E\u4E16\u754C\u7684\u903B\u8F91\u6570\u636E\uFF0C\u8FD9\u4E9B\u5B58\u50A8\u7684\u6570\u636E\u53EB\u505A <strong>DIB</strong></p><img src="'+b+'"><p>\u4E00\u4E2A\u6807\u51C6\u7684\u76EE\u5F55\u7CFB\u7EDF\uFF0C\u6709\u4EE5\u4E0B\u51E0\u90E8\u5206</p><ul><li>\u76EE\u5F55\u670D\u52A1</li><li>\u76EE\u5F55\u670D\u52A1\u7684\u7528\u6237</li><li>\u76EE\u5F55\u670D\u52A1\u7528\u6765\u66B4\u9732\u81EA\u5DF1\u7684\u8BBF\u95EE\u7AEF\u70B9</li><li>\u7528\u6237\u548C\u670D\u52A1\u4E4B\u95F4\u4F7F\u7528\u534F\u8BAE\u5982 LDAP \u8FDB\u884C\u4EA4\u4E92</li><li>\u7528\u6237\u4F7F\u7528 LDAP \u5BA2\u6237\u7AEF\u8BBF\u95EE\u76EE\u5F55\u670D\u52A1</li></ul><h3 id="_1-2-dib-\u4E0E-dit" tabindex="-1"><a class="header-anchor" href="#_1-2-dib-\u4E0E-dit" aria-hidden="true">#</a> 1.2 DIB \u4E0E DIT</h3><p><strong>DIB</strong> \u76EE\u5F55\u4FE1\u606F\u5E93\uFF0C\u7531 <strong>DIT</strong>\uFF08<em>\u76EE\u5F55\u4FE1\u606F\u6811</em>\uFF09\u3001\u8282\u70B9 <strong>Entry</strong>\u3001<strong>Entry</strong> \u4E2D\u7684\u5C5E\u6027\u53CA\u5C5E\u6027\u503C\u6784\u6210\uFF0C\u6811\u5F62\u7ED3\u6784</p><ul><li><strong>Entry</strong> \u4EE3\u8868\u4E00\u4E2A\u8282\u70B9\uFF0C\u7C7B\u578B\u53EF\u4EE5\u662F <code>object</code>\uFF0C\u4E5F\u53EF\u4EE5\u662F <code>alias</code> \u522B\u540D</li><li>\u4E00\u4E2A <strong>Entry</strong> \u5185\u53EF\u4EE5\u62E5\u6709\u591A\u4E2A\u5C5E\u6027</li><li>\u4E00\u4E2A\u5C5E\u6027\u5185\u53EF\u4EE5\u62E5\u6709\u4E00\u4E2A <strong>Type</strong>\uFF0C\u4EE5\u53CA\u591A\u4E2A <strong>Value</strong></li></ul><img src="'+k+'"><div class="custom-container tip"><p class="custom-container-title">\u63D0\u793A</p><p>\u6545\u8FD9\u79CD\u6811\u5F62\u5B58\u50A8\u7ED3\u6784\u9002\u7528\u4E8E\uFF0C\u67E5\u8BE2\u591A\u3001\u66F4\u65B0\u5C11</p></div><h3 id="_1-3-\u5206\u5E03\u5F0F-directory" tabindex="-1"><a class="header-anchor" href="#_1-3-\u5206\u5E03\u5F0F-directory" aria-hidden="true">#</a> 1.3 \u5206\u5E03\u5F0F Directory</h3><p><strong>Directory</strong> \u652F\u6301\u5206\u5E03\u5F0F\u64CD\u4F5C\uFF0C\u6B64\u65F6\u7684\u670D\u52A1\u7AEF\u7EC4\u6210\u5982\u4E0B</p><img src="'+g+'"><p><strong>DSA\uFF08<em>Directory System Agent</em>\uFF09\uFF1A</strong> \u7528\u6765\u8FDE\u63A5\u670D\u52A1\u548C <strong>DUA</strong>\u3002\u4ED6\u53EF\u4EE5\u7F13\u5B58 <strong>Directory</strong> \u6570\u636E\uFF0C\u53EF\u4EE5\u7528\u672C\u5730\u6570\u636E\u76F4\u63A5\u54CD\u5E94\uFF0C\u4E5F\u53EF\u4EE5\u5355\u7EAF\u505A\u4E00\u4E2A\u8F6C\u53D1</p><p><strong>LDAP Server</strong>\uFF1A\u662F <strong>Directory Service</strong> \u7684\u4E00\u90E8\u5206\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u672C\u5730\u6570\u636E\uFF0C\u4E5F\u53EF\u4EE5\u8F6C\u53D1\u5230\u5176\u5B83 <strong>LDAP Server</strong> \u83B7\u53D6\u6570\u636E</p><h2 id="_2-ldap-\u534F\u8BAE" tabindex="-1"><a class="header-anchor" href="#_2-ldap-\u534F\u8BAE" aria-hidden="true">#</a> 2. LDAP \u534F\u8BAE</h2><p><strong>LDAP \u534F\u8BAE\uFF1A</strong> \u662F <strong>\u8F7B\u91CF\u7EA7\u7684\u76EE\u5F55\u8BBF\u95EE\u534F\u8BAE</strong>\uFF0C\u5176\u4E2D</p><ul><li><p><strong>L\uFF08<em>LightWeight</em>\uFF09\uFF1A</strong> \u8F7B\u91CF\u7EA7</p></li><li><p><strong>D\uFF08<em>Directory</em>\uFF09\uFF1A</strong> \u76EE\u5F55</p></li><li><p><strong>AP\uFF08<em>Access Protocol</em>\uFF09\uFF1A</strong> \u5B58\u53D6\u534F\u8BAE</p></li></ul><p>\u662F <strong>\u8BFB\u6027\u80FD\u9AD8\uFF0C\u5199\u6027\u80FD\u4F4E\u4E14\u6CA1\u6709\u56DE\u6EDA\u673A\u5236</strong> \u7684\u6570\u636E\u5B58\u50A8\u534F\u8BAE\uFF0C\u4E0D\u662F\u6570\u636E\u5E93\uFF0C\u6CA1\u6709\u6570\u636E\u5E93\u8FD9\u4E48\u5F3A\u5927\uFF0C\u800C\u662F\u4E00\u4E2A\u6811\u72B6\u7ED3\u6784\u7684\u76EE\u5F55\uFF0C\u6BCF\u4E2A\u53F6\u5B50\u90FD\u662F\u7531\u4E00\u6761\u4E00\u6761\u7684\u5206\u6210\u82E5\u5E72\u533A\u57DF\u7684\u8BB0\u5F55</p><img src="'+h+'"><h3 id="_2-1-\u6982\u5FF5\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#_2-1-\u6982\u5FF5\u8BF4\u660E" aria-hidden="true">#</a> 2.1 \u6982\u5FF5\u8BF4\u660E</h3><p><strong>Entry\uFF1A</strong> \u6700\u5C0F\u5355\u5143 (<em>\u5BF9\u8C61</em>\uFF09</p><p><strong>LDIF\uFF1A</strong> \u4E0A\u6587 <strong>Entry</strong> \u7684\u7EAF\u6587\u672C\u8868\u793A\u6587\u4EF6</p><p><strong>Schema\uFF1A</strong> \u6A21\u5F0F\uFF08<em>\u5BF9\u8C61\u7C7B\u7684\u96C6\u5408</em>\uFF09\u5BF9\u5C5E\u6027\u505A\u4E86\u9650\u5236</p><p><strong>attribute\uFF1A</strong> \u57FA\u672C\u5BF9\u8C61\u7684\u5C5E\u6027</p><p><strong>ObjectClass\uFF1A</strong> \u5C5E\u6027\u96C6\u5408\uFF08<em>\u57FA\u672C\u5BF9\u8C61\u7684\u7EE7\u627F\u5C5E\u6027</em>\uFF09</p><p><strong>backend &amp; database</strong></p><p><a href="./AD">\u5C5E\u6027\u8BF4\u660E - \u53C2\u8003 AD</a></p>',32),A={href:"https://blog.csdn.net/zou8944/article/details/122287398",target:"_blank",rel:"noopener noreferrer"},q=s("h2",{id:"_3-\u642D\u5EFA-ldap\u670D\u52A1\u7AEF",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_3-\u642D\u5EFA-ldap\u670D\u52A1\u7AEF","aria-hidden":"true"},"#"),n(" 3. \u642D\u5EFA LDAP\u670D\u52A1\u7AEF")],-1),L={href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system-level_authentication_guide/openldap",target:"_blank",rel:"noopener noreferrer"},P={href:"http://www.openldap.org/",target:"_blank",rel:"noopener noreferrer"},S=s("strong",null,"LDAP",-1),$=s("strong",null,"openldap-server",-1),N=s("strong",null,"Berkeley DB",-1),O=s("strong",null,"MySQL",-1),E=s("p",null,[s("strong",null,"\u5173\u95ED selinux \u548C\u9632\u706B\u5899")],-1),I=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("setenforce "),s("span",{class:"token number"},"0"),n(`
`),s("span",{class:"token function"},"sed"),n(),s("span",{class:"token parameter variable"},"-i"),n(),s("span",{class:"token string"},"'/SELINUX/s/enforcing/disabled/'"),n(` /etc/selinux/config
systemctl disable firewalld.service `),s("span",{class:"token operator"},"&&"),n(` systemctl stop firewalld.service
systemctl stop NetworkManager `),s("span",{class:"token operator"},"&&"),n(` systemctl disable NetworkManager
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),T=s("p",null,[s("strong",null,"\u6309\u9700\u6362\u6E90")],-1),R=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[s("span",{class:"token function"},"sed"),n(),s("span",{class:"token parameter variable"},"-e"),n(),s("span",{class:"token string"},"'s!^#baseurl=!baseurl=!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
       `),s("span",{class:"token parameter variable"},"-e"),n("  "),s("span",{class:"token string"},"'s!^mirrorlist=!#mirrorlist=!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
       `),s("span",{class:"token parameter variable"},"-e"),n(),s("span",{class:"token string"},"'s!mirror.centos.org!mirrors.ustc.edu.cn!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
       `),s("span",{class:"token parameter variable"},"-i"),n(`  /etc/yum.repos.d/CentOS-Base.repo

yum `),s("span",{class:"token function"},"install"),n(),s("span",{class:"token parameter variable"},"-y"),n(` epel-release
`),s("span",{class:"token function"},"sed"),n(),s("span",{class:"token parameter variable"},"-e"),n(),s("span",{class:"token string"},"'s!^mirrorlist=!#mirrorlist=!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
	`),s("span",{class:"token parameter variable"},"-e"),n(),s("span",{class:"token string"},"'s!^#baseurl=!baseurl=!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
	`),s("span",{class:"token parameter variable"},"-e"),n(),s("span",{class:"token string"},"'s!^metalink!#metalink!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
	`),s("span",{class:"token parameter variable"},"-e"),n(),s("span",{class:"token string"},"'s!//download\\.fedoraproject\\.org/pub!//mirrors.ustc.edu.cn!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
	`),s("span",{class:"token parameter variable"},"-e"),n(),s("span",{class:"token string"},"'s!http://mirrors\\.ustc!https://mirrors.ustc!g'"),n(),s("span",{class:"token punctuation"},"\\"),n(`
	`),s("span",{class:"token parameter variable"},"-i"),n(` /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel-testing.repo
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),B=s("p",null,[s("strong",null,"\u540C\u6B65\u65F6\u95F4")],-1),j=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("yum "),s("span",{class:"token function"},"install"),n(),s("span",{class:"token parameter variable"},"-y"),n(` ntpdate ntp
ntpdate `),s("span",{class:"token number"},"0"),n(`.cn.pool.ntp.org
hwclock `),s("span",{class:"token parameter variable"},"--systohc"),n(`
`),s("span",{class:"token function"},"cat"),n(),s("span",{class:"token operator"},"<<"),n("EOF"),s("span",{class:"token operator"},">>"),n(` /etc/ntp.conf
driftfile /var/lib/ntp/drift
server `),s("span",{class:"token number"},"0"),n(`.cn.pool.ntp.org
server `),s("span",{class:"token number"},"1"),n(`.cn.pool.ntp.org
server `),s("span",{class:"token number"},"2"),n(`.cn.pool.ntp.org
server `),s("span",{class:"token number"},"3"),n(`.cn.pool.ntp.org
EOF

systemctl `),s("span",{class:"token builtin class-name"},"enable"),n(" ntpd  "),s("span",{class:"token operator"},"&&"),n(` systemctl start ntpd
ntpq `),s("span",{class:"token parameter variable"},"-p"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),H=s("p",null,[s("strong",null,"\u5B89\u88C5 OpenLDAP")],-1),M=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("yum "),s("span",{class:"token parameter variable"},"-y"),n(),s("span",{class:"token function"},"install"),n(` openldap compat-openldap openldap-clients openldap-servers openldap-servers-sql openldap-devel migrationtools
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),F=s("p",null,[s("strong",null,"\u67E5\u770B OpenLDAP \u7248\u672C")],-1),z=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("slapd "),s("span",{class:"token parameter variable"},"-VV"),n(`
@`),s("span",{class:"token punctuation"},"("),s("span",{class:"token comment"},"#) $OpenLDAP: slapd 2.4.44 (Feb 23 2022 17:11:27) $"),n(`
	mockbuild@x86-01.bsys.centos.org:/builddir/build/BUILD/openldap-2.4.44/openldap-2.4.44/servers/slapd
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),V=s("p",null,[s("strong",null,"OpenLDAP"),n(" \u76F8\u5173\u914D\u7F6E\u6587\u4EF6\u4FE1\u606F")],-1),C=s("ul",null,[s("li",null,[s("code",null,"/etc/openldap/slapd.conf\uFF1A"),n(),s("strong",null,"OpenLDAP"),n(" \u4E3B\u914D\u7F6E\u6587\u4EF6\uFF0C\u8BB0\u5F55\u6839\u57DF\u4FE1\u606F\uFF0C\u7BA1\u7406\u5458\u540D\u79F0\uFF0C\u5BC6\u7801\uFF0C\u65E5\u5FD7\uFF0C\u6743\u9650\u7B49")]),s("li",null,[s("code",null,"/etc/openldap/slapd.d/*\uFF1A"),n(" \u8FD9\u4E0B\u9762\u662F "),s("code",null,"/etc/openldap/slapd.conf"),n(" \u914D\u7F6E\u4FE1\u606F\u751F\u6210\u7684\u6587\u4EF6\uFF0C\u6BCF\u4FEE\u6539\u4E00\u6B21\u914D\u7F6E\u4FE1\u606F\uFF0C\u8FD9\u91CC\u7684\u4E1C\u897F\u5C31\u8981\u91CD\u65B0\u751F\u6210")]),s("li",null,[s("code",null,"/etc/openldap/schema/*\uFF1A"),n(),s("strong",null,"OpenLDAP"),n(" \u7684 "),s("strong",null,"schema"),n(" \u5B58\u653E\u7684\u5730\u65B9")]),s("li",null,[s("code",null,"/var/lib/ldap/*\uFF1A"),n(),s("strong",null,"OpenLDAP"),n(" \u7684\u6570\u636E\u6587\u4EF6")]),s("li",null,[s("code",null,"/usr/share/openldap-servers/DB_CONFIG.example\uFF1A"),n(" \u6A21\u677F\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6")])],-1),U=s("p",null,[s("strong",null,"OpenLDAP"),n(" \u76D1\u542C\u7684\u7AEF\u53E3")],-1),W=s("ul",null,[s("li",null,[n("\u9ED8\u8BA4\u76D1\u542C\u7AEF\u53E3\uFF1A"),s("strong",null,"389"),n("\uFF08"),s("em",null,"\u660E\u6587\u6570\u636E\u4F20\u8F93"),n("\uFF09")]),s("li",null,[n("\u52A0\u5BC6\u76D1\u542C\u7AEF\u53E3\uFF1A"),s("strong",null,"636"),n("\uFF08"),s("em",null,"\u5BC6\u6587\u6570\u636E\u4F20\u8F93"),n("\uFF09")])],-1),X=s("p",null,[n("\u542F\u52A8 "),s("strong",null,"slapd"),n(" \u670D\u52A1")],-1),G=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n(`systemctl start slapd
systemctl `),s("span",{class:"token builtin class-name"},"enable"),n(` slapd
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),Z=i(`<h3 id="_3-1-\u914D\u7F6E-openldap" tabindex="-1"><a class="header-anchor" href="#_3-1-\u914D\u7F6E-openldap" aria-hidden="true">#</a> 3.1 \u914D\u7F6E OpenLDAP</h3><h5 id="\u914D\u7F6Eopenldap\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6Eopenldap\u6570\u636E\u5E93" aria-hidden="true">#</a> <strong>\u914D\u7F6EOpenLDAP\u6570\u636E\u5E93</strong></h5><p><strong>OpenLDAP</strong> \u9ED8\u8BA4\u4F7F\u7528 <strong>BerkeleyDB</strong>\uFF0C\u5982\u4E0B\u547D\u4EE4\u914D\u7F6E\u6570\u636E\u5E93</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u751F\u6210 ldap \u7BA1\u7406\u5458\u5BC6\u7801</strong> \uFF08<em>\u521D\u59CB\u5316\u540E\u9ED8\u8BA4\u7A7A\u5BC6\u7801</em> \uFF09</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>slappasswd <span class="token parameter variable">-s</span> user@dev
<span class="token punctuation">{</span>SSHA<span class="token punctuation">}</span>rEXQDROfAHRMoZS1TnFTZBsNL+387ogk
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4FEE\u6539 olcDatabase={2}hdb.ldif \u6587\u4EF6</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> /etc/openldap/slapd.d/cn<span class="token punctuation">\\</span><span class="token operator">=</span>config/olcDatabase<span class="token punctuation">\\</span><span class="token operator">=</span><span class="token punctuation">\\</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">\\</span><span class="token punctuation">}</span>hdb.ldif

olcSuffix: <span class="token assign-left variable">dc</span><span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local
olcRootDN: <span class="token assign-left variable">cn</span><span class="token operator">=</span>cloud,dc<span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local
olcRootPW: <span class="token punctuation">{</span>SSHA<span class="token punctuation">}</span>rEXQDROfAHRMoZS1TnFTZBsNL+387ogk
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4FEE\u6539olcDatabase={1}monitor.ldif\u6587\u4EF6</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> /etc/openldap/slapd.d/cn<span class="token punctuation">\\</span><span class="token operator">=</span>config/olcDatabase<span class="token punctuation">\\</span><span class="token operator">=</span><span class="token punctuation">\\</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">\\</span><span class="token punctuation">}</span>monitor.ldif

olcAccess: <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>to * by <span class="token assign-left variable">dn.base</span><span class="token operator">=</span><span class="token string">&quot;gidNumber=0+uidNumber=0,cn=peercred,cn=extern
 al,cn=auth&quot;</span> <span class="token builtin class-name">read</span> by <span class="token assign-left variable">dn.base</span><span class="token operator">=</span><span class="token string">&quot;cn=cloud,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token builtin class-name">read</span> by * none
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5176\u4E2D <code>dn.base</code> \u662F\u4FEE\u6539 <strong>OpenLDAP</strong> \u7684\u7BA1\u7406\u5458\u4FE1\u606F\u7684</p><p><strong>\u9A8C\u8BC1 OpenLDAP \u7684\u57FA\u672C\u914D\u7F6E</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>slaptest <span class="token parameter variable">-u</span>
5d30769d ldif_read_file: checksum error on <span class="token string">&quot;/etc/openldap/slapd.d/cn=config/olcDatabase={1}monitor.ldif&quot;</span>
5d30769d ldif_read_file: checksum error on <span class="token string">&quot;/etc/openldap/slapd.d/cn=config/olcDatabase={2}hdb.ldif&quot;</span>
config <span class="token function">file</span> testing succeeded
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u6821\u9A8Cerror\u8BF7\u5FFD\u7565</p></blockquote><p><strong>\u4FEE\u6539ldap\u6587\u4EF6\u6743\u9650</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">chown</span> <span class="token parameter variable">-R</span> ldap:ldap /var/lib/ldap/
<span class="token function">chown</span> <span class="token parameter variable">-R</span> ldap:ldap /etc/openldap/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u542F\u52A8\u5E76\u67E5\u770B</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl start slapd
systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> slapd
systemctl status slapd.service

ss <span class="token parameter variable">-natup</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">389</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>       *:389                   *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;slapd&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">1773</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">))</span></span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>      :::389                  :::*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;slapd&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">1773</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">))</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5BFC\u5165\u57FA\u672C Schema</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u9884\u751F\u6210\u7684 ldif \u6587\u4EF6</span>
ll /etc/openldap/schema

ldapadd <span class="token parameter variable">-Y</span> EXTERNAL <span class="token parameter variable">-H</span> ldapi:/// <span class="token parameter variable">-f</span> /etc/openldap/schema/cosine.ldif
ldapadd <span class="token parameter variable">-Y</span> EXTERNAL <span class="token parameter variable">-H</span> ldapi:/// <span class="token parameter variable">-f</span> /etc/openldap/schema/nis.ldif
ldapadd <span class="token parameter variable">-Y</span> EXTERNAL <span class="token parameter variable">-H</span> ldapi:/// <span class="token parameter variable">-f</span> /etc/openldap/schema/inetorgperson.ldif

<span class="token comment"># \u6CE8\u610F\uFF01\uFF01\u52A0\u57DF\u5FC5\u987B\u8981\u5982\u4E0Bldif \u6587\u4EF6</span>
ldapadd <span class="token parameter variable">-Y</span> EXTERNAL <span class="token parameter variable">-H</span> ldapi:/// <span class="token parameter variable">-f</span> /etc/openldap/schema/samba.ldif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4FEE\u6539 migrate_common.ph \u6587\u4EF6</strong></p><p>\u6539\u6587\u4EF6\u4E3B\u8981\u7528\u4E8E\u751F\u6210 <strong>ldif</strong> \u6587\u4EF6\u4F7F\u7528\uFF0C\u4FEE\u6539\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> /usr/share/migrationtools/migrate_common.ph +71

<span class="token comment"># Default DNS domain</span>
<span class="token variable">$DEFAULT_MAIL_DOMAIN</span> <span class="token operator">=</span> <span class="token string">&quot;uit.ldevops.local&quot;</span><span class="token punctuation">;</span>

<span class="token comment"># Default base </span>
<span class="token variable">$DEFAULT_BASE</span> <span class="token operator">=</span> <span class="token string">&quot;dc=uit,dc=ldevops,dc=local&quot;</span><span class="token punctuation">;</span>

<span class="token variable">$EXTENDED_SCHEMA</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u751F\u6210 base.ldif</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> /root/openldap
/usr/share/migrationtools/migrate_base.pl <span class="token operator">&gt;</span>/root/openldap/base.ldif

ldapadd <span class="token parameter variable">-x</span> <span class="token parameter variable">-D</span> <span class="token string">&quot;cn=cloud,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token parameter variable">-w</span> user@dev <span class="token parameter variable">-f</span> /root/openldap/base.ldif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6DFB\u52A0\u7528\u6237\u53CA\u7528\u6237\u7EC4</strong></p><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B <strong>OpenLDAP</strong> \u6CA1\u6709\u666E\u901A\u7528\u6237\u7684\uFF0C\u4F46\u6709\u4E2A\u7BA1\u7406\u5458\u7528\u6237\uFF0C\u5373\u521A\u914D\u7F6E\u7684 <strong>root</strong></p><p>\u73B0\u5728\u6211\u4EEC\u628A\u7CFB\u7EDF\u4E2D\u7684\u7528\u6237\uFF0C\u6DFB\u52A0\u5230 <strong>OpenLDAP</strong> \u4E2D\uFF0C\u4E3A\u4E86\u8FDB\u884C\u533A\u5206\uFF0C\u65B0\u52A0\u4E24\u4E2A\u7528\u6237 <strong>ldapuser1</strong> \u548C <strong>ldapuser2</strong>\uFF0C\u548C\u4E24\u4E2A\u7528\u6237\u7EC4 <strong>ldapgroup1</strong> \u548C <strong>ldapgroup2</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">groupadd</span> ldapgroup1
<span class="token function">groupadd</span> ldapgroup2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6DFB\u52A0\u7528\u6237\u5E76\u8BBE\u7F6E\u5BC6\u7801</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">useradd</span> <span class="token parameter variable">-g</span> ldapgroup1 ldapuser1
<span class="token function">useradd</span> <span class="token parameter variable">-g</span> ldapgroup2 ldapuser2
<span class="token builtin class-name">echo</span> <span class="token string">&#39;123456&#39;</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> ldapuser1
<span class="token builtin class-name">echo</span> <span class="token string">&#39;123456&#39;</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> ldapuser2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06 \u7528\u6237 \u548C \u7528\u6237\u7EC4\u63D0\u53D6\u51FA\u6765\uFF0C\u5305\u62EC\u8BE5\u7528\u6237\u7684\u5BC6\u7801\u548C\u5176\u4ED6\u76F8\u5173\u5C5E\u6027</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">grep</span> <span class="token string">&quot;:10[0-9][0-9]&quot;</span> /etc/passwd <span class="token operator">&gt;</span> /root/openldap/users
<span class="token function">grep</span> <span class="token string">&quot;:10[0-9][0-9]&quot;</span> /etc/group <span class="token operator">&gt;</span> /root/openldap/groups
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6839\u636E\u4E0A\u8FF0\u751F\u6210\u7684 \u7528\u6237 \u548C \u7528\u6237\u7EC4 \u5C5E\u6027\uFF0C\u4F7F\u7528 <strong>migrate_passwd.pl</strong> \u6587\u4EF6\u751F\u6210\u5BF9\u5E94\u7684 <strong>ldif</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>/usr/share/migrationtools/migrate_group.pl /root/openldap/groups <span class="token operator">&gt;</span> /root/openldap/groups.ldif
/usr/share/migrationtools/migrate_passwd.pl /root/openldap/users <span class="token operator">&gt;</span> /root/openldap/users.ldif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5BFC\u5165\u7528\u6237\u53CA\u7528\u6237\u7EC4\u5230OpenLDAP\u6570\u636E\u5E93</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ldapadd <span class="token parameter variable">-x</span> <span class="token parameter variable">-w</span> <span class="token string">&quot;user@dev&quot;</span> <span class="token parameter variable">-D</span> <span class="token string">&quot;cn=cloud,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token parameter variable">-f</span> /root/openldap/groups.ldif
ldapadd <span class="token parameter variable">-x</span> <span class="token parameter variable">-w</span> <span class="token string">&quot;user@dev&quot;</span> <span class="token parameter variable">-D</span> <span class="token string">&quot;cn=cloud,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token parameter variable">-f</span> /root/openldap/users.ldif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u628AOpenLDAP\u7528\u6237\u52A0\u5165\u5230\u7528\u6237\u7EC4</strong></p><p>\u5C3D\u7BA1\u5DF2\u7ECF\u628A\u7528\u6237\u548C\u7528\u6237\u7EC4\u4FE1\u606F\uFF0C\u5BFC\u5165\u5230 <strong>OpenLDAP</strong> \u6570\u636E\u5E93\u4E2D\u4E86\uFF0C\u4F46\u5B9E\u9645\u4E0A <strong>\u7528\u6237 \u548C \u7528\u6237\u7EC4\u4E4B\u95F4\u6CA1\u6709\u4EFB\u4F55\u5173\u8054</strong> \uFF0C\u5173\u8054\u9700\u53E6\u5916\u5355\u72EC\u914D\u7F6E</p><p>\u628A <strong>ldapuser1</strong> \u7528\u6237\u52A0\u5165\u5230 <strong>ldapgroup1</strong> \u7528\u6237\u7EC4\uFF0C\u9700\u8981\u65B0\u5EFA\u6DFB\u52A0\u7528\u6237\u5230\u7528\u6237\u7EC4\u7684 <strong>ldif</strong> \u6587\u4EF6\uFF0C\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span> /root/openldap/add_user_to_groups.ldif <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;EOF&quot;
dn: cn=ldapgroup1,ou=Group,dc=uit,dc=ldevops,dc=local
changetype: modify
add: memberuid
memberuid: ldapuser1

dn: cn=ldapgroup2,ou=Group,dc=uit,dc=ldevops,dc=local
changetype: modify
add: memberuid
memberuid: ldapuser2
EOF</span>

ldapadd <span class="token parameter variable">-x</span> <span class="token parameter variable">-w</span> <span class="token string">&quot;user@dev&quot;</span> <span class="token parameter variable">-D</span> <span class="token string">&quot;cn=cloud,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token parameter variable">-f</span> /root/openldap/add_user_to_groups.ldif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u67E5\u8BE2\u6D4B\u8BD5</strong> \u521A\u624D\u6DFB\u52A0\u7684 <strong>OpenLDAP</strong> \u7528\u6237\u7EC4\u4FE1\u606F\uFF0C\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ldapsearch <span class="token parameter variable">-LLL</span> <span class="token parameter variable">-x</span> <span class="token parameter variable">-D</span> <span class="token string">&quot;cn=cloud,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token parameter variable">-w</span> <span class="token string">&quot;user@dev&quot;</span> <span class="token parameter variable">-b</span> <span class="token string">&quot;dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token string">&quot;cn=ldapgroup1&quot;</span>

dn: <span class="token assign-left variable">cn</span><span class="token operator">=</span>ldapgroup1,ou<span class="token operator">=</span>Group,dc<span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local
objectClass: posixGroup
objectClass: <span class="token function">top</span>
cn: ldapgroup1
userPassword:: <span class="token assign-left variable">e2NyeXB0fXg</span><span class="token operator">=</span>
gidNumber: <span class="token number">1002</span>
memberUid: ldapuser1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-\u5F00\u542F-openldap-\u65E5\u5FD7\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#_3-2-\u5F00\u542F-openldap-\u65E5\u5FD7\u8BBF\u95EE" aria-hidden="true">#</a> 3.2 \u5F00\u542F OpenLDAP \u65E5\u5FD7\u8BBF\u95EE</h3><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B <strong>OpenLDAP</strong> \u672A\u542F\u7528\u65E5\u5FD7\u8BB0\u5F55\u529F\u80FD\uFF0C\u4F46\u5B9E\u9645\u4F7F\u7528\u8FC7\u7A0B\u4E2D\uFF0C\u5B9A\u4F4D\u95EE\u9898\u9700\u8981\u4F7F\u7528 <strong>OpenLDAP</strong> \u65E5\u5FD7</p><p>\u65B0\u5EFA\u65E5\u5FD7\u914D\u7F6E <strong>ldif</strong> \u6587\u4EF6\uFF0C\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span> /root/openldap/loglevel.ldif <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
dn: cn=config
changetype: modify
replace: olcLogLevel
olcLogLevel: stats
EOF</span>

ldapmodify <span class="token parameter variable">-Y</span> EXTERNAL <span class="token parameter variable">-H</span> ldapi:/// <span class="token parameter variable">-f</span> /root/openldap/loglevel.ldif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539 <strong>rsyslog</strong> \u914D\u7F6E\u6587\u4EF6\uFF0C\u5E76\u91CD\u542F\u670D\u52A1\uFF0C\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/rsyslog.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
local4.* /var/log/slapd.log
EOF</span>

systemctl restart rsyslog
systemctl restart slapd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528 <strong>ldapuser1</strong> \u8BA4\u8BC1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ldapwhoami <span class="token parameter variable">-x</span> <span class="token parameter variable">-D</span> <span class="token assign-left variable">uid</span><span class="token operator">=</span>ldapuser1,ou<span class="token operator">=</span>People,dc<span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local <span class="token parameter variable">-w</span> <span class="token number">123456</span>

dn:uid<span class="token operator">=</span>ldapuser1,ou<span class="token operator">=</span>People,dc<span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u770B <strong>OpenLDAP</strong> \u65E5\u5FD7</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">tail</span> /var/log/slapd.log

Nov  <span class="token number">1</span> <span class="token number">10</span>:24:55 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1006</span> <span class="token assign-left variable">fd</span><span class="token operator">=</span><span class="token number">11</span> closed
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">fd</span><span class="token operator">=</span><span class="token number">11</span> ACCEPT from <span class="token assign-left variable">IP</span><span class="token operator">=</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:56602 <span class="token punctuation">(</span>IP<span class="token operator">=</span><span class="token punctuation">[</span>::<span class="token punctuation">]</span>:389<span class="token punctuation">)</span>
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">op</span><span class="token operator">=</span><span class="token number">0</span> BIND <span class="token assign-left variable">dn</span><span class="token operator">=</span><span class="token string">&quot;uid=ldapuser1,ou=People,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token assign-left variable">method</span><span class="token operator">=</span><span class="token number">128</span>
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">op</span><span class="token operator">=</span><span class="token number">0</span> BIND <span class="token assign-left variable">dn</span><span class="token operator">=</span><span class="token string">&quot;uid=ldapuser1,ou=People,dc=uit,dc=ldevops,dc=local&quot;</span> <span class="token assign-left variable">mech</span><span class="token operator">=</span>SIMPLE <span class="token assign-left variable">ssf</span><span class="token operator">=</span><span class="token number">0</span>
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">op</span><span class="token operator">=</span><span class="token number">0</span> RESULT <span class="token assign-left variable">tag</span><span class="token operator">=</span><span class="token number">97</span> <span class="token assign-left variable">err</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">text</span><span class="token operator">=</span>
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">op</span><span class="token operator">=</span><span class="token number">1</span> EXT <span class="token assign-left variable">oid</span><span class="token operator">=</span><span class="token number">1.3</span>.6.1.4.1.4203.1.11.3
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">op</span><span class="token operator">=</span><span class="token number">1</span> WHOAMI
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">op</span><span class="token operator">=</span><span class="token number">1</span> RESULT <span class="token assign-left variable">oid</span><span class="token operator">=</span> <span class="token assign-left variable">err</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">text</span><span class="token operator">=</span>
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">op</span><span class="token operator">=</span><span class="token number">2</span> UNBIND
Nov  <span class="token number">1</span> <span class="token number">10</span>:25:12 <span class="token punctuation">[</span>localhost<span class="token punctuation">]</span> slapd<span class="token punctuation">[</span><span class="token number">30924</span><span class="token punctuation">]</span>: <span class="token assign-left variable">conn</span><span class="token operator">=</span><span class="token number">1007</span> <span class="token assign-left variable">fd</span><span class="token operator">=</span><span class="token number">11</span> closed
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#_3-3-\u8BF4\u660E" aria-hidden="true">#</a> 3.3 \u8BF4\u660E</h3><h4 id="\u914D\u7F6E-ldif-\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E-ldif-\u6587\u4EF6" aria-hidden="true">#</a> \u914D\u7F6E LDIF \u6587\u4EF6</h4><p><strong>.ldif</strong> \u914D\u7F6E\u6587\u4EF6\uFF0C\u901A\u5E38\u7528\u6765\u8FDB\u884C\u6570\u636E\u6DFB\u52A0\u3001\u521D\u59CB\u5316\u7B49\uFF08<em>\u624B\u52A8\u7F16\u8F91\u6548\u7387\u4F4E\u56E0\u6B64\u901A\u5E38\u7528\u4E0A\u6587\u7684\u5DE5\u5177</em>\uFF09\uFF0C\u6587\u4EF6\u5185\u5BB9\u7C7B\u4F3C\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5047\u8BBE\u8981\u521B\u5EFA\u4E00\u4E2A\u540D\u4E3A uit.ldevops.local.ldif \u7684ldif \u6587\u4EF6\uFF0C\u5185\u5BB9\u5982\u4E0B</span>
<span class="token function">vim</span> uit.ldevops.local.ldif

<span class="token comment"># \u521B\u5EFA\u540D\u4E3A uit.ldevops.local \u7684 top\u6839\u57DF</span>
dn: <span class="token assign-left variable">dc</span><span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local			<span class="token comment"># \u6761\u76EE\u6807\u8BC6</span>
objectclass: <span class="token function">top</span>						<span class="token comment"># \u5BF9\u8C61\u7C7B\u578B\u4E3A \u9876\u7EA7 \u5373\u6839</span>
objectclass: domain						<span class="token comment"># \u5BF9\u8C61\u7C7B\u578B\u4E3A \u57DF</span>
objectclass: dcobject					
objectclass: organization				
dc: uit									<span class="token comment"># \u5FC5\u987B\u5B9A\u4E49\u5C5E\u6027dc</span>
o: uit									<span class="token comment"># \u5FC5\u987B\u5B9A\u4E49\u5C5E\u6027 o</span>

<span class="token comment"># \u521B\u5EFA\u540D\u4E3A cloud \u7684\u7EC4\u7EC7 ou</span>
dn: <span class="token assign-left variable">ou</span><span class="token operator">=</span>cloud,dc<span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local
ou: cloud
objectclass: organizationalUnit			<span class="token comment"># ou \u7EC4\u7EC7</span>

<span class="token comment"># \u521B\u5EFA\u540D\u4E3A admin \u7684 person \u7528\u6237</span>
dn: <span class="token assign-left variable">cn</span><span class="token operator">=</span>admin,ou<span class="token operator">=</span>cloud,dc<span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local
cn: admin
sn: admin
objectclass: person						<span class="token comment"># person \u7C7B\u578B\u7684\u7528\u6237</span>

<span class="token comment"># \u521B\u5EFA\u540D\u4E3A zz \u7684 person \u7528\u6237</span>
dn: <span class="token assign-left variable">cn</span><span class="token operator">=</span>zz,ou<span class="token operator">=</span>cloud,dc<span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldevops,dc<span class="token operator">=</span>local
cn: zz
sn: zz
objectclass: person
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>dn</strong> \u662F\u4E3B\u952E\uFF0C\u8981\u552F\u4E00\uFF0C\u8981\u786E\u4FDD\u8FD9\u4E9B\u6570\u636E\u4E0D\u80FD\u4E0E\u5DF2\u6709\u6570\u636E\u76F8\u540C\uFF0C\u5426\u5219\u64CD\u4F5C\u4E2D\u65AD</li></ul><p>\u6709\u4E86 <strong>.ldif</strong> \u6587\u4EF6\uFF0C\u5C31\u53EF\u4EE5\u5C06\u5176\u6DFB\u52A0\u5230 <strong>\u76EE\u5F55\u6570\u636E\u5E93</strong>\uFF0C\u5BFC\u5165\u5230 <strong>LDAP</strong>\uFF0C\u5176\u521B\u5EFA\u7684\u5C42\u7EA7\u7ED3\u6784\uFF0C\u7C7B\u4F3C\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>                 +-------------------------------+
                 <span class="token operator">|</span>  <span class="token assign-left variable">dc</span><span class="token operator">=</span>uit,dc<span class="token operator">=</span>ldeveops,dc<span class="token operator">=</span>local  <span class="token operator">|</span>
                 +-------------------------------+
                 <span class="token operator">|</span>
                 <span class="token function">v</span>
        +--------+--+
        <span class="token operator">|</span><span class="token assign-left variable">ou</span><span class="token operator">=</span>cloud<span class="token operator">|</span>
        +-+------+--+
          <span class="token operator">|</span>      <span class="token operator">|</span>
          <span class="token function">v</span>      <span class="token function">v</span>
   +------+-+   ++----+
   <span class="token operator">|</span><span class="token assign-left variable">cn</span><span class="token operator">=</span>admin<span class="token operator">|</span>   <span class="token operator">|</span><span class="token assign-left variable">cn</span><span class="token operator">=</span>zz<span class="token operator">|</span>
   +--------+   +-----+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u82E5\u8981\u6DFB\u52A0\u7BA1\u7406\u5458\u5BC6\u7801\u7684 <strong>.ldif</strong> \u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u521B\u5EFA passwd.ldif \u5982\u4E0B</span>
dn: <span class="token assign-left variable">olcDatabase</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>hdb,cn<span class="token operator">=</span>config
changetype: modify
replace: olcSuffix
olcSuffix: <span class="token assign-left variable">dc</span><span class="token operator">=</span>test,dc<span class="token operator">=</span>com

dn: <span class="token assign-left variable">olcDatabase</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>hdb,cn<span class="token operator">=</span>config
changetype: modify
replace: olcRootDN
olcRootDN: <span class="token assign-left variable">cn</span><span class="token operator">=</span>dev3,dc<span class="token operator">=</span>test,dc<span class="token operator">=</span>com

dn: <span class="token assign-left variable">olcDatabase</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>hdb,cn<span class="token operator">=</span>config 
changetype: modify
add: olcRootPW
olcRootPW: <span class="token punctuation">{</span>SSHA<span class="token punctuation">}</span>xvQKJMVV5699d7cIeDYlNhOZKQHwbCyo

<span class="token comment"># \u6267\u884C\u5982\u4E0B\u547D\u4EE4\u6DFB\u52A0</span>
ldapmodify <span class="token parameter variable">-Y</span> EXTERNAL <span class="token parameter variable">-H</span> ldapi:/// <span class="token parameter variable">-f</span> passwd.ldif	\`
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-ldap-\u7684-curd-\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_3-4-ldap-\u7684-curd-\u64CD\u4F5C" aria-hidden="true">#</a> 3.4 LDAP \u7684 CURD \u64CD\u4F5C</h3>`,63),Y=s("h5",{id:"ldapadd-\u6DFB\u52A0",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ldapadd-\u6DFB\u52A0","aria-hidden":"true"},"#"),n(),s("strong",null,"ldapadd \u6DFB\u52A0")],-1),K=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[s("span",{class:"token comment"},"# \u5BFC\u5165 ldap \u547D\u4EE4"),n(`
$ ldapadd `),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(),s("span",{class:"token string"},'"DN"'),n(),s("span",{class:"token parameter variable"},"-w"),n(" password "),s("span",{class:"token parameter variable"},"-f"),n(` idif-file.ldif

`),s("span",{class:"token comment"},"# \u9009\u9879"),n(`
    `),s("span",{class:"token parameter variable"},"-x"),n(`   \u8FDB\u884C\u7B80\u5355\u8BA4\u8BC1
    `),s("span",{class:"token parameter variable"},"-D"),n(`   \u7528\u6765\u7ED1\u5B9A\u670D\u52A1\u5668\u7684 DN
    `),s("span",{class:"token parameter variable"},"-h"),n(`   \u76EE\u5F55\u670D\u52A1\u7684\u5730\u5740
    `),s("span",{class:"token parameter variable"},"-w"),n(`   \u7ED1\u5B9A DN \u7684\u5BC6\u7801
    `),s("span",{class:"token parameter variable"},"-f"),n(`   \u4F7F\u7528 ldif \u6587\u4EF6 \u6765\u6DFB\u52A0\u6761\u76EE
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),Q=s("h5",{id:"ldapdelete-\u5220\u9664",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ldapdelete-\u5220\u9664","aria-hidden":"true"},"#"),n(),s("strong",null,"ldapdelete \u5220\u9664")],-1),J=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("$ ldapdelete "),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(),s("span",{class:"token string"},'"DN"'),n(),s("span",{class:"token parameter variable"},"-w"),n(" password "),s("span",{class:"token parameter variable"},"-f"),n(` idif-file.ldif

`),s("span",{class:"token comment"},"# \u9009\u9879"),n(`
    `),s("span",{class:"token parameter variable"},"-c"),n("         \u8FDE\u7EED\u8FD0\u884C\u6A21\u5F0F "),s("span",{class:"token punctuation"},"("),n("\u8FD0\u884C\u51FA\u9519\u65F6\u8DF3\u8FC7\u7EE7\u7EED\u6267\u884C"),s("span",{class:"token punctuation"},")"),n(`
    `),s("span",{class:"token parameter variable"},"-f"),n(),s("span",{class:"token function"},"file"),n(`    \u6307\u5B9A\u6587\u4EF6
    `),s("span",{class:"token parameter variable"},"-M"),n(`         \u542F\u7528\u7BA1\u7406DSA IT\u63A7\u5236
    `),s("span",{class:"token parameter variable"},"-P"),n(" version \u534F\u8BAE\u7248\u672C"),s("span",{class:"token punctuation"},"("),n("default: "),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},")"),n(`
    `),s("span",{class:"token parameter variable"},"-r"),n(`         \u9012\u5F52\u5220\u9664
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),ss=s("p",null,[n("\u5C06 "),s("code",null,"uit.ldeveops.local.ldif"),n(" \u7F16\u5199\u7684\u6570\u636E\u5BFC\u5165\u5230 "),s("strong",null,"ldap"),n(" \u5220\u9664\u793A\u4F8B")],-1),ns=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[s("span",{class:"token comment"},"# \u5220\u9664\u6574\u4E2A\u914D\u7F6E\u6587\u4EF6"),n(`
$ ldapdelete `),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(),s("span",{class:"token string"},'"cn=cloud,dc=uit,dc=ldevops,dc=local"'),n(),s("span",{class:"token parameter variable"},"-w"),n(),s("span",{class:"token punctuation"},"{"),n("SSHA"),s("span",{class:"token punctuation"},"}"),n("SsnKledkDHBy6V8vU9kffRvM8GzWZhSx "),s("span",{class:"token parameter variable"},"-f"),n(` /root/uit.ldeveops.local.ldif

`),s("span",{class:"token comment"},"# \u5220\u9664root\u7528\u6237"),n(`
ldapdelete `),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(),s("span",{class:"token string"},'"cn=cloud,dc=uit,dc=ldevops,dc=local"'),n(),s("span",{class:"token parameter variable"},"-w"),n(),s("span",{class:"token punctuation"},"{"),n("SSHA"),s("span",{class:"token punctuation"},"}"),n("SsnKledkDHBy6V8vU9kffRvM8GzWZhSx "),s("span",{class:"token string"},'"cn=admin,ou=cloud,dc=uit,dc=ldevops,dc=local"'),n(`
ldapdelete `),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(),s("span",{class:"token string"},"'cn=cloud,dc=uit,dc=ldevops,dc=local'"),n(),s("span",{class:"token parameter variable"},"-w"),n(" password "),s("span",{class:"token string"},"'uid=ldapuser1,,ou=People,dc=uit,dc=ldevops,dc=local'"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),as=s("h5",{id:"ldapmodify-\u4FEE\u6539",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ldapmodify-\u4FEE\u6539","aria-hidden":"true"},"#"),n(),s("strong",null,"ldapmodify \u4FEE\u6539")],-1),es=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("$ ldapmodify "),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(" DN "),s("span",{class:"token parameter variable"},"-w"),n(" password "),s("span",{class:"token parameter variable"},"-f"),n(` modify.ldif

`),s("span",{class:"token comment"},"# \u9009\u9879"),n(`
    `),s("span",{class:"token parameter variable"},"-a"),n(` \u6DFB\u52A0\u65B0\u7684\u6761\u76EE.\u7F3A\u7701\u7684\u662F\u4FEE\u6539\u5B58\u5728\u7684\u6761\u76EE.
    `),s("span",{class:"token parameter variable"},"-C"),n(` \u81EA\u52A8\u8FFD\u8E2A\u5F15\u7528.
    `),s("span",{class:"token parameter variable"},"-c"),n(` \u51FA\u9519\u540E\u7EE7\u7EED\u6267\u884C\u7A0B\u5E8F\u5E76\u4E0D\u4E2D\u6B62.\u7F3A\u7701\u60C5\u51B5\u4E0B\u51FA\u9519\u7684\u7ACB\u5373\u505C\u6B62.
    `),s("span",{class:"token parameter variable"},"-D"),n(" binddn \u6307\u5B9A\u641C\u7D22\u7684\u7528\u6237\u540D"),s("span",{class:"token punctuation"},"("),n("\u4E00\u822C\u4E3A\u4E00dn \u503C"),s("span",{class:"token punctuation"},")"),n(`.
    `),s("span",{class:"token parameter variable"},"-e"),n(" \u8BBE\u7F6E\u5BA2\u6237\u7AEF\u8BC1\u4E66\u6587\u4EF6,\u4F8B: "),s("span",{class:"token parameter variable"},"-e"),n(` cert/client.crt
    `),s("span",{class:"token parameter variable"},"-E"),n(" \u8BBE\u7F6E\u5BA2\u6237\u7AEF\u8BC1\u4E66\u79C1\u94A5\u6587\u4EF6,\u4F8B: "),s("span",{class:"token parameter variable"},"-E"),n(` cert/client.key
    `),s("span",{class:"token parameter variable"},"-f"),n(),s("span",{class:"token function"},"file"),n(` \u4ECE\u6587\u4EF6\u5185\u8BFB\u53D6\u6761\u76EE\u7684\u4FEE\u6539\u4FE1\u606F\u800C\u4E0D\u662F\u4ECE\u6807\u51C6\u8F93\u5165\u8BFB\u53D6.
    `),s("span",{class:"token parameter variable"},"-H"),n(` ldapuri \u6307\u5B9A\u8FDE\u63A5\u5230\u670D\u52A1\u5668uri.\u5E38\u89C1\u683C\u5F0F\u4E3Aldap://hostname:port
    `),s("span",{class:"token parameter variable"},"-h"),n(` ldaphost \u6307\u5B9A\u8981\u8FDE\u63A5\u7684\u4E3B\u673A\u7684\u540D\u79F0/ip \u5730\u5740.\u5B83\u548C-p \u4E00\u8D77\u4F7F\u7528.
    `),s("span",{class:"token parameter variable"},"-p"),n(` ldapport \u6307\u5B9A\u8981\u8FDE\u63A5\u76EE\u5F55\u670D\u52A1\u5668\u7684\u7AEF\u53E3\u53F7.\u5B83\u548C-h \u4E00\u8D77\u4F7F\u7528.
    `),s("span",{class:"token parameter variable"},"-M"),n(),s("span",{class:"token punctuation"},"["),n("M"),s("span",{class:"token punctuation"},"]"),n(" \u6253\u5F00manage DSA IT \u63A7\u5236. "),s("span",{class:"token parameter variable"},"-MM"),n(` \u628A\u8BE5\u63A7\u5236\u8BBE\u7F6E\u4E3A\u91CD\u8981\u7684.
    `),s("span",{class:"token parameter variable"},"-n"),n(` \u7528\u4E8E\u8C03\u8BD5\u5230\u670D\u52A1\u5668\u7684\u901A\u8BAF.\u4F46\u5E76\u4E0D\u5B9E\u9645\u6267\u884C\u641C\u7D22.\u670D\u52A1\u5668\u5173\u95ED\u65F6,\u8FD4\u56DE\u9519\u8BEF\uFF1B\u670D\u52A1\u5668\u6253\u5F00\u65F6,\u5E38\u548C-v \u53C2\u6570\u4E00\u8D77\u6D4B\u8BD5\u5230\u670D\u52A1\u5668\u662F\u5426\u662F\u4E00\u6761\u901A\u8DEF.
    `),s("span",{class:"token parameter variable"},"-v"),n(` \u8FD0\u884C\u5728\u8BE6\u7EC6\u6A21\u5757.\u5728\u6807\u51C6\u8F93\u51FA\u4E2D\u6253\u51FA\u4E00\u4E9B\u6BD4\u8F83\u8BE6\u7EC6\u7684\u4FE1\u606F.\u6BD4\u5982:\u8FDE\u63A5\u5230\u670D\u52A1\u5668\u7684ip \u5730\u5740\u548C\u7AEF\u53E3\u53F7\u7B49.
    `),s("span",{class:"token parameter variable"},"-V"),n(` \u542F\u7528\u8BC1\u4E66\u8BA4\u8BC1\u529F\u80FD,\u76EE\u5F55\u670D\u52A1\u5668\u4F7F\u7528\u5BA2\u6237\u7AEF\u8BC1\u4E66\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1,\u5FC5\u987B\u4E0E-ZZ \u5F3A\u5236\u542F\u7528TLS \u65B9\u5F0F\u914D\u5408\u4F7F\u7528,\u5E76\u4E14\u533F\u540D\u7ED1\u5B9A\u5230\u76EE\u5F55\u670D\u52A1\u5668.
    `),s("span",{class:"token parameter variable"},"-W"),n(` \u6307\u5B9A\u4E86\u8BE5\u53C2\u6570,\u7CFB\u7EDF\u5C06\u5F39\u51FA\u4E00\u63D0\u793A\u5165\u7528\u6237\u7684\u5BC6\u7801.\u5B83\u548C-w \u53C2\u6570\u76F8\u5BF9\u4F7F\u7528.
    `),s("span",{class:"token parameter variable"},"-w"),n(` bindpasswd \u76F4\u63A5\u6307\u5B9A\u7528\u6237\u7684\u5BC6\u7801. \u5B83\u548C-W \u53C2\u6570\u76F8\u5BF9\u4F7F\u7528.
    `),s("span",{class:"token parameter variable"},"-x"),n(` \u4F7F\u7528\u7B80\u5355\u8BA4\u8BC1.
    -Z`),s("span",{class:"token punctuation"},"["),n("Z"),s("span",{class:"token punctuation"},"]"),n(` \u4F7F\u7528StartTLS \u6269\u5C55\u64CD\u4F5C.\u5982\u679C\u4F7F\u7528-ZZ,\u547D\u4EE4\u5F3A\u5236\u4F7F\u7528StartTLS \u63E1\u624B\u6210\u529F.
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),ls=s("p",null,"\u7F16\u5199\u6587\u4EF6\u5982\u4E0B",-1),ts=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("dn: "),s("span",{class:"token assign-left variable"},"olcDatabase"),s("span",{class:"token operator"},"="),s("span",{class:"token punctuation"},"{"),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},"}"),n("hdb,cn"),s("span",{class:"token operator"},"="),n(`config
changetype: modify
replace: olcSuffix
olcSuffix: `),s("span",{class:"token assign-left variable"},"dc"),s("span",{class:"token operator"},"="),n("uit,dc"),s("span",{class:"token operator"},"="),n("ldevops,dc"),s("span",{class:"token operator"},"="),n(`local

dn: `),s("span",{class:"token assign-left variable"},"olcDatabase"),s("span",{class:"token operator"},"="),s("span",{class:"token punctuation"},"{"),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},"}"),n("hdb,cn"),s("span",{class:"token operator"},"="),n(`config
changetype: modify
replace: olcRootDN
olcRootDN: `),s("span",{class:"token assign-left variable"},"cn"),s("span",{class:"token operator"},"="),n("root,dc"),s("span",{class:"token operator"},"="),n("uit,dc"),s("span",{class:"token operator"},"="),n("ldevops,dc"),s("span",{class:"token operator"},"="),n(`local

dn: `),s("span",{class:"token assign-left variable"},"olcDatabase"),s("span",{class:"token operator"},"="),s("span",{class:"token punctuation"},"{"),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},"}"),n("hdb,cn"),s("span",{class:"token operator"},"="),n(`config
changetype: modify
add: olcRootPW
olcRootPW: `),s("span",{class:"token punctuation"},"{"),n("SSHA"),s("span",{class:"token punctuation"},"}"),n(`SsnKledkDHBy6V8vU9kffRvM8GzWZhSx

$ ldapmodify `),s("span",{class:"token parameter variable"},"-Y"),n(" EXTERNAL "),s("span",{class:"token parameter variable"},"-H"),n(" ldapi:/// "),s("span",{class:"token parameter variable"},"-f"),n(` passwd.ldif
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),ps=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("$ ldapmodify "),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(),s("span",{class:"token string"},'"cn=root,dc=it,dc=com"'),n(),s("span",{class:"token parameter variable"},"-W"),n(` secret
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),os=s("h5",{id:"ldapsearch-\u67E5\u8BE2",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ldapsearch-\u67E5\u8BE2","aria-hidden":"true"},"#"),n(),s("strong",null,"ldapsearch \u67E5\u8BE2")],-1),is=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("$ ldapsearch "),s("span",{class:"token parameter variable"},"-LLL"),n(),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(" DN "),s("span",{class:"token parameter variable"},"-w"),n(" password "),s("span",{class:"token parameter variable"},"-b"),n(` \u6839\u57DF query_param

`),s("span",{class:"token comment"},"# \u9009\u9879"),n(`
    `),s("span",{class:"token parameter variable"},"-x"),n(`   \u8FDB\u884C\u7B80\u5355\u8BA4\u8BC1
    `),s("span",{class:"token parameter variable"},"-D"),n(`   \u7528\u6765\u7ED1\u5B9A\u670D\u52A1\u5668\u7684DN
    `),s("span",{class:"token parameter variable"},"-w"),n(`   \u7ED1\u5B9ADN\u7684\u5BC6\u7801
    `),s("span",{class:"token parameter variable"},"-b"),n(`   \u6307\u5B9A\u8981\u67E5\u8BE2\u7684\u6839\u8282\u70B9
    `),s("span",{class:"token parameter variable"},"-H"),n(`   \u5236\u5B9A\u8981\u67E5\u8BE2\u7684\u670D\u52A1\u5668
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),rs=s("p",null,"\u793A\u4F8B\u5982\u4E0B",-1),cs=s("div",{class:"language-bash ext-sh line-numbers-mode"},[s("pre",{class:"language-bash"},[s("code",null,[n("$ ldapsearch "),s("span",{class:"token parameter variable"},"-LLL"),n(),s("span",{class:"token parameter variable"},"-x"),n(),s("span",{class:"token parameter variable"},"-D"),n(),s("span",{class:"token string"},'"cn=cloud,dc=uit,dc=ldevops,dc=local"'),n(),s("span",{class:"token parameter variable"},"-w"),n(),s("span",{class:"token string"},'"user@dev"'),n(),s("span",{class:"token parameter variable"},"-b"),n(),s("span",{class:"token string"},'"dc=uit,dc=ldevops,dc=local"'),n(),s("span",{class:"token string"},'"cn=ldapgroup1"'),n(`

`),s("span",{class:"token comment"},"# \u67E5\u8BE2 uit.ldevops.local \u57DF\u4E0B cloud \u7EC4\u7EC7\u7684 ldapgroup1 \u7528\u6237\u7EC4"),n(`

`),s("span",{class:"token parameter variable"},"-H"),n(` ldaps://192.168.10.192:389
`),s("span",{class:"token comment"},"# \u8C8C\u4F3C\u53EF\u4EE5\u8FDC\u7A0B\u67E5\u8BE2"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),ds=s("h2",{id:"_4-\u56FE\u5F62\u5316\u5E94\u7528",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-\u56FE\u5F62\u5316\u5E94\u7528","aria-hidden":"true"},"#"),n(" 4. \u56FE\u5F62\u5316\u5E94\u7528")],-1),us=s("h3",{id:"_4-1-phpldapadmin",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-1-phpldapadmin","aria-hidden":"true"},"#"),n(" 4.1 phpldapadmin")],-1),vs={href:"http://phpldapadmin.sourceforge.net/wiki/index.php/Main_Page",target:"_blank",rel:"noopener noreferrer"},ms=s("strong",null,"php",-1),bs=s("strong",null,"Web",-1),ks=i(`<h4 id="\u5B89\u88C5-phpldapadmin" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5-phpldapadmin" aria-hidden="true">#</a> \u5B89\u88C5 phpldapadmin</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5B89\u88C5\u7EA2\u5E3D\u884D\u751F\u5E93</span>
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> epel-release

<span class="token comment"># \u5B89\u88C5</span>
yum <span class="token function">install</span> <span class="token parameter variable">-y</span> phpldapadmin 

<span class="token comment"># \u6216\u662F</span>
yum <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span>epel <span class="token parameter variable">-y</span> <span class="token function">install</span> phpldapadmin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4FEE\u6539 php \u914D\u7F6E</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> /etc/phpldapadmin/config.php +397

<span class="token comment"># 397\u884C\u53D6\u6D88\u6CE8\u91CA\uFF0C398\u884C\u6DFB\u52A0\u6CE8\u91CA</span>
<span class="token variable">$servers</span>-<span class="token operator">&gt;</span>setValue<span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span>,<span class="token string">&#39;attr&#39;</span>,<span class="token string">&#39;dn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
//<span class="token variable">$servers</span>-<span class="token operator">&gt;</span>setValue<span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span>,<span class="token string">&#39;attr&#39;</span>,<span class="token string">&#39;uid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># \u914D\u7F6E\u57DF\u540D</span>
<span class="token variable">$servers</span>-<span class="token operator">&gt;</span>setValue<span class="token punctuation">(</span><span class="token string">&#39;server&#39;</span>,<span class="token string">&#39;base&#39;</span>,array<span class="token punctuation">(</span><span class="token string">&#39;dc=uit,dc=ldevops,dc=local&#39;</span><span class="token punctuation">))</span><span class="token punctuation">;</span>

<span class="token comment"># \u7ED1\u5B9A\u767B\u5F55\u8D26\u6237\uFF0C\u9ED8\u8BA4\u586B\u5199</span>
<span class="token variable">$servers</span>-<span class="token operator">&gt;</span>setValue<span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span>,<span class="token string">&#39;bind_id&#39;</span>,<span class="token string">&#39;uid=ldapuser1,ou=People,dc=uit,dc=ldevops,dc=local&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539 <strong>httpd</strong> \u7684 <strong>apache</strong> \u914D\u7F6E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> /etc/httpd/conf.d/phpldapadmin.conf

<span class="token comment"># \u6539\u5199\u5982\u4E0B\u914D\u7F6E</span>
<span class="token comment">#  Web-based tool for managing LDAP servers</span>
<span class="token comment">#</span>

Alias /phpldapadmin /usr/share/phpldapadmin/htdocs
Alias /ldapadmin /usr/share/phpldapadmin/htdocs

<span class="token operator">&lt;</span>Directory /usr/share/phpldapadmin/htdocs<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>IfModule mod_authz_core.c<span class="token operator">&gt;</span>
    <span class="token comment"># Apache 2.4</span>
    <span class="token comment"># Require local</span>
    <span class="token comment"># \u8FD8\u53EF\u4EE5\u6DFB\u52A0\u4E00\u884C\u5185\u5BB9\uFF0C\u6307\u5B9A\u53EF\u8BBF\u95EE\u7684ip\u6BB5\uFF0C\u6309\u9700</span>
    <span class="token comment"># Require ip 192.168.77.0/24</span>
    <span class="token comment"># \u4E5F\u53EF\u4EE5\u6240\u6709</span>
    Require all granted
  <span class="token operator">&lt;</span>/IfModule<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>IfModule <span class="token operator">!</span>mod_authz_core.c<span class="token operator">&gt;</span>
    <span class="token comment"># Apache 2.2</span>
    Order Deny,Allow
    Deny from all
    Allow from <span class="token number">127.0</span>.0.1
    Allow from ::1
  <span class="token operator">&lt;</span>/IfModule<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/Directory<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u91CD\u542F httpd \u5E76\u914D\u7F6E\u9632\u706B\u5899</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl restart httpd.service
systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> httpd

firewall-cmd <span class="token parameter variable">--permanent</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>public --add-service<span class="token operator">=</span>http
firewall-cmd <span class="token parameter variable">--reload</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6D4F\u89C8\u5668\u8BBF\u95EE phpldapadmin</strong></p>`,9),gs=s("strong",null,"url\uFF1A",-1),hs={href:"http://172.16.120.145/phpldapadmin/",target:"_blank",rel:"noopener noreferrer"},fs=s("li",null,[s("strong",null,"\u7528\u6237\u540D\uFF1A"),n(" \u9ED8\u8BA4\u4E0A\u6587\u5DF2\u7ECF\u914D\u7F6E\uFF0C\u9700\u5168\u79F0")],-1),_s=s("li",null,[s("strong",null,"\u5BC6\u7801\uFF1A"),n(" \u8BBE\u5B9A\u7684\u7BA1\u7406\u5458\u5BC6\u7801")],-1),ys=s("h3",{id:"_4-2-self-service-password",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-2-self-service-password","aria-hidden":"true"},"#"),n(" 4.2 Self Service Password")],-1),Ds={href:"https://ltb-project.org/documentation/self-service-password",target:"_blank",rel:"noopener noreferrer"},xs=s("strong",null,"php",-1),ws=s("strong",null,"Web",-1),As=s("strong",null,"OpenLDAP",-1),qs=s("strong",null,"LDAPv3",-1),Ls=s("strong",null,"OpenLDAP",-1),Ps=s("strong",null,"Active Directory",-1),Ss=s("strong",null,"OpenDS",-1),$s=s("strong",null,"ApacheDS",-1),Ns={href:"https://github.com/ltb-project/self-service-password",target:"_blank",rel:"noopener noreferrer"},Os=i(`<h4 id="\u5B89\u88C5-self-service-password" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5-self-service-password" aria-hidden="true">#</a> \u5B89\u88C5 Self Service Password</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span> /etc/yum.repos.d/ltb-project-noarch.repo <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
[ltb-project-noarch]
name=LTB project packages
baseurl=https://ltb-project.org/rpm/\\<span class="token variable">$releasever</span>/noarch
enabled=1
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-LTB-project
EOF</span>

<span class="token function">rpm</span> <span class="token parameter variable">--import</span> https://ltb-project.org/lib/RPM-GPG-KEY-LTB-project

yum <span class="token parameter variable">-y</span> <span class="token function">install</span> self-service-password
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u770B <strong>Self Service Password</strong> \u5B89\u88C5\u7684\u6587\u4EF6\uFF0C\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">rpm</span> <span class="token parameter variable">-ql</span> self-service-password
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>/etc/httpd/conf.d/self-service-password.conf\uFF1A </code> <strong>apache</strong> \u914D\u7F6E\u6587\u4EF6</li><li><code>/usr/share/self-service-password/conf/config.inc.php\uFF1A</code> <strong>self-service-password</strong> \u914D\u7F6E\u6587\u4EF6</li></ul><p><strong>\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</strong></p><p>\u82E5\u4E0D\u7528\u865A\u62DF\u673A\uFF0C\u53EF\u4FEE\u6539 <strong>apache</strong> \u914D\u7F6E\u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> /etc/httpd/conf.d/self-service-password.conf<span class="token punctuation">{</span>,.bak<span class="token punctuation">}</span>
<span class="token function">cat</span> <span class="token operator">&gt;</span> /etc/httpd/conf.d/self-service-password.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
Alias /ssp /usr/local/self-service-password
 
&lt;Directory /usr/local/self-service-password&gt;
        AllowOverride None
        &lt;IfVersion &gt;= 2.3&gt;
            Require all granted
        &lt;/IfVersion&gt;
        &lt;IfVersion &lt; 2.3&gt;
            Order Deny,Allow
            Allow from all
        &lt;/IfVersion&gt;
        DirectoryIndex index.php
        AddDefaultCharset UTF-8
&lt;/Directory&gt;
EOF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539 <strong>LDAP</strong> \u8FDE\u63A5\u548C <strong>email</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span>  /usr/share/self-service-password/conf/config.inc.php +37

<span class="token variable">$ldap_url</span> <span class="token operator">=</span> <span class="token string">&quot;ldap://localhost&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$ldap_starttls</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token variable">$ldap_binddn</span> <span class="token operator">=</span> <span class="token string">&quot;cn=Manager,dc=uit,dc=ldevops,dc=local&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$ldap_bindpw</span> <span class="token operator">=</span> <span class="token string">&quot;user@dev&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$ldap_base</span> <span class="token operator">=</span> <span class="token string">&quot;ou=People,dc=uit,dc=ldevops,dc=local&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$ldap_login_attribute</span> <span class="token operator">=</span> <span class="token string">&quot;uid&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$ldap_fullname_attribute</span> <span class="token operator">=</span> <span class="token string">&quot;cn&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$ldap_filter</span> <span class="token operator">=</span> <span class="token string">&quot;(&amp;(objectClass=person)(<span class="token variable">$ldap_login_attribute</span>={login}))&quot;</span><span class="token punctuation">;</span>


<span class="token variable">$keyphrase</span> <span class="token operator">=</span> <span class="token string">&quot;uitRandmon&quot;</span><span class="token punctuation">;</span>

<span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token string">&quot;SSHA&quot;</span><span class="token punctuation">;</span>

<span class="token variable">$who_change_password</span> <span class="token operator">=</span> <span class="token string">&quot;manager&quot;</span><span class="token punctuation">;</span>


<span class="token variable">$mail_from</span> <span class="token operator">=</span> <span class="token string">&quot;admin@example.com&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_from_name</span> <span class="token operator">=</span> <span class="token string">&quot;Self Service Password&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_signature</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token comment"># Notify users anytime their password is changed</span>
<span class="token variable">$notify_on_change</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment"># PHPMailer configuration (see https://github.com/PHPMailer/PHPMailer)</span>
<span class="token variable">$mail_sendmailpath</span> <span class="token operator">=</span> <span class="token string">&#39;/usr/sbin/sendmail&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_protocol</span> <span class="token operator">=</span> <span class="token string">&#39;smtp&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_debug</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token variable">$mail_debug_format</span> <span class="token operator">=</span> <span class="token string">&#39;error_log&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_host</span> <span class="token operator">=</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_auth</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_user</span> <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_pass</span> <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_port</span> <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_timeout</span> <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_keepalive</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_secure</span> <span class="token operator">=</span> <span class="token string">&#39;tls&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_smtp_autotls</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token variable">$mail_contenttype</span> <span class="token operator">=</span> <span class="token string">&#39;text/plain&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_wordwrap</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token variable">$mail_charset</span> <span class="token operator">=</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$mail_priority</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token variable">$mail_newline</span> <span class="token operator">=</span> PHP_EOL<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u4FEE\u6539ldap\u7684\u8FDE\u63A5\u4FE1\u606F\uFF0C<code>$keyphrase</code> \u8BBE\u5B9A\u4E00\u4E2A\u968F\u673A\u5B57\u7B26\u4E32</p></blockquote><p>\u91CD\u542F <strong>apache</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl restart httpd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BBF\u95EE\u9875\u9762</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>http://172.16.120.145/index.php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4FEE\u6539\u5BC6\u7801</p><img src="`+f+`"><p>\u5728\u7EC8\u7AEF\u9A8C\u8BC1\u4FEE\u6539\u7684\u5BC6\u7801</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ldapwhoami <span class="token parameter variable">-x</span> <span class="token parameter variable">-D</span> <span class="token assign-left variable">uid</span><span class="token operator">=</span>ldapuser1,ou<span class="token operator">=</span>People,dc<span class="token operator">=</span>lework,dc<span class="token operator">=</span>com <span class="token parameter variable">-w</span> <span class="token number">123456</span>
ldap_bind: Invalid credentials <span class="token punctuation">(</span><span class="token number">49</span><span class="token punctuation">)</span>
ldapwhoami <span class="token parameter variable">-x</span> <span class="token parameter variable">-D</span> <span class="token assign-left variable">uid</span><span class="token operator">=</span>ldapuser1,ou<span class="token operator">=</span>People,dc<span class="token operator">=</span>lework,dc<span class="token operator">=</span>com <span class="token parameter variable">-w</span> <span class="token number">12345678</span>
dn:uid<span class="token operator">=</span>ldapuser1,ou<span class="token operator">=</span>People,dc<span class="token operator">=</span>lework,dc<span class="token operator">=</span>com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E5F\u53EF\u4EE5\u4F7F\u7528\u90AE\u4EF6\u627E\u56DE\uFF0C\u6216\u8005\u77ED\u4FE1\u627E\u56DE</p><h2 id="_5-\u7BA1\u7406\u8F6F\u4EF6" tabindex="-1"><a class="header-anchor" href="#_5-\u7BA1\u7406\u8F6F\u4EF6" aria-hidden="true">#</a> 5. \u7BA1\u7406\u8F6F\u4EF6</h2><h3 id="_5-1-smbldap-tools" tabindex="-1"><a class="header-anchor" href="#_5-1-smbldap-tools" aria-hidden="true">#</a> 5.1 smbldap-tools</h3><p>\u662F\u6570\u636E\u5E93\u7BA1\u7406\u8F6F\u4EF6\uFF0C\u65B9\u4FBF\u8FDB\u884C\u7528\u6237\u7AEF\u7684\u7BA1\u7406\uFF0C\u4F46 <strong>smbldap-tools</strong> \u6709\u4E2A\u7F3A\u70B9\uFF0C\u4E0D\u7BA1\u4F60\u672C\u5730\u7528\u6237\u662F\u5426\u6709\u76F8\u540C\u7684 <strong>UID</strong> \u6216\u5219 <strong>GID</strong> \u90FD\u4F1A\u76F4\u63A5\u6DFB\u52A0\u7528\u6237\uFF0C\u6545\u53EF\u80FD\u4F1A\u5F15\u8D77\u51B2\u7A81</p><blockquote><p><strong>smbldap-tools</strong> \u7684\u8F6F\u4EF6\u5305\u5728 <strong>epel</strong> \u5E93\uFF0C\u53EF\u80FD\u9700\u5148\u5B89\u88C5 <strong>epel</strong> \u6E90\uFF08\u5EFA\u8BAE\u5728\u5BA2\u6237\u7AEF\u5B89\u88C5\uFF0C\u65B9\u4FBF\u521D\u59CB\u5316</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ yum <span class="token function">install</span> <span class="token parameter variable">-y</span> smbldap-tools
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>smbldap</strong> \u4F1A\u4ECE <code>/etc/samba/smb.conf</code> \u8BFB\u53D6\u90E8\u5206\u4FE1\u606F\uFF0C\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u914D\u7F6E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ smbldap-config

<span class="token comment"># \u521D\u59CB\u5316\u914D\u7F6E OPENldap \u6570\u636E\u5E93</span>
$ smbldap-populate    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u521B\u5EFA\u7528\u6237\u5982\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u6DFB\u52A0\u7528\u6237User2</span>
$ smbldap-useradd <span class="token parameter variable">-a</span> <span class="token parameter variable">-m</span> igarashi <span class="token parameter variable">-u</span> <span class="token number">100001</span>
    -a\uFF1A \u6307\u5B9A\u6DFB\u52A0\u7684\u7528\u6237\u7C7B\u578B\u4E3A Windows\uFF0C\u8FD9\u6837 samba \u624D\u80FD\u8BC6\u522B\u5230\u8BE5\u7528\u6237
    -m\uFF1A \u6307\u5B9A\u521B\u5EFA\u8BE5\u7528\u6237\u7684\u5BB6\u76EE\u5F55

<span class="token comment"># \u4FEE\u6539\u8BE5\u7528\u6237\u7684\u5BC6\u7801</span>
$ smbldap-passwd igarashi 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u6CE8\u610F\uFF1A</strong> \u5982\u4E0A\u65B9\u5F0F\u52A0\u5165\u7528\u6237\uFF0C\u4F1A\u9ED8\u8BA4\u4F7F\u7528\u5BA2\u6237\u7AEF\u7684 <strong>SID</strong> \uFF0C\u8BA4\u8BC1\u65F6\u9700\u786E\u8BA4\u52A0\u5165\u7684\u8282\u70B9\u540C\u5C5E\u4E8E\u4E00\u4E2A <strong>SID</strong> \uFF08<em>\u670D\u52A1\u7AEF\u4FEE\u6539</em> \uFF09</p></blockquote><h3 id="_5-2-\u5176\u4ED6-windows-\u7BA1\u7406\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#_5-2-\u5176\u4ED6-windows-\u7BA1\u7406\u5DE5\u5177" aria-hidden="true">#</a> 5.2 \u5176\u4ED6 Windows \u7BA1\u7406\u5DE5\u5177</h3><ul><li><strong>ldapadmin</strong></li><li><strong>apache Directory Studio</strong></li></ul><h2 id="_6-\u52A0\u57DF\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_6-\u52A0\u57DF\u914D\u7F6E" aria-hidden="true">#</a> 6. \u52A0\u57DF\u914D\u7F6E</h2><p>\u4EE5\u4E0A\u8FF0\u642D\u5EFA\u73AF\u5883 <strong>uit.ldevops.local</strong> \u4E3A\u4F8B \uFF0C\u73B0\u6709\u76EE\u6807\u8282\u70B9 <strong>172.16.120.141</strong> \u5F85\u52A0\u5165\u57DF</p><ul><li><strong>ip: 172.16.120.145</strong></li><li><strong>\u57DF\u7BA1\u7406\u5458: cloud</strong></li><li><strong>\u7ED1\u5B9ADN\uFF1Acn=cloud,dc=uit,dc=ldevops,dc=local</strong></li></ul><p>\u4FEE\u6539 <strong>Samba</strong> \u914D\u7F6E\u6587\u4EF6</p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>$ vim /etc/samba/smb.conf

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">global</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">workgroup</span> <span class="token punctuation">=</span> <span class="token value attr-value">UIT</span>
<span class="token key attr-name">netbios name</span> <span class="token punctuation">=</span> <span class="token value attr-value">node141</span>
<span class="token key attr-name">security</span> <span class="token punctuation">=</span> <span class="token value attr-value">user</span>
<span class="token key attr-name">passdb backend</span> <span class="token punctuation">=</span> <span class="token value attr-value">ldapsam:ldap://172.16.120.145</span>
<span class="token key attr-name">ldap suffix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;<span class="token inner-value">dc=uit,dc=ldevops,dc=local</span>&quot;</span>
<span class="token key attr-name">ldap group suffix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;<span class="token inner-value">cn=group</span>&quot;</span>
<span class="token key attr-name">ldap user suffix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;<span class="token inner-value">ou=people</span>&quot;</span>
<span class="token key attr-name">ldap admin dn</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;<span class="token inner-value">cn=cloud,dc=uit,dc=ldevops,dc=local</span>&quot;</span>
<span class="token key attr-name">ldap delete dn</span> <span class="token punctuation">=</span> <span class="token value attr-value">no</span>
<span class="token key attr-name">pam password change</span> <span class="token punctuation">=</span> <span class="token value attr-value">yes</span>
<span class="token key attr-name">ldap passwd sync</span> <span class="token punctuation">=</span> <span class="token value attr-value">yes</span>
<span class="token key attr-name">ldap ssl</span> <span class="token punctuation">=</span> <span class="token value attr-value">no</span>

<span class="token comment"># optimization</span>
<span class="token key attr-name">sync always</span> <span class="token punctuation">=</span> <span class="token value attr-value">no</span>
<span class="token key attr-name">write cache size</span> <span class="token punctuation">=</span> <span class="token value attr-value">10485760</span>
<span class="token key attr-name">socket options</span> <span class="token punctuation">=</span> <span class="token value attr-value">TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=131072 SO_SNDBUF=131072</span>
<span class="token key attr-name">use sendfile</span> <span class="token punctuation">=</span> <span class="token value attr-value">yes</span>
<span class="token key attr-name">min receivefile size</span> <span class="token punctuation">=</span> <span class="token value attr-value">131072</span>

<span class="token comment"># common params</span>
<span class="token key attr-name">log file</span> <span class="token punctuation">=</span> <span class="token value attr-value">/var/log/samba/%m.log</span>
<span class="token key attr-name">max log size</span> <span class="token punctuation">=</span> <span class="token value attr-value">50</span>
<span class="token key attr-name">printcap name</span> <span class="token punctuation">=</span> <span class="token value attr-value">/etc/printcap</span>
<span class="token key attr-name">load printers</span> <span class="token punctuation">=</span> <span class="token value attr-value">no</span>
<span class="token key attr-name">wins server</span> <span class="token punctuation">=</span>
<span class="token key attr-name">unix charset</span> <span class="token punctuation">=</span> <span class="token value attr-value">utf-8</span>
<span class="token key attr-name">dos charset</span> <span class="token punctuation">=</span> <span class="token value attr-value">cp936</span>
<span class="token key attr-name">dns proxy</span> <span class="token punctuation">=</span> <span class="token value attr-value">no</span>
<span class="token key attr-name">delete readonly</span> <span class="token punctuation">=</span> <span class="token value attr-value">yes</span>
<span class="token key attr-name">create mask</span> <span class="token punctuation">=</span> <span class="token value attr-value">0777</span>
<span class="token key attr-name">directory mask</span> <span class="token punctuation">=</span> <span class="token value attr-value">0777</span>
<span class="token key attr-name">force create mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">0777</span>
<span class="token key attr-name">force directory mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">0777</span>
<span class="token key attr-name">template shell</span> <span class="token punctuation">=</span> <span class="token value attr-value">/bin/false</span>
<span class="token key attr-name">map to guest</span> <span class="token punctuation">=</span> <span class="token value attr-value">bad user</span>
<span class="token key attr-name">null passwords</span> <span class="token punctuation">=</span> <span class="token value attr-value">yes</span>
<span class="token key attr-name">usershare allow guests</span> <span class="token punctuation">=</span> <span class="token value attr-value">yes</span>
<span class="token key attr-name">include</span> <span class="token punctuation">=</span> <span class="token value attr-value">/etc/samba/smb_shares.conf</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container danger"><p class="custom-container-title">\u7279\u522B\u6CE8\u610F</p><p><strong>include</strong> \u5171\u4EAB\u6587\u4EF6\u8DEF\u5F84\u53C2\u6570\uFF0C\u5FC5\u987B\u653E\u5728\u6700\u540E</p></div><p>\u4FEE\u6539 <strong>nsswitch</strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>$ vim /etc/nsswitch

passwd:        files ldap
shadow:        files ldap
group:         files ldap
hosts:         files dns ldap
bootparams:    files
ethers:        files
networks:      files
protocols:     files
rpc:           files
services:      files
netgroup:      files
publickey:     files
automount:     files
aliases:       files
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539 <strong>nslcd</strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>$ vim /etc/nslcd.conf

uid nslcd
gid ldap
uri ldap://172.16.120.145/
<span class="token key attr-name">base dc</span><span class="token punctuation">=</span><span class="token value attr-value">uit,dc=ldevops,dc=local</span>
ssl no
<span class="token key attr-name">binddn cn</span><span class="token punctuation">=</span><span class="token value attr-value">cloud,dc=uit,dc=ldevops,dc=local</span>
bindpw user@dev
<span class="token key attr-name">filter passwd (objectclass</span><span class="token punctuation">=</span><span class="token value attr-value">*)</span>
<span class="token key attr-name">filter shadow (objectclass</span><span class="token punctuation">=</span><span class="token value attr-value">*)</span>
<span class="token key attr-name">filter group  (objectclass</span><span class="token punctuation">=</span><span class="token value attr-value">*)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539 <strong>hosts</strong></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>$ vim /etc/hosts

172.16.120.145 uit.ldevops.local
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u52A0\u57DF\u9A8C\u8BC1\u64CD\u4F5C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u91CD\u542F\u4E00\u7CFB\u5217\u670D\u52A1</span>
systemctl restart nmb
systemctl restart nslcd
systemctl restart smb

<span class="token comment"># \u91CD\u542F\u6210\u529F\u6B64\u65F6\u5E94\u8BE5\u53EF\u4EE5\u5217\u51FA\u57DF\u7528\u6237</span>
$ getent <span class="token function">passwd</span>

<span class="token comment"># \u82E5\u6709\u95EE\u9898\uFF0C\u5148\u67E5\u770B Samba \u914D\u7F6E\u6587\u4EF6\u662F\u5426\u6B63\u786E</span>
$ testparm 

<span class="token comment"># \u9A8C\u8BC1 Samba DB \u662F\u5426\u80FD\u663E\u793A\u57DF\u7528\u6237\u7684 SID</span>
$ pdbedit <span class="token parameter variable">-L</span>
igarashi:1000001:igarashi
jackson:150001:jackson
sasaki:100002:sasaki
jack:200041:jack
sid S-1-5-21-336872314-1070286693-535668972-1001 does not belong to our domain

<span class="token variable"><span class="token variable">\`</span>\u6700\u540E\u4E00\u4E2A sid \u5219\u8868\u793A\u975E\u57DF\u5185\u7528\u6237\uFF0C\u82E5Samba\u8BBF\u95EE\u4F1A\u663E\u793A \u5B89\u5168ID \u7ED3\u6784\u65E0\u6548\uFF0C\u89E3\u51B3\u65B9\u5F0F\u53C2\u8003\u5982\u4E0B<span class="token variable">\`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6210\u529F\u52A0\u5165\u57DF\u7684\u68C0\u6D4B\u65B9\u5F0F\uFF1A</strong> \u4E0A\u8FF0\u6B65\u9AA4\u6B63\u786E\uFF0C\u670D\u52A1\u6B63\u5E38\uFF0C\u4E14\u5728 <strong>ldap</strong> \u670D\u52A1\u7AEF\u53EF\u4EE5\u67E5\u770B\u5230\u52A0\u5165\u8282\u70B9\u7684\u57DF\u540D\uFF0C\u5219\u8868\u793A\u6210\u529F\uFF08<em>\u52A0\u5165\u57DF\u540E\uFF0C\u670D\u52A1\u7AEF\u4F1A\u81EA\u52A8\u6CE8\u518C\u8282\u70B9\u7684 <strong>hostname</strong> \u4FE1\u606F</em> \uFF09</p><img src="`+_+'"><div class="custom-container info"><p class="custom-container-title">\u6CE8\u610F</p><p>\u82E5\u8FDE\u63A5\u591A\u4E2A\u57DF\uFF0C\u53EF\u80FD\u9700\u8981\u5728\u670D\u52A1\u7AEF\u5C06\u6BCF\u4E2A\u8282\u70B9\u81EA\u52A8\u751F\u6210\u7684 <strong>SID</strong> \u90FD\u6539\u4E3A\u57DF\u7528\u6237\u4E00\u81F4\u7684 <strong>SID</strong>\uFF08<em>\u53EF\u7528\u4E0A\u8FF0\u5DE5\u5177 <strong>smbldap-tool</strong> \u65B9\u4FBF\u7684\u751F\u6210\u57DF\u7528\u6237</em> \uFF09</p><p>\u82E5\u7528\u6237\u6709\uFF08<em>\u4E0D\u5728\u670D\u52A1\u7AEF\u6539\u5199\u6570\u636E</em>\uFF09\u7684\u9700\u6C42\uFF0C\u83B7\u53D6\u8003\u8651\u83B7\u53D6\u57DF\u7528\u6237\u7684 <strong>SID</strong>\uFF0C\u7136\u540E\u91CD\u65B0\u5BF9\u52A0\u57DF\u8282\u70B9\u7684 <strong>SID</strong> \u8FDB\u884C\u6539\u5199\u4E00\u81F4\u64CD\u4F5C\uFF0C\u8FD9\u4E00\u5F00\u59CB\u4E5F\u8BB8\u662F\u4E3A\u4E86\u591A\u4E2A\u57DF\u7684\u4E0D\u540C\u57DF\u7528\u6237\u800C\u8BBE\u8BA1\u7684\uFF0C\u5B9E\u9645\u9700\u6839\u636E\u5BA2\u6237\u73B0\u573A\u73AF\u5883\u8003\u8651</p></div>',49);function Es(Is,Ts){const e=c("ExternalLinkIcon"),r=c("Tabs");return u(),v("div",null,[D,x,m(" more "),w,s("p",null,[s("a",A,[n("\u53C2\u8003\u8BE6\u89E3 LDAP"),a(e)])]),q,s("p",null,[s("a",L,[n("ReadHat OpenLDAP"),a(e)])]),s("p",null,[s("a",P,[n("OpenLDAP"),a(e)]),n(" \u662F\u4E00\u6B3E "),S,n(" \u5F00\u6E90\u96C6\u4E2D\u8D26\u53F7\u7BA1\u7406\u7684\u5B9E\u73B0\uFF0C\u652F\u6301\u4F17\u591A\u7CFB\u7EDF\u7248\u672C\uFF0C\u88AB\u5E7F\u5927\u4E92\u8054\u7F51\u516C\u53F8\u4F7F\u7528\uFF0C"),$,n(" \u7684\u6570\u636E\u5FC5\u987B\u7528\u539F\u914D\u7684 "),N,n("\uFF0C\u4E0D\u80FD\u4F7F\u7528 "),O,n(" \u4F5C\u4E3A\u540E\u7AEF\u6570\u636E\u5E93")]),a(r,{data:[{title:"CentOS"}]},{tab0:l(({title:t,value:p,isActive:o})=>[E,I,T,R,B,j,H,M,F,z,V,C,U,W,X,G]),_:1}),Z,a(r,{data:[{title:"\u6DFB\u52A0"},{title:"\u5220\u9664"},{title:"\u4FEE\u6539"},{title:"\u67E5\u8BE2"}]},{tab0:l(({title:t,value:p,isActive:o})=>[Y,K]),tab1:l(({title:t,value:p,isActive:o})=>[Q,J,ss,ns]),tab2:l(({title:t,value:p,isActive:o})=>[as,es,ls,ts,ps]),tab3:l(({title:t,value:p,isActive:o})=>[os,is,rs,cs]),_:1}),ds,us,s("p",null,[s("a",vs,[n("phpldapadmin"),a(e)]),n(" \u662F\u7528 "),ms,n(" \u5F00\u53D1\u7684 "),bs,n(" \u5E94\u7528")]),ks,s("ul",null,[s("li",null,[gs,n(),s("a",hs,[n("http://172.16.120.145/phpldapadmin/"),a(e)])]),fs,_s]),ys,s("p",null,[s("a",Ds,[n("Self Service Password"),a(e)]),n(" \u662F\u57FA\u4E8E "),xs,n(" \u7684 "),ws,n(" \u5E94\u7528\uFF0C\u7528\u6765\u81EA\u52A9\u4FEE\u6539\u5BC6\u7801\uFF0C\u89E3\u653E\u7BA1\u7406\u5458\u7684\u5DE5\u4F5C\uFF0C\u8BA9 "),As,n(" \u7528\u6237\u53EF\u81EA\u884C\u8FDB\u884C\u5BC6\u7801\u7684\u4FEE\u6539\u548C\u91CD\u7F6E\uFF0C\u652F\u6301\u6807\u51C6\u7684 "),qs,n(" \u76EE\u5F55\u670D\u52A1\uFF0C\u5305\u62EC\uFF1A"),Ls,n("\u3001"),Ps,n("\u3001"),Ss,n("\u3001"),$s,n(" \u7B49")]),s("p",null,[s("a",Ns,[n("GItHub"),a(e)])]),Os])}const js=d(y,[["render",Es],["__file","LDAP.html.vue"]]);export{js as default};
