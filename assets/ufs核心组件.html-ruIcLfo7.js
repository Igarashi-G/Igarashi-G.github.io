import{_ as n}from"./plugin-vueexport-helper-DlAUqK2U.js";import{c as e,d as i,e as t,r as l,o as h}from"./app-DS5-vXX9.js";const d={};function k(r,s){const a=l("Tabs");return h(),e("div",null,[s[0]||(s[0]=i(`<p>本文档提供 <strong>UFS</strong> 存储系统核心组件的配置说明</p><h2 id="_1-mss-组件" tabindex="-1"><a class="header-anchor" href="#_1-mss-组件"><span>1. MSS 组件</span></a></h2><h3 id="_1-1-基本信息" tabindex="-1"><a class="header-anchor" href="#_1-1-基本信息"><span>1.1 基本信息</span></a></h3><table><thead><tr><th>类目</th><th>信息</th><th>说明</th></tr></thead><tbody><tr><td>核心进程</td><td>ufsmetaserver</td><td></td></tr><tr><td>进程路径</td><td>/usr/sbin/ufsmetaserver</td><td></td></tr><tr><td>配置文件路径</td><td>/etc/ufs/ufsmetaserver.cfg</td><td></td></tr><tr><td>日志文件路径</td><td>/var/log/ufs/ufsmetaserver.log</td><td></td></tr><tr><td>依赖项</td><td>license.bin</td><td>License 许可文件</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="_1-2-操作方式" tabindex="-1"><a class="header-anchor" href="#_1-2-操作方式"><span>1.2 操作方式</span></a></h3><ul><li>通过 GUI 管理平台</li></ul><p>请以超级管理员账户的身份的登录 GUI 管理平台进行操作。</p><ul><li>通过 CLI 工具</li></ul><p>执行 CLI 工具需要以 root 账户身份登录节点服务器。</p><h3 id="_1-3-操作类型" tabindex="-1"><a class="header-anchor" href="#_1-3-操作类型"><span>1.3 操作类型</span></a></h3><p><strong>启动服务：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-metaserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmetaserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>停止服务：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-metaserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmetaserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>重启服务：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-metaserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmetaserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>重新加载服务配置：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-metaserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmetaserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看服务的运行状态：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-metaserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmetaserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>启用/禁用开机启动：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ufs-metaserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-metaserver</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看软件版本信息：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmetaserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>查看帮助信息：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmetaserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>支持的命令行参数：</strong></p><table><thead><tr><th>参数</th></tr></thead><tbody><tr><td>-v : print version number and exit</td></tr><tr><td>-f : run in foreground</td></tr><tr><td>-u : log undefined config variables</td></tr><tr><td>-n : do not attempt to increase limit of core dump size</td></tr><tr><td>-t locktimeout : how long wait for lockfile</td></tr><tr><td>-c cfgfile : use given config file</td></tr><tr><td>-i : ignore some metadata structure errors (attach orphans to root, ignore names without inode, etc.). DO NOT USE unless you are absoluttely sure that there are no other options to restore your metadata.</td></tr><tr><td>-a : automatically restore metadata from change logs</td></tr><tr><td>-e : start without metadata (download all from leader)</td></tr><tr><td>-x : produce more verbose output</td></tr><tr><td>-xx : even more verbose output</td></tr></tbody></table><h3 id="_1-4-参数配置" tabindex="-1"><a class="header-anchor" href="#_1-4-参数配置"><span>1.4 参数配置</span></a></h3><p>配置说明：<code>/etc/ufs/ufsmetaserver.cfg</code></p><table><thead><tr><th>功能</th><th>配置项</th><th>说明</th></tr></thead><tbody><tr><td></td><td>WORKING_USER = root</td><td>设置服务进程在运行时的有效用户身份（默认为 root）</td></tr><tr><td></td><td>WORKING_GROUP = root</td><td>设置服务进程在运行时的有效组身份（默认为 root）</td></tr><tr><td></td><td>SYSLOG_IDENT = ufsmetaserver</td><td>配置服务进程在 syslog 中的进程标示字段（默认为 ufsmetaserver）</td></tr><tr><td></td><td>LOCK_MEMORY = 0</td><td>配置 LOCK_MEMORY 以避免操作系统将进程所占用的内存交换到 swap 分区上（默认为 0，不开启）</td></tr><tr><td></td><td>LIMIT_GLIBC_MALLOC_ARENAS = 4</td><td>限制服务器使用大量的虚拟内存（默认为 4）</td></tr><tr><td></td><td>DISABLE_OOM_KILLER = 1</td><td>限制 OOM_KILLER（默认为 1，开启）</td></tr><tr><td></td><td>NICE_LEVEL = -19</td><td>用来运行守护程序的级别（默认值为-19；注意：必须以 root 身份启动进程才能增加优先级，如果设置优先级失败，进程将保留其启动时的级别）</td></tr><tr><td></td><td>FILE_UMASK = 027</td><td>设置组和其他用户的默认 umask（用户始终为 0，默认值为 027-阻止组写入，其他全部阻止）</td></tr><tr><td></td><td>DATA_PATH = /var/lib/ufs</td><td>设置服务进程的工作目录（默认为/var/lib/ufs，用来存放 changelog、metadata、pid 等）</td></tr><tr><td></td><td>EXPORTS_FILENAME = /etc/ufs/ufsexports.cfg</td><td>设置服务进程所需要的 ufsexports.cfg 路径</td></tr><tr><td></td><td>TOPOLOGY_FILENAME = /etc/ufs/ufstopology.cfg</td><td>设置服务进程所需要的 ufstopology.cfg 路径</td></tr><tr><td></td><td>BACK_LOGS = 50</td><td>MSS 日志备份数量（默认为 50）</td></tr><tr><td></td><td>METADATA_SAVE_FREQ = 1</td><td>设置 metadata 同步到本地的时间间隔（默认为 1，1 小时同步一次）</td></tr><tr><td></td><td>BACK_META_KEEP_PREVIOUS = 1</td><td>设置保留的先前元数据 DB 的数量（默认为 1）</td></tr><tr><td></td><td>CHANGELOG_PRESERVE_SECONDS = 1800</td><td>设置 changelog 在内存中保留时间限制（默认为 1800，单位为秒）</td></tr><tr><td></td><td>CHANGELOG_SAVE_MODE = 0</td><td>设置 changelog 的存档机制<br>（默认为 0，可选参数为 0、1、2）</td></tr><tr><td></td><td>MISSING_LOG_CAPACITY = 100000</td><td>限制在内存中记录的丢失的 chunk 块数量的上限（默认为 100000）</td></tr><tr><td></td><td>MATOML_LISTEN_HOST = *</td><td>metaserver</td></tr><tr><td></td><td>MATOML_LISTEN_PORT = 9419</td><td>配置监听与 metaserver、supervisors 的网络端口</td></tr><tr><td></td><td>MATOCS_LISTEN_HOST = *</td><td>配置监听与 chunkserver 的 IP 地址</td></tr><tr><td></td><td>MATOCS_LISTEN_PORT = 9420</td><td>配置监听与 chunkserver 的网络端口</td></tr><tr><td></td><td>MATOCS_TIMEOUT = 10</td><td>MSS 服务与 CSS 服务网络通信的超时时间（默认为 10，单位为秒）</td></tr><tr><td></td><td>AUTH_CODE = ufspassword</td><td>配置 metaserver 与 chunkserver 通信注册的凭证（默认不配置这个选项）</td></tr><tr><td></td><td>REPLICATIONS_DELAY_INIT = 60</td><td>限制开始数据修复的初始延迟，以秒为单位（默认为 60）</td></tr><tr><td></td><td>REPLICATIONS_RESPECT_TOPOLOGY = 0</td><td></td></tr><tr><td></td><td>CREATIONS_RESPECT_TOPOLOGY = 0</td><td></td></tr><tr><td></td><td>CHUNKS_UNIQUE_MODE = 0</td><td></td></tr><tr><td></td><td>CHUNKS_LOOP_MAX_CPS = 100000</td><td>限制每次 chunk_loop 检查次数操作的上限（默认为 100000）</td></tr><tr><td></td><td>CHUNKS_LOOP_MIN_TIME = 300</td><td>限制每次 chunk_loop 检查次数操作的时间下限（默认为 300 秒）</td></tr><tr><td></td><td>CHUNKS_SOFT_DEL_LIMIT = 10</td><td>限制 CSS 服务中软删除数据块的最大数量（默认为 10）</td></tr><tr><td></td><td>CHUNKS_HARD_DEL_LIMIT = 25</td><td>限制 CSS 服务中硬删除数据块的最大数量（默认为 25）</td></tr><tr><td></td><td>CHUNKS_WRITE_REP_LIMIT = 2,1,1,4</td><td>限制复制到一个 CSS 服务中的最大数据块数量</td></tr><tr><td></td><td>CHUNKS_READ_REP_LIMIT = 10,5,2,5</td><td>限制从一个 CSS 服务中复制的最大数据块数量</td></tr><tr><td></td><td>CS_HEAVY_LOAD_THRESHOLD = 150</td><td>CSS 服务的负载阈值（默认为 150）</td></tr><tr><td></td><td>CS_HEAVY_LOAD_RATIO_THRESHOLD = 5.0</td><td>CSS 负载的阈值比率（默认为 5.0，当 CSS 负载高于先前指定的阈值并且此比率高于平均负载时，CSS 将切换到“grace”模式）</td></tr><tr><td></td><td>CS_HEAVY_LOAD_GRACE_PERIOD = 900</td><td>定义 CSS 服务器将在“grace”模式下保持多长时间（以秒为单位）</td></tr><tr><td></td><td>ACCEPTABLE_PERCENTAGE_DIFFERENCE = 1.0</td><td>限制 CSS 服务空间使用之间的最大差异百分比（默认为 1.0 ；有效值：0.1 - 10.0）</td></tr><tr><td></td><td>PRIORITY_QUEUES_LENGTH = 1000000</td><td>优先队列的长度（默认值为 1000000）</td></tr><tr><td></td><td>CS_MAINTENANCE_MODE_TIMEOUT = 0</td><td>限制 CSS 服务可以处于维护模式的最大秒数（默认值为 0，无限制）</td></tr><tr><td></td><td>CS_TEMP_MAINTENANCE_MODE_TIMEOUT = 1800</td><td>CSS 服务器可以处于“临时”维护模式的最大秒数（只要正常停止服务器就会切换到此模式，重新连接后服务器会自动切换回正常模式；默认值：1800）</td></tr><tr><td></td><td>CS_DAYS_TO_REMOVE_UNUSED = 7</td><td>限制 MSS 中保留多少天未使用（断开连接）的 CSS 服务器（有效值：0 - 365；0 表示无限期；默认值为 7）</td></tr><tr><td></td><td>SESSION_SUSTAIN_TIME = 86400</td><td>保留离线的客户端会话的时间（以秒为单位；默认值为 86400 = 1 天）</td></tr><tr><td></td><td>QUOTA_DEFAULT_GRACE_PERIOD = 604800</td><td>软配额的默认宽限期（以秒为单位）（默认为 604800 - 7 天）</td></tr><tr><td></td><td>ATIME_MODE = 0</td><td>atime 修改方式（默认为 0 - 访问时始终修改 atime）</td></tr><tr><td></td><td>RESERVE_SPACE = 0</td><td></td></tr><tr><td></td><td>MAX_ALLOWED_HARD_LINKS = 32767</td><td>限定文件系统的硬链接数量</td></tr></tbody></table><h2 id="_2-css-组件" tabindex="-1"><a class="header-anchor" href="#_2-css-组件"><span>2. CSS 组件</span></a></h2><h3 id="_2-1-基本信息" tabindex="-1"><a class="header-anchor" href="#_2-1-基本信息"><span>2.1 基本信息</span></a></h3><table><thead><tr><th>类目</th><th>信息</th><th>说明</th></tr></thead><tbody><tr><td>核心进程</td><td>ufschunkserver</td><td></td></tr><tr><td>进程路径</td><td>/usr/sbin/ufschunkserver</td><td></td></tr><tr><td>配置文件路径</td><td>/etc/ufs/ufschunkserver.cfg</td><td></td></tr><tr><td>日志文件路径</td><td>/var/log/ufs/ufschunkserver.log</td><td></td></tr><tr><td>依赖项</td><td>集群 ufs-metaserver 服务正常</td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="_2-2-操作方式" tabindex="-1"><a class="header-anchor" href="#_2-2-操作方式"><span>2.2 操作方式</span></a></h3><ul><li>通过 GUI 管理平台</li></ul><p>请以超级管理员账户的身份的登录 GUI 管理平台进行操作。</p><ul><li>通过 CLI 工具</li></ul><p>执行 CLI 工具需要以 root 账户身份登录节点服务器。</p><h3 id="_2-3-操作类型" tabindex="-1"><a class="header-anchor" href="#_2-3-操作类型"><span>2.3 操作类型</span></a></h3><p><strong>启动服务：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-chunkserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufschunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>停止服务：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-chunkserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufschunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>重启服务：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-chunkserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufschunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>重新加载服务配置：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-chunkserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufschunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看服务的运行状态：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-chunkserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufschunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>启用/禁用开机启动：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ufs-chunkserver</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-chunkserver</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看软件版本信息：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufschunkserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>查看帮助信息：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufschunkserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>支持的命令行参数：</strong></p><table><thead><tr><th>参数</th></tr></thead><tbody><tr><td>-v : print version number and exit</td></tr><tr><td>-f : run in foreground</td></tr><tr><td>-u : log undefined config variables</td></tr><tr><td>-n : do not attempt to increase limit of core dump size</td></tr><tr><td>-t locktimeout : how long wait for lockfile</td></tr><tr><td>-c cfgfile : use given config file</td></tr></tbody></table><h3 id="_2-4-参数配置" tabindex="-1"><a class="header-anchor" href="#_2-4-参数配置"><span>2.4 参数配置</span></a></h3><p>配置说明：<code>/etc/ufs/ufschunkserver.cfg</code></p><table><thead><tr><th>功能</th><th>配置项</th><th>说明</th></tr></thead><tbody><tr><td></td><td>WORKING_USER = root</td><td>设置服务进程在运行时的有效用户身份（默认为 root）</td></tr><tr><td></td><td>WORKING_GROUP = root</td><td>设置服务进程在运行时的有效组身份（默认为 root）</td></tr><tr><td></td><td>SYSLOG_IDENT = ufschunkserver</td><td>配置服务进程在 syslog 中的进程标示字段（默认为 ufsmetaserver）</td></tr><tr><td></td><td>LOCK_MEMORY = 0</td><td>是否锁定内存以避免使用 swap（默认为 0，即否）</td></tr><tr><td></td><td>LIMIT_GLIBC_MALLOC_ARENAS = 4</td><td>将 malloc arenas 限制为给定值 - 防止服务器使用大量虚拟内存（默认为 4）</td></tr><tr><td></td><td>DISABLE_OOM_KILLER = 1</td><td>禁用 OOM Killer（默认为 1）</td></tr><tr><td></td><td>NICE_LEVEL = -19</td><td>运行守护进程的 nice 级别（默认为 -19）</td></tr><tr><td></td><td>FILE_UMASK = 027</td><td>为组和其他人设置默认 umask（用户始终为 0，默认为 027）</td></tr><tr><td></td><td>DATA_PATH = /var/lib/ufs</td><td>设置服务进程的工作目录（默认为/var/lib/ufs）</td></tr><tr><td></td><td>HDD_CONF_FILENAME = /etc/ufs/ufshdd.cfg</td><td>设置磁盘信息的配置路径（默认为/etc/ufs/ufshdd.cfg）</td></tr><tr><td></td><td>HDD_TEST_SPEED = 1.0</td><td>数据块安全检查 IO 测试的执行周期（默认为 1.0，单位为秒）</td></tr><tr><td></td><td>HDD_MIN_TEST_INTERVAL = 86400</td><td>当上次 I/O（包括测试）的执行时间少于 HDD_MIN_TEST_INTERVAL 秒前时，不进行测试块完整性</td></tr><tr><td></td><td>HDD_FADVISE_MIN_TIME = 86400</td><td>数据块缓存刷新的最小间隔周期（默认为 86400，单位为秒）</td></tr><tr><td></td><td>HDD_LEAVE_SPACE_DEFAULT = 256MiB</td><td>设置每块磁盘的预留空间（默认为 256 MiB）</td></tr><tr><td></td><td>HDD_REBALANCE_UTILIZATION = 20</td><td>允许 CSS 节点在磁盘容量均衡上花费的总工作时间的百分比</td></tr><tr><td></td><td>HDD_ERROR_TOLERANCE_COUNT = 2</td><td>在单个硬盘驱动器上在给定的秒数 (PERIOD) 内可以容忍多少个 i/o 错误 (COUNT)； 如果错误数量超过此设置，则有问题的硬盘将被标记为损坏</td></tr><tr><td></td><td>HDD_ERROR_TOLERANCE_PERIOD = 600</td><td>在单个硬盘驱动器上在给定的秒数 (PERIOD) 内可以容忍多少个 i/o 错误 (COUNT)； 如果错误数量超过此设置，则有问题的硬盘将被标记为损坏</td></tr><tr><td></td><td>HDD_FSYNC_BEFORE_CLOSE = 0</td><td>启用/禁用数据块操作完成后执行 fsync</td></tr><tr><td></td><td>HDD_SPARSIFY_ON_WRITE = 1</td><td>启用/禁用数据块写入空洞内容</td></tr><tr><td></td><td>HDD_RR_CHUNK_COUNT = 10000</td><td>配置单个磁盘目录中一次可写入的最大数据块文件的上限（默认值为 10000）</td></tr><tr><td></td><td>HDD_KEEP_DUPLICATES_HOURS = 168</td><td>设置在删除之前应该保留多少小时的重复块（默认为 168，单位为小时）</td></tr><tr><td></td><td>ALLOW_STARTING_WITH_INVALID_DISKS = 0</td><td>启用/禁用是否允许存在无效磁盘的情况下 CSS 能够正常启动</td></tr><tr><td></td><td>WORKERS_MAX = 250<br>WORKERS_MAX_IDLE = 40</td><td>工作线程数量的最大值<br>工作线程数量的空闲值</td></tr><tr><td></td><td>LABELS =</td><td>CSS 节点标签</td></tr><tr><td></td><td>MASTER_TIMEOUT = 10</td><td>配置与 MSS 服务通信的超时时间</td></tr><tr><td></td><td>MASTER_RECONNECTION_DELAY = 5</td><td>重连 MSS 服务的延迟时间</td></tr><tr><td></td><td>CHUNKS_PER_REGISTER_PACKET = 10000</td><td>CSS 节点向 MSS 注册过程中传递的单个数据包中允许的数据块上限（默认为 10000）</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h2 id="_3-client-组件" tabindex="-1"><a class="header-anchor" href="#_3-client-组件"><span>3. CLIENT 组件</span></a></h2><h3 id="_3-1-基本信息" tabindex="-1"><a class="header-anchor" href="#_3-1-基本信息"><span>3.1 基本信息</span></a></h3><table><thead><tr><th>类目</th><th>信息</th><th>说明</th></tr></thead><tbody><tr><td>核心进程</td><td>ufsmount</td><td></td></tr><tr><td>进程路径</td><td>/usr/bin/ufsmount</td><td></td></tr><tr><td>配置文件路径</td><td>/etc/ufs/ufsmount.cfg</td><td></td></tr><tr><td>日志文件路径</td><td>/var/log/ufs/ufsmount.log</td><td></td></tr><tr><td>依赖项</td><td>UFS 集群状态正常</td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="_3-2-操作方式" tabindex="-1"><a class="header-anchor" href="#_3-2-操作方式"><span>3.2 操作方式</span></a></h3><p>执行 ufsmount 工具需要以 root 账户身份登录应用服务器。</p><h3 id="_3-3-操作类型" tabindex="-1"><a class="header-anchor" href="#_3-3-操作类型"><span>3.3 操作类型</span></a></h3><p>创建本地挂载目录：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>挂载 UFS 根文件系统到本地的/mnt/ufs 目录：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用-H 参数挂载指定集群的 UFS 文件系统：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -H</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 192.168.2.71</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用 ufssubfolder 参数指定挂载的子目录：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufssubfolder=/sub</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用 ufsbind 指定客户端使用的 IP 地址：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsbind=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">172.16.130.157</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>挂载回收站：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsmeta</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/meta</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>延迟挂载：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsdelayedinit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>前台运行客户端程序：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启用 DEBUG 输出模式：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsdebug</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看帮助信息：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-4-参数配置" tabindex="-1"><a class="header-anchor" href="#_3-4-参数配置"><span>3.4 参数配置</span></a></h3><p>客户端的挂载参数可以在命令行中指定，也可以在<code>/etc/ufs/ufsmount.cfg</code>中进行设置。</p><h4 id="_3-4-1-缓存配置" tabindex="-1"><a class="header-anchor" href="#_3-4-1-缓存配置"><span>3.4.1 缓存配置</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufscachemode=CMODE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       设置缓存模式</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> AUTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsattrcacheto=SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       设置属性缓存超时</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsxattrcacheto=SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      设置扩展属性</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (xattr) 缓存超时 (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsentrycacheto=SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      设置文件entry缓存超时</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsdirentrycacheto=SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   设置目录entry缓存超时</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnegentrycacheto=SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   设置neg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> entry缓存超时</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsgroupscacheto=SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     设置用户组缓存超时</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">300.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-2-io-调优" tabindex="-1"><a class="header-anchor" href="#_3-4-2-io-调优"><span>3.4.2 IO 调优</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsfsyncmintime=SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      force</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fsync</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> before</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> close</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> when</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> was</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> opened/created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> least</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SEC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> seconds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> earlier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> always</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> do</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fsync</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> before</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufswritecachesize=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      设置write缓冲区大小，单位:MiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsreadaheadsize=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       设置read缓冲区大小，单位:MiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsreadaheadleng=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       设置read预读取的文件大小，单位：B</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1048576</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsreadaheadtrigger=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    设置按顺序读取开启预读的字节数</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsreadaheadleng</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufserroronlostchunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      启用数据块丢失时直接返回io</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> error</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufserroronnospace</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        启用空间不足时直接返回io</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> error</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsioretries=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           设置I/O错误返回前的重试次数</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufstimeout=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             设置I/O错误返回前的最大超时秒数</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> which</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> means</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> timeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufslogretry=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            定义超过多少次I/O重试操作后客户端开始记录日志</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-3-系统调优" tabindex="-1"><a class="header-anchor" href="#_3-4-3-系统调优"><span>3.4.3 系统调优</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsrlimitnofile=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        设置客户端进程允许使用的fd句柄上限</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root身份运行</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnice=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                运行守护进程的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nice</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 级别</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">-19</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsmemlock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               允许锁定内存以避免使用swap</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufslimitarenas=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         将malloc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> arenas限制为给定值</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 防止服务器使用大量虚拟内存</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsallowoomkiller</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        允许OOM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Killer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-4-通用配置" tabindex="-1"><a class="header-anchor" href="#_3-4-4-通用配置"><span>3.4.4 通用配置</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nonempty</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 允许UFS挂载非空目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufscfgfile=CFGFILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       设置客户端配置文件以便从文件中加载配置参数</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/ufs/ufsmount.cfg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsdebug</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 输出调试信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsmeta</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  挂载meta文件系统</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">包含回收站</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsflattrash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             设置回收站挂载目录的显示格式为flat模式</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsdelayedinit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           允许客户端异步连接UFS集群</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">特别适用于/etc/fstab开机挂载场景</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsioretries=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           配置发生IO异常时的重试的次数</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufstimeout=N</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             配置发生IO异常时的最大超时时间</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 表示不限制超时</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsmaster=HOST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           指定UFS集群IP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsmetaserver</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsport=PORT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             指定UFS集群网络端口</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">9421</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsbind=IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               指定客户端bind的网络地址</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufssubfolder=PATH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        指定挂载的集群目录</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (default: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufspassword=PASSWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     配置客户端访问密码</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufspreflabels=LABELEXPR</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnoxattrs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              关闭xattr功能</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnoposixlocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          关闭posix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> locks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (lockf </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ioctl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)功能</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnobsdlocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            关闭BSD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> locks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (flock)功能</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-5-附加特性" tabindex="-1"><a class="header-anchor" href="#_3-4-5-附加特性"><span>3.4.5 附加特性</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fsname=NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ⾃定义⽂件系统名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufspreflabels=LABELEXPR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 指定在</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> I/O</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 期间选择chunkserver的⾸选标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnoxattrs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 关闭xattr功能</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnoposixlocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 关闭posix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> locks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (lockf </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ioctl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)功能</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsnobsdlocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 关闭BSD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> locks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (flock)功能</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5-应用场景" tabindex="-1"><a class="header-anchor" href="#_3-5-应用场景"><span>3.5 应用场景</span></a></h3><h4 id="_3-5-1-自动挂载" tabindex="-1"><a class="header-anchor" href="#_3-5-1-自动挂载"><span>3.5.1 自动挂载</span></a></h4><p>对于 <strong>CentOS、Ubuntu/Debian</strong> 等 <strong>Linux</strong> 操作系统，⽀持以 <strong>fstab</strong> 和 <strong>systemd</strong> 两种⽅式进⾏开机⾃动挂载</p><div class="hint-container warning"><p class="hint-container-title">注意</p><ol><li><p>通过定义/etc/hosts主机配置，在ufsmount命令⾏中可以简化 &quot;-H&quot;、&quot;-o ufsmaster=&quot;等参数定义。&quot;-H&quot;参数可以指定多个meta服务IP或者主机名；&quot;-o ufsmaster=&quot;参数仅⽀持指定单个meta服务IP或者主机名</p></li><li><p>通过定义默认的/etc/ufs/ufsmount.cfg挂载配置⽂件，在ufsmount命令⾏和fstab中可以简化 &quot;-o &quot;等系列参数的定义</p></li><li><p>由于客户端可能优先启动于 UFS 集群，导致客户端注册失败从⽽⽆法⾃动挂载，这种情况下需要在客户端配置⽂件(/etc/ufs/ufsmount.cfg)或者命令⾏中增加ufsdelayedinit参数项，以便⽀持此场景</p></li></ol></div><h5 id="_3-5-1-1-systemd-自动挂载" tabindex="-1"><a class="header-anchor" href="#_3-5-1-1-systemd-自动挂载"><span><strong>3.5.1.1 systemd ⾃动挂载</strong></span></a></h5><p>在 <strong>Linux</strong> 操作系统中通过 <strong>systemd</strong> 系统管理⼯具实现 <strong>ufsmount</strong> 开机⾃动挂载功能</p><p><strong>步骤1：</strong> 创建 <strong>systemd</strong> 配置模板</p><p>新建名为 <strong>ufs-automount.service</strong> 的⽂本⽂件（配置名字可以⾃<em>定义</em>），存放到 <code>/usr/lib/systemd/system</code> 路径下，通过 <strong>systemd</strong> 配置语法指定相应的启动参数</p><p><strong>ufs-automount.service</strong> 的内容⽰例如下</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">Description</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">UFS Client Helper</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">Wants</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">network-online.target</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">After</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">network.target network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">Type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">forking</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">ExecStart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">/usr/bin/ufsmount3 -o </span><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">ufssubfolder</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">/,ufsdelayedinit -H</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">172.16.120.111,172.16.120.112,172.16.120.113 /mnt/ufs</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">Restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">on-abnormal</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">RestartSec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">120s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">WantedBy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">multi-user.target</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>⚠️<strong>注意：</strong> <strong>ExecStart</strong> 为命令⾏挂载语法，⽤户需要替换为实际的挂载参数</p></blockquote><p>通过配置<code>/etc/fstab</code>可实现 Unix/Linux 平台下客户端自动挂载</p><p><strong>步骤2：</strong> 通过 <strong>systemctl</strong> ⼯具设置开机启动</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 0. 向操作系统注册 ufs-automount.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. 启⽤服务 - 允许开机⾃动运⾏</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-automount.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. ⽴即启动服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-automount.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. ⽴即停⽌服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-automount.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. 查看服务运⾏状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufs-automount.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>步骤3：</strong> 验证以上配置是否⽣效，重启查看是否挂载即可</p><h5 id="_3-5-1-2-fstab-自动挂载" tabindex="-1"><a class="header-anchor" href="#_3-5-1-2-fstab-自动挂载"><span><strong>3.5.1.2 fstab ⾃动挂载</strong></span></a></h5><p>在 <strong>Linux</strong> 操作系统中通过 <strong>fstab</strong> 方式实现 <strong>ufsmount</strong> 开机⾃动挂载功能</p><p><strong>步骤1：</strong> 安装 <strong>fuse</strong> ⼯具包</p>`,117)),t(a,{id:"1514",data:[]}),s[1]||(s[1]=i(`<p><strong>步骤2：</strong> 配置 <strong>fstab</strong></p><p>通过 <strong>vim</strong> 编辑 <code>/etc/fstab</code> ，增加⾃动挂载路径（<code>/mnt/ufs</code>），示例如下</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /etc/fstab</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fuse</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsdelayedinit,ufsioretries=120,ufssubfolder=/0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>步骤3：</strong> 验证以上配置是否⽣效</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 验证 /mnt/ufs 是否能挂载</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 卸载/mnt/ufs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">umount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-5-2-查看操作日志" tabindex="-1"><a class="header-anchor" href="#_3-5-2-查看操作日志"><span>3.5.2 查看操作⽇志</span></a></h4><p>以 <code>/mnt/ufs</code> 为客户端挂载点为⽰例</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs/.oplog</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 输出⽰例如下</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">08.18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:48:30.986145:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid:27219</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmd:readdirplus</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">165735,4096,1414</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [handle:00000007]</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (3984)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">08.18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:48:30.986247:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid:27219</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmd:readdir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (165735,4096,2493)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[handle:00000007]: OK (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">880</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">08.18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:48:30.986307:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid:27219</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmd:readdir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (165735,4096,2493)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[handle:00000007]: OK (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">08.18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:48:30.986682:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmd:releasedir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (165735)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[handle:00000000]: OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">08.18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:48:30.986687:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmd:releasedir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (165731)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[handle:00000000]: OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">08.18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:48:30.987260:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gid:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid:27219</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmd:opendir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (136392): OK</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[handle:00000002]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-5-3-自定义挂载参数" tabindex="-1"><a class="header-anchor" href="#_3-5-3-自定义挂载参数"><span>3.5.3 自定义挂载参数</span></a></h4><p><strong>方法1：</strong> 通过命令⾏参数</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	-H</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 172.16.120.111,172.16.120.112,172.16.120.113</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsloglevel=debug</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufslogfile=/var/log/ufs/ufsmount_xingang.log</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsrlimitnofile=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1024000</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufsioretries=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">120</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">	-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ufssubfolder=/Users/Xingang</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>方法2：</strong> 通过配置⽂件</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ufsmount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/ufs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/ufs/your_ufsmount.cfg</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-5-4-查询挂载参数" tabindex="-1"><a class="header-anchor" href="#_3-5-4-查询挂载参数"><span>3.5.4 查询挂载参数</span></a></h4><p>以 <code>/mnt/ufs</code> 为客户端挂载点为示例</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cat /mnt/ufs/.params</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>输出示例如下：</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>ufsmaster: ufsmetaserver</span></span>
<span class="line"><span>ufsport: 9421</span></span>
<span class="line"><span>ufsbind: (not defined)</span></span>
<span class="line"><span>ufsproxy: 127.0.0.1</span></span>
<span class="line"><span>ufssubfolder: /</span></span>
<span class="line"><span>ufspassword: (not defined)</span></span>
<span class="line"><span>ufspassfile: (not defined)</span></span>
<span class="line"><span>ufsmd5pass: (not defined)</span></span>
<span class="line"><span>ufspreflabels: (not defined)</span></span>
<span class="line"><span>ufsrlimitnofile: 100000</span></span>
<span class="line"><span>ufsnice: -19</span></span>
<span class="line"><span>ufssuid: (not defined)</span></span>
<span class="line"><span>ufsdev: (not defined)</span></span>
<span class="line"><span>ufsmemlock: (not defined)</span></span>
<span class="line"><span>ufslimitarenas: 4</span></span>
<span class="line"><span>ufsallowoomkiller: (not defined)</span></span>
<span class="line"><span>nonempty: (not defined)</span></span>
<span class="line"><span>ufswritecachesize: 256</span></span>
<span class="line"><span>ufsreadaheadsize: 256</span></span>
<span class="line"><span>ufsreadaheadleng: 1048576</span></span>
<span class="line"><span>ufsreadaheadtrigger: 10485760</span></span>
<span class="line"><span>ufserroronlostchunk: (not defined)</span></span>
<span class="line"><span>ufserroronnospace: (not defined)</span></span>
<span class="line"><span>ufsioretries: 3</span></span>
<span class="line"><span>ufstimeout: 1</span></span>
<span class="line"><span>ufslogretry: 5</span></span>
<span class="line"><span>ufsdebug: (not defined)</span></span>
<span class="line"><span>ufsmeta: (not defined)</span></span>
<span class="line"><span>ufsflattrash: (not defined)</span></span>
<span class="line"><span>ufsdelayedinit: (defined)</span></span>
<span class="line"><span>ufsdonotrememberpassword: (not defined)</span></span>
<span class="line"><span>ufscachefiles: (not defined)</span></span>
<span class="line"><span>ufsnoxattrs: (not defined)</span></span>
<span class="line"><span>ufsnoposixlocks: (not defined)</span></span>
<span class="line"><span>ufsnobsdlocks: (not defined)</span></span>
<span class="line"><span>ufscachemode: (not defined)</span></span>
<span class="line"><span>ufsmkdircopysgid: 1</span></span>
<span class="line"><span>ufssugidclearmode: (not defined)</span></span>
<span class="line"><span>ufsattrcacheto: 1.000</span></span>
<span class="line"><span>ufsxattrcacheto: 30.000</span></span>
<span class="line"><span>ufsentrycacheto: 0.000</span></span>
<span class="line"><span>ufsdirentrycacheto: 1.000</span></span>
<span class="line"><span>ufsnegentrycacheto: 0.000</span></span>
<span class="line"><span>ufsgroupscacheto: 300.000</span></span>
<span class="line"><span>ufsfsyncmintime: 0.000</span></span>
<span class="line"><span>ufsfsyncbeforeclose: (not defined)</span></span>
<span class="line"><span>working_keep_cache_mode: AUTO</span></span>
<span class="line"><span>working_sugid_clear_mode: EXT</span></span>
<span class="line"><span>no_std_mount_options: (not defined)</span></span>
<span class="line"><span>master_sesflags: 24</span></span>
<span class="line"><span>master_umaskval: 0000</span></span>
<span class="line"><span>master_maproot: 0:0</span></span>
<span class="line"><span>master_mapall: 0:0</span></span>
<span class="line"><span>master_goallimit: 1:9</span></span>
<span class="line"><span>master_trashlimit: 0:4294967295</span></span>
<span class="line"><span>master_disables: 0x0</span></span>
<span class="line"><span>ufs_master_version: 4.0.10</span></span>
<span class="line"><span>ufs_mount_version: 4.0.10-1</span></span>
<span class="line"><span>ufs_mount_build: 20210712</span></span>
<span class="line"><span>compiled_with_fuse: 3.2</span></span>
<span class="line"><span>fuse_library_version: 3.2</span></span>
<span class="line"><span>kernel_fuse_protocol: 7.22</span></span>
<span class="line"><span>kernel_capability_mask: 0xFFDB</span></span>
<span class="line"><span>kernel_defaults_mask: 0xFC0B</span></span>
<span class="line"><span>kernel_working_mask: 0xEC5B</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-5-5-查看操作日志" tabindex="-1"><a class="header-anchor" href="#_3-5-5-查看操作日志"><span>3.5.5 查看操作日志</span></a></h4><p>以<code>/mnt/ufs</code>为客户端挂载点为示例。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cat /mnt/ufs/.oplog</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>输出示例如下：</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>08.18 17:48:30.986145: uid:0 gid:0 pid:27219 cmd:readdirplus (165735,4096,1414) [handle:00000007]: OK (3984)</span></span>
<span class="line"><span>08.18 17:48:30.986247: uid:0 gid:0 pid:27219 cmd:readdir (165735,4096,2493) [handle:00000007]: OK (880)</span></span>
<span class="line"><span>08.18 17:48:30.986307: uid:0 gid:0 pid:27219 cmd:readdir (165735,4096,2493) [handle:00000007]: OK (no data)</span></span>
<span class="line"><span>08.18 17:48:30.986682: uid:0 gid:0 pid:0 cmd:releasedir (165735) [handle:00000000]: OK</span></span>
<span class="line"><span>08.18 17:48:30.986687: uid:0 gid:0 pid:0 cmd:releasedir (165731) [handle:00000000]: OK</span></span>
<span class="line"><span>08.18 17:48:30.986733: uid:0 gid:0 pid:27219 cmd:getattr (136392) [no handle] (using open dir cache): OK (0.0,[drwxr-xr-x:0040755,3,0,0,1628796967,1628233002,1628233002,2000181])</span></span>
<span class="line"><span>08.18 17:48:30.987260: uid:0 gid:0 pid:27219 cmd:opendir (136392): OK [handle:00000002]</span></span>
<span class="line"><span>08.18 17:48:30.987344: uid:0 gid:0 pid:27219 cmd:getattr (136392) [no handle] (using open dir cache): OK (0.0,[drwxr-xr-x:0040755,3,0,0,1628796967,1628233002,1628233002,2000181])</span></span>
<span class="line"><span>08.18 17:48:30.987388: uid:0 gid:0 pid:27219 cmd:getattr (136392) [no handle] (using open dir cache): OK (0.0,[drwxr-xr-x:0040755,3,0,0,1628796967,1628233002,1628233002,2000181])</span></span>
<span class="line"><span>08.18 17:48:30.987940: uid:0 gid:0 pid:27219 cmd:readdirplus (136392,4096,137) [handle:00000002]: OK (488)</span></span>
<span class="line"><span>08.18 17:48:30.988008: uid:0 gid:0 pid:27219 cmd:readdir (136392,4096,137) [handle:00000002]: OK (no data)</span></span>
<span class="line"><span>...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-5-6-查询运行日志" tabindex="-1"><a class="header-anchor" href="#_3-5-6-查询运行日志"><span>3.5.6 查询运行日志</span></a></h4><p>以 <code>/var/log/ufs/ufsmount.log</code> 为⽇志⽰例</p><ol><li><p>客户端启动⽇志</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 10:36:54.520 info 30275:30275] setting glibc malloc arena max to 4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 10:36:54.520 info 30275:30275] setting glibc malloc arena test to 4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 10:36:54.520 info 30275:30275] out of memory killer disabled</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 22[2022-07-28</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10:36:54.520</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 30275:30275]</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> monotonic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> function:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clock_gettime</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 10:36:54.530 info 30275:30275] monotonic clock speed: 679351 ops / 10 miliseconds</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 10:36:54.541 info 30275:30287] my st_dev: 51</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Leader离线</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:32.264 warning 4681:4684] master: connection lost (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">header</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:32.267 warning 4681:4684] ufsmaster 172.16.120.112 - doesn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;t know his</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">leader, waiting a moment and retrying using different IP</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[2022-07-28 11:04:32.268 warning 4681:4684] ufsmaster 172.16.120.112 - doesn&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t know his</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">leader,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> waiting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> moment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> retrying</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> different</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IP</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:34.269 warning 4681:4684] ufsmaster 172.16.120.112 - doesn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;t know his</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">leader, waiting a moment and retrying using different IP</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[2022-07-28 11:04:34.270 warning 4681:4684] ufsmaster 172.16.120.113 - doesn&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t know his</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">leader,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> waiting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> moment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> retrying</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> different</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IP</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:36.272 warning 4681:4684] ufsmaster 172.16.120.113 - doesn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;t know his</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">leader, waiting a moment and retrying using different IP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>向New Leader注册</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:36.272 warning 4681:4684] ufsmaster found leader: 172.16.120.113</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:38.274 warning 4681:4684] ufsmaster 172.16.120.113 - doesn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;t know his</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">leader, waiting a moment and retrying using different IP</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[2022-07-28 11:04:38.275 warning 4681:4684] can&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t connect to master</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;172.16.120.112&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;9421&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:42.279 warning 4681:4684] ufsmaster 172.16.120.113 - doesn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;t know his</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">leader, waiting a moment and retrying using different IP</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[2022-07-28 11:04:42.279 warning 4681:4684] ufsmaster found leader: 172.16.120.113</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[2022-07-28 11:04:42.280 warning 4681:4684] ufsmaster 172.16.120.113 - doesn&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t know his</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">leader,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> waiting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> moment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> retrying</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> different</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IP</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:04:44.281 info 4681:4684] registered to master</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>⽂件的数据块离线, 导致客户端⽆法读数据(read)、写数据(write)</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># a. 存储节点不在线</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># b. CSS服务未启动</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:09:11.859 warning 4681:4817] file: 359987, index: 0, chunk:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0000000010AF62DE,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00000003</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> there</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copies</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:09:21.860 warning 4681:4688] file: 359987, index: 0, chunk:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0000000010AF62DE,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00000003</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> there</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copies</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:09:21.860 warning 4681:4818] file: 359987, index: 0, chunk:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0000000010AF62DE,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00000003</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> there</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copies</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:32:45.770 warning 8706:12146] file: 72628, index: 0, chunk:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0000000010B2618C,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00000002</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> there</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copies</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:32:55.771 warning 8706:12147] file: 72628, index: 0, chunk:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0000000010B2618C,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00000002</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> there</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copies</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>chunkserver离线，导致客户端⽆法写数据</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:41.754 warning 8706:8715] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:43.255 warning 8706:9629] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:45.056 warning 8706:8715] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:47.157 warning 8706:9629] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:49.558 warning 8706:8715] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:52.260 warning 8706:9629] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:55.261 warning 8706:8715] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:20:58.562 warning 8706:9629] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunkserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>磁盘离线， 导致客户端⽆法写数据</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:25:19.261 warning 8706:9629] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:25:21.063 warning 8706:8715] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:25:23.164 warning 8706:9629] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:25:25.565 warning 8706:8715] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:25:28.266 warning 8706:9629] file: 72628, index: 0 - fs_writechunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:27:16.594 warning 8706:8715] error writing file number 72628: ENXIO (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">No</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> address</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>磁盘离线， 导致客户端⽆法读数据</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:28:31.087 warning 8706:12146] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:28:32.289 warning 8706:12147] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:28:33.488 warning 8706:8713] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:28:34.990 warning 8706:12146] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:28:36.491 warning 8706:12147] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:28:38.291 warning 8706:8713] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:28:40.093 warning 8706:12146] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:29:26.301 warning 8706:12146] file: 72628, index: 0 - fs_readchunk returned</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">status:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Chunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[2022-07-28 11:29:26.301 warning 8706:12146] error reading file number 72628: ENXIO (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">No</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> address</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol>`,26))])}const c=n(d,[["render",k]]),u=JSON.parse('{"path":"/unix/CentOS/UFS/ufs%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html","title":"UFS核心组件","lang":"zh-CN","frontmatter":{"title":"UFS核心组件","date":"2021-10-16T00:00:00.000Z","category":["UFS"],"tag":["UFS"],"description":"本文档提供 UFS 存储系统核心组件的配置说明","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"UFS核心组件\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-10-16T00:00:00.000Z\\",\\"dateModified\\":\\"2023-03-30T14:23:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"悦·宝宝\\",\\"url\\":\\"https://github.com/Igarashi-G\\"}]}"],["meta",{"property":"og:url","content":"https://igarashi-g.github.io/unix/CentOS/UFS/ufs%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6.html"}],["meta",{"property":"og:site_name","content":"悦 ▪ 宝宝"}],["meta",{"property":"og:title","content":"UFS核心组件"}],["meta",{"property":"og:description","content":"本文档提供 UFS 存储系统核心组件的配置说明"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-03-30T14:23:22.000Z"}],["meta",{"property":"article:tag","content":"UFS"}],["meta",{"property":"article:published_time","content":"2021-10-16T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-03-30T14:23:22.000Z"}]]},"git":{"createdTime":1664462137000,"updatedTime":1680186202000,"contributors":[{"name":"Igarashi","username":"Igarashi","email":"2545369032@qq.com","commits":4,"url":"https://github.com/Igarashi"}]},"readingTime":{"minutes":18.33,"words":5500},"filePathRelative":"unix/CentOS/UFS/ufs核心组件.md","excerpt":"<p>本文档提供 <strong>UFS</strong> 存储系统核心组件的配置说明</p>\\n","autoDesc":true}');export{c as comp,u as data};
